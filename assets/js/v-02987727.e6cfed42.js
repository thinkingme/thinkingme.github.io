"use strict";(self.webpackChunkcoding_road=self.webpackChunkcoding_road||[]).push([[662],{36170:(n,s,a)=>{a.r(s),a.d(s,{data:()=>e});const e={key:"v-02987727",path:"/sidebar/sanfene/spring.html",title:"é¢æ¸£é€†è¢­ï¼ˆSpringï¼‰å¿…çœ‹ğŸ‘",lang:"zh-CN",frontmatter:{category:["é¢æ¸£é€†è¢­"],tag:["Spring"],summary:'é¢æ¸£é€†è¢­ï¼ˆSpringï¼‰å¿…çœ‹:+1: " å›¾æ–‡è¯¦è§£ 35 é“ Spring é¢è¯•é«˜é¢‘é¢˜ï¼Œè¿™æ¬¡åŠæ‰“é¢è¯•å®˜ï¼Œæˆ‘è§‰å¾—ç¨³äº†ï¼ˆæ‰‹åŠ¨ dogï¼‰ã€‚æ•´ç†ï¼šæ²‰é»˜ç‹äºŒï¼Œæˆ³è½¬è½½é“¾æ¥ï¼Œä½œè€…ï¼šä¸‰åˆ†æ¶ï¼Œæˆ³åŸæ–‡é“¾æ¥ã€‚" åŸºç¡€ 1.Spring æ˜¯ä»€ä¹ˆï¼Ÿç‰¹æ€§ï¼Ÿæœ‰å“ªäº›æ¨¡å—ï¼Ÿ ä¸€å¥è¯æ¦‚æ‹¬ï¼šSpring æ˜¯ä¸€ä¸ªè½»é‡çº§ã€éå…¥ä¾µå¼çš„æ§åˆ¶åè½¬ (IoC) å’Œé¢å‘åˆ‡é¢ (AOP) çš„æ¡†æ¶ã€‚ 2003 å¹´',head:[["meta",{property:"og:url",content:"https://vuepress-theme-hope-v2-demo.mrhope.site/sidebar/sanfene/spring.html"}],["meta",{property:"og:site_name",content:"coding-rode"}],["meta",{property:"og:title",content:"é¢æ¸£é€†è¢­ï¼ˆSpringï¼‰å¿…çœ‹ğŸ‘"}],["meta",{property:"og:type",content:"article"}],["meta",{property:"og:updated_time",content:"2022-06-04T07:20:53.000Z"}],["meta",{property:"og:locale",content:"zh-CN"}],["meta",{property:"article:tag",content:"Spring"}],["meta",{property:"article:modified_time",content:"2022-06-04T07:20:53.000Z"}]]},excerpt:"",headers:[{level:2,title:"åŸºç¡€",slug:"åŸºç¡€",children:[{level:3,title:"1.Spring æ˜¯ä»€ä¹ˆï¼Ÿç‰¹æ€§ï¼Ÿæœ‰å“ªäº›æ¨¡å—ï¼Ÿ",slug:"_1-spring-æ˜¯ä»€ä¹ˆ-ç‰¹æ€§-æœ‰å“ªäº›æ¨¡å—",children:[]},{level:3,title:"2.Spring æœ‰å“ªäº›æ¨¡å—å‘¢ï¼Ÿ",slug:"_2-spring-æœ‰å“ªäº›æ¨¡å—å‘¢",children:[]},{level:3,title:"3.Spring æœ‰å“ªäº›å¸¸ç”¨æ³¨è§£å‘¢ï¼Ÿ",slug:"_3-spring-æœ‰å“ªäº›å¸¸ç”¨æ³¨è§£å‘¢",children:[]},{level:3,title:"4.Spring ä¸­åº”ç”¨äº†å“ªäº›è®¾è®¡æ¨¡å¼å‘¢ï¼Ÿ",slug:"_4-spring-ä¸­åº”ç”¨äº†å“ªäº›è®¾è®¡æ¨¡å¼å‘¢",children:[]}]},{level:2,title:"IOC",slug:"ioc",children:[{level:3,title:"5.è¯´ä¸€è¯´ä»€ä¹ˆæ˜¯ IOCï¼Ÿä»€ä¹ˆæ˜¯ DI?",slug:"_5-è¯´ä¸€è¯´ä»€ä¹ˆæ˜¯-ioc-ä»€ä¹ˆæ˜¯-di",children:[]},{level:3,title:"6.èƒ½ç®€å•è¯´ä¸€ä¸‹ Spring IOC çš„å®ç°æœºåˆ¶å—ï¼Ÿ",slug:"_6-èƒ½ç®€å•è¯´ä¸€ä¸‹-spring-ioc-çš„å®ç°æœºåˆ¶å—",children:[]},{level:3,title:"7.è¯´è¯´ BeanFactory å’Œ ApplicantContext?",slug:"_7-è¯´è¯´-beanfactory-å’Œ-applicantcontext",children:[]},{level:3,title:"8.ä½ çŸ¥é“ Spring å®¹å™¨å¯åŠ¨é˜¶æ®µä¼šå¹²ä»€ä¹ˆå—ï¼Ÿ",slug:"_8-ä½ çŸ¥é“-spring-å®¹å™¨å¯åŠ¨é˜¶æ®µä¼šå¹²ä»€ä¹ˆå—",children:[]},{level:3,title:"9.èƒ½è¯´ä¸€ä¸‹ Spring Bean ç”Ÿå‘½å‘¨æœŸå—ï¼Ÿ",slug:"_9-èƒ½è¯´ä¸€ä¸‹-spring-bean-ç”Ÿå‘½å‘¨æœŸå—",children:[]},{level:3,title:"10.Bean å®šä¹‰å’Œä¾èµ–å®šä¹‰æœ‰å“ªäº›æ–¹å¼ï¼Ÿ",slug:"_10-bean-å®šä¹‰å’Œä¾èµ–å®šä¹‰æœ‰å“ªäº›æ–¹å¼",children:[]},{level:3,title:"11.æœ‰å“ªäº›ä¾èµ–æ³¨å…¥çš„æ–¹æ³•ï¼Ÿ",slug:"_11-æœ‰å“ªäº›ä¾èµ–æ³¨å…¥çš„æ–¹æ³•",children:[]},{level:3,title:"12.Spring æœ‰å“ªäº›è‡ªåŠ¨è£…é…çš„æ–¹å¼ï¼Ÿ",slug:"_12-spring-æœ‰å“ªäº›è‡ªåŠ¨è£…é…çš„æ–¹å¼",children:[]},{level:3,title:"13.Spring ä¸­çš„ Bean çš„ä½œç”¨åŸŸæœ‰å“ªäº›?",slug:"_13-spring-ä¸­çš„-bean-çš„ä½œç”¨åŸŸæœ‰å“ªäº›",children:[]},{level:3,title:"14.Spring ä¸­çš„å•ä¾‹ Bean ä¼šå­˜åœ¨çº¿ç¨‹å®‰å…¨é—®é¢˜å—ï¼Ÿ",slug:"_14-spring-ä¸­çš„å•ä¾‹-bean-ä¼šå­˜åœ¨çº¿ç¨‹å®‰å…¨é—®é¢˜å—",children:[]},{level:3,title:"15.è¯´è¯´å¾ªç¯ä¾èµ–?",slug:"_15-è¯´è¯´å¾ªç¯ä¾èµ–",children:[]},{level:3,title:"16.é‚£ Spring æ€ä¹ˆè§£å†³å¾ªç¯ä¾èµ–çš„å‘¢ï¼Ÿ",slug:"_16-é‚£-spring-æ€ä¹ˆè§£å†³å¾ªç¯ä¾èµ–çš„å‘¢",children:[]},{level:3,title:"17.ä¸ºä»€ä¹ˆè¦ä¸‰çº§ç¼“å­˜ï¼Ÿâ¼†çº§ä¸â¾å—ï¼Ÿ",slug:"_17-ä¸ºä»€ä¹ˆè¦ä¸‰çº§ç¼“å­˜-äºŒçº§ä¸è¡Œå—",children:[]},{level:3,title:"18.@Autowired çš„å®ç°åŸç†ï¼Ÿ",slug:"_18-autowired-çš„å®ç°åŸç†",children:[]}]},{level:2,title:"AOP",slug:"aop",children:[{level:3,title:"19.è¯´è¯´ä»€ä¹ˆæ˜¯ AOPï¼Ÿ",slug:"_19-è¯´è¯´ä»€ä¹ˆæ˜¯-aop",children:[]},{level:3,title:"20.è¯´è¯´ä½ å¹³æ—¶æœ‰ç”¨åˆ° AOP å—ï¼Ÿ",slug:"_20-è¯´è¯´ä½ å¹³æ—¶æœ‰ç”¨åˆ°-aop-å—",children:[]},{level:3,title:"21.è¯´è¯´ JDK åŠ¨æ€ä»£ç†å’Œ CGLIB ä»£ç† ï¼Ÿ",slug:"_21-è¯´è¯´-jdk-åŠ¨æ€ä»£ç†å’Œ-cglib-ä»£ç†",children:[]},{level:3,title:"22.è¯´è¯´ Spring AOP å’Œ AspectJ AOP åŒºåˆ«?",slug:"_22-è¯´è¯´-spring-aop-å’Œ-aspectj-aop-åŒºåˆ«",children:[]}]},{level:2,title:"äº‹åŠ¡",slug:"äº‹åŠ¡",children:[{level:3,title:"23.Spring äº‹åŠ¡çš„ç§ç±»ï¼Ÿ",slug:"_23-spring-äº‹åŠ¡çš„ç§ç±»",children:[]},{level:3,title:"24.Spring çš„äº‹åŠ¡éš”ç¦»çº§åˆ«ï¼Ÿ",slug:"_24-spring-çš„äº‹åŠ¡éš”ç¦»çº§åˆ«",children:[]},{level:3,title:"25.Spring çš„äº‹åŠ¡ä¼ æ’­æœºåˆ¶ï¼Ÿ",slug:"_25-spring-çš„äº‹åŠ¡ä¼ æ’­æœºåˆ¶",children:[]},{level:3,title:"26.å£°æ˜å¼äº‹åŠ¡å®ç°åŸç†äº†è§£å—ï¼Ÿ",slug:"_26-å£°æ˜å¼äº‹åŠ¡å®ç°åŸç†äº†è§£å—",children:[]},{level:3,title:"27.å£°æ˜å¼äº‹åŠ¡åœ¨å“ªäº›æƒ…å†µä¸‹ä¼šå¤±æ•ˆï¼Ÿ",slug:"_27-å£°æ˜å¼äº‹åŠ¡åœ¨å“ªäº›æƒ…å†µä¸‹ä¼šå¤±æ•ˆ",children:[]}]},{level:2,title:"MVC",slug:"mvc",children:[{level:3,title:"28.Spring MVC çš„æ ¸å¿ƒç»„ä»¶ï¼Ÿ",slug:"_28-spring-mvc-çš„æ ¸å¿ƒç»„ä»¶",children:[]},{level:3,title:"29.Spring MVC çš„å·¥ä½œæµç¨‹ï¼Ÿ",slug:"_29-spring-mvc-çš„å·¥ä½œæµç¨‹",children:[]},{level:3,title:"30.SpringMVC Restful é£æ ¼çš„æ¥å£çš„æµç¨‹æ˜¯ä»€ä¹ˆæ ·çš„å‘¢ï¼Ÿ",slug:"_30-springmvc-restful-é£æ ¼çš„æ¥å£çš„æµç¨‹æ˜¯ä»€ä¹ˆæ ·çš„å‘¢",children:[]}]},{level:2,title:"Spring Boot",slug:"spring-boot",children:[{level:3,title:"31.ä»‹ç»ä¸€ä¸‹ SpringBootï¼Œæœ‰å“ªäº›ä¼˜ç‚¹ï¼Ÿ",slug:"_31-ä»‹ç»ä¸€ä¸‹-springboot-æœ‰å“ªäº›ä¼˜ç‚¹",children:[]},{level:3,title:"32.SpringBoot è‡ªåŠ¨é…ç½®åŸç†äº†è§£å—ï¼Ÿ",slug:"_32-springboot-è‡ªåŠ¨é…ç½®åŸç†äº†è§£å—",children:[]},{level:3,title:"33.å¦‚ä½•è‡ªå®šä¹‰ä¸€ä¸ª SpringBoot Srarter?",slug:"_33-å¦‚ä½•è‡ªå®šä¹‰ä¸€ä¸ª-springboot-srarter",children:[]},{level:3,title:"34.Springboot å¯åŠ¨åŸç†ï¼Ÿ",slug:"_34-springboot-å¯åŠ¨åŸç†",children:[]}]},{level:2,title:"Spring Cloud",slug:"spring-cloud",children:[{level:3,title:"35.å¯¹ SpringCloud äº†è§£å¤šå°‘ï¼Ÿ",slug:"_35-å¯¹-springcloud-äº†è§£å¤šå°‘",children:[]}]}],git:{createdTime:1653617096e3,updatedTime:1654327253e3,contributors:[{name:"æ—æŒ¯è¾‰",email:"linzhenhui@apexsoft.com",commits:2}]},readingTime:{minutes:54.02,words:16205},filePathRelative:"sidebar/sanfene/spring.md"}},11369:(n,s,a)=>{a.r(s),a.d(s,{default:()=>I});var e=a(95393);const t=(0,e._)("h1",{id:"é¢æ¸£é€†è¢­-spring-å¿…çœ‹",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#é¢æ¸£é€†è¢­-spring-å¿…çœ‹","aria-hidden":"true"},"#"),(0,e.Uk)(" é¢æ¸£é€†è¢­ï¼ˆSpringï¼‰å¿…çœ‹ğŸ‘")],-1),p=(0,e.Uk)("å›¾æ–‡è¯¦è§£ 35 é“ Spring é¢è¯•é«˜é¢‘é¢˜ï¼Œè¿™æ¬¡åŠæ‰“é¢è¯•å®˜ï¼Œæˆ‘è§‰å¾—ç¨³äº†ï¼ˆæ‰‹åŠ¨ dogï¼‰ã€‚æ•´ç†ï¼šæ²‰é»˜ç‹äºŒï¼Œæˆ³"),o={href:"https://mp.weixin.qq.com/s/EQge6DmgIqYITM3mAxkatg",target:"_blank",rel:"noopener noreferrer"},c=(0,e.Uk)("è½¬è½½é“¾æ¥"),i=(0,e.Uk)("ï¼Œä½œè€…ï¼šä¸‰åˆ†æ¶ï¼Œæˆ³"),l={href:"https://mp.weixin.qq.com/s/Y17S85ntHm_MLTZMJdtjQQ",target:"_blank",rel:"noopener noreferrer"},r=(0,e.Uk)("åŸæ–‡é“¾æ¥"),u=(0,e.Uk)("ã€‚"),d=(0,e.uE)('<h2 id="åŸºç¡€" tabindex="-1"><a class="header-anchor" href="#åŸºç¡€" aria-hidden="true">#</a> åŸºç¡€</h2><h3 id="_1-spring-æ˜¯ä»€ä¹ˆ-ç‰¹æ€§-æœ‰å“ªäº›æ¨¡å—" tabindex="-1"><a class="header-anchor" href="#_1-spring-æ˜¯ä»€ä¹ˆ-ç‰¹æ€§-æœ‰å“ªäº›æ¨¡å—" aria-hidden="true">#</a> 1.Spring æ˜¯ä»€ä¹ˆï¼Ÿç‰¹æ€§ï¼Ÿæœ‰å“ªäº›æ¨¡å—ï¼Ÿ</h3><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/spring-165c27b4-2ea0-409a-8fa5-389c105db0fa.png" alt="Spring Logo" loading="lazy"></p><p>ä¸€å¥è¯æ¦‚æ‹¬ï¼š<strong>Spring æ˜¯ä¸€ä¸ªè½»é‡çº§ã€éå…¥ä¾µå¼çš„æ§åˆ¶åè½¬ (IoC) å’Œé¢å‘åˆ‡é¢ (AOP) çš„æ¡†æ¶ã€‚</strong></p><p>2003 å¹´ï¼Œä¸€ä¸ªéŸ³ä¹å®¶ Rod Johnson å†³å®šå‘å±•ä¸€ä¸ªè½»é‡çº§çš„ Java å¼€å‘æ¡†æ¶ï¼Œ<code>Spring</code>ä½œä¸º Java æˆ˜åœºçš„é¾™éª‘å…µæ¸æ¸å´›èµ·ï¼Œå¹¶æ·˜æ±°äº†<code>EJB</code>è¿™ä¸ªä¼ ç»Ÿçš„é‡è£…éª‘å…µã€‚</p><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/spring-5d9efb93-03a5-400c-8429-3be7c5eeddfb.png" alt="Springé‡è¦ç‰ˆæœ¬" loading="lazy"></p><p>åˆ°äº†ç°åœ¨ï¼Œä¼ä¸šçº§å¼€å‘çš„æ ‡é…åŸºæœ¬å°±æ˜¯ <strong>Spring5</strong> + <strong>Spring Boot 2</strong> + <strong>JDK 8</strong></p><blockquote><p>Spring æœ‰å“ªäº›ç‰¹æ€§å‘¢ï¼Ÿ</p></blockquote><p>Spring æœ‰å¾ˆå¤šä¼˜ç‚¹ï¼š</p><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/spring-a0f0ef9d-3289-41ea-94c2-34b7e37ef854.png" alt="Springç‰¹æ€§" loading="lazy"></p><ol><li><strong>IOC</strong> å’Œ <strong>DI</strong> çš„æ”¯æŒ</li></ol><p>Spring çš„æ ¸å¿ƒå°±æ˜¯ä¸€ä¸ªå¤§çš„å·¥å‚å®¹å™¨ï¼Œå¯ä»¥ç»´æŠ¤æ‰€æœ‰å¯¹è±¡çš„åˆ›å»ºå’Œä¾èµ–å…³ç³»ï¼ŒSpring å·¥å‚ç”¨äºç”Ÿæˆ Beanï¼Œå¹¶ä¸”ç®¡ç† Bean çš„ç”Ÿå‘½å‘¨æœŸï¼Œå®ç°<strong>é«˜å†…èšä½è€¦åˆ</strong>çš„è®¾è®¡ç†å¿µã€‚</p><ol start="2"><li>AOP ç¼–ç¨‹çš„æ”¯æŒ</li></ol><p>Spring æä¾›äº†<strong>é¢å‘åˆ‡é¢ç¼–ç¨‹</strong>ï¼Œå¯ä»¥æ–¹ä¾¿çš„å®ç°å¯¹ç¨‹åºè¿›è¡Œæƒé™æ‹¦æˆªã€è¿è¡Œç›‘æ§ç­‰åˆ‡é¢åŠŸèƒ½ã€‚</p><ol start="3"><li>å£°æ˜å¼äº‹åŠ¡çš„æ”¯æŒ</li></ol><p>æ”¯æŒé€šè¿‡é…ç½®å°±æ¥å®Œæˆå¯¹äº‹åŠ¡çš„ç®¡ç†ï¼Œè€Œä¸éœ€è¦é€šè¿‡ç¡¬ç¼–ç çš„æ–¹å¼ï¼Œä»¥å‰é‡å¤çš„ä¸€äº›äº‹åŠ¡æäº¤ã€å›æ»šçš„ JDBC ä»£ç ï¼Œéƒ½å¯ä»¥ä¸ç”¨è‡ªå·±å†™äº†ã€‚</p><ol start="4"><li>å¿«æ·æµ‹è¯•çš„æ”¯æŒ</li></ol><p>Spring å¯¹ Junit æä¾›æ”¯æŒï¼Œå¯ä»¥é€šè¿‡<strong>æ³¨è§£</strong>å¿«æ·åœ°æµ‹è¯• Spring ç¨‹åºã€‚</p><ol start="5"><li>å¿«é€Ÿé›†æˆåŠŸèƒ½</li></ol><p>æ–¹ä¾¿é›†æˆå„ç§ä¼˜ç§€æ¡†æ¶ï¼ŒSpring ä¸æ’æ–¥å„ç§ä¼˜ç§€çš„å¼€æºæ¡†æ¶ï¼Œå…¶å†…éƒ¨æä¾›äº†å¯¹å„ç§ä¼˜ç§€æ¡†æ¶ï¼ˆå¦‚ï¼šStrutsã€Hibernateã€MyBatisã€Quartz ç­‰ï¼‰çš„ç›´æ¥æ”¯æŒã€‚</p><ol start="6"><li>å¤æ‚ API æ¨¡æ¿å°è£…</li></ol><p>Spring å¯¹ JavaEE å¼€å‘ä¸­éå¸¸éš¾ç”¨çš„ä¸€äº› APIï¼ˆJDBCã€JavaMailã€è¿œç¨‹è°ƒç”¨ç­‰ï¼‰éƒ½æä¾›äº†æ¨¡æ¿åŒ–çš„å°è£…ï¼Œè¿™äº›å°è£… API çš„æä¾›ä½¿å¾—åº”ç”¨éš¾åº¦å¤§å¤§é™ä½ã€‚</p><h3 id="_2-spring-æœ‰å“ªäº›æ¨¡å—å‘¢" tabindex="-1"><a class="header-anchor" href="#_2-spring-æœ‰å“ªäº›æ¨¡å—å‘¢" aria-hidden="true">#</a> 2.Spring æœ‰å“ªäº›æ¨¡å—å‘¢ï¼Ÿ</h3><p>Spring æ¡†æ¶æ˜¯åˆ†æ¨¡å—å­˜åœ¨ï¼Œé™¤äº†æœ€æ ¸å¿ƒçš„<code>Spring Core Container</code>æ˜¯å¿…è¦æ¨¡å—ä¹‹å¤–ï¼Œå…¶ä»–æ¨¡å—éƒ½æ˜¯<code>å¯é€‰</code>ï¼Œå¤§çº¦æœ‰ 20 å¤šä¸ªæ¨¡å—ã€‚</p><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/spring-bb7c13ea-3174-4b32-84b8-821849ddc377.png" alt="Springæ¨¡å—åˆ’åˆ†" loading="lazy"></p><p>æœ€ä¸»è¦çš„ä¸ƒå¤§æ¨¡å—ï¼š</p><ol><li><strong>Spring Core</strong>ï¼šSpring æ ¸å¿ƒï¼Œå®ƒæ˜¯æ¡†æ¶æœ€åŸºç¡€çš„éƒ¨åˆ†ï¼Œæä¾› IOC å’Œä¾èµ–æ³¨å…¥ DI ç‰¹æ€§ã€‚</li><li><strong>Spring Context</strong>ï¼šSpring ä¸Šä¸‹æ–‡å®¹å™¨ï¼Œå®ƒæ˜¯ BeanFactory åŠŸèƒ½åŠ å¼ºçš„ä¸€ä¸ªå­æ¥å£ã€‚</li><li><strong>Spring Web</strong>ï¼šå®ƒæä¾› Web åº”ç”¨å¼€å‘çš„æ”¯æŒã€‚</li><li><strong>Spring MVC</strong>ï¼šå®ƒé’ˆå¯¹ Web åº”ç”¨ä¸­ MVC æ€æƒ³çš„å®ç°ã€‚</li><li><strong>Spring DAO</strong>ï¼šæä¾›å¯¹ JDBC æŠ½è±¡å±‚ï¼Œç®€åŒ–äº† JDBC ç¼–ç ï¼ŒåŒæ—¶ï¼Œç¼–ç æ›´å…·æœ‰å¥å£®æ€§ã€‚</li><li><strong>Spring ORM</strong>ï¼šå®ƒæ”¯æŒç”¨äºæµè¡Œçš„ ORM æ¡†æ¶çš„æ•´åˆï¼Œæ¯”å¦‚ï¼šSpring + Hibernateã€Spring + iBatisã€Spring + JDO çš„æ•´åˆç­‰ã€‚</li><li><strong>Spring AOP</strong>ï¼šå³é¢å‘åˆ‡é¢ç¼–ç¨‹ï¼Œå®ƒæä¾›äº†ä¸ AOP è”ç›Ÿå…¼å®¹çš„ç¼–ç¨‹å®ç°ã€‚</li></ol><h3 id="_3-spring-æœ‰å“ªäº›å¸¸ç”¨æ³¨è§£å‘¢" tabindex="-1"><a class="header-anchor" href="#_3-spring-æœ‰å“ªäº›å¸¸ç”¨æ³¨è§£å‘¢" aria-hidden="true">#</a> 3.Spring æœ‰å“ªäº›å¸¸ç”¨æ³¨è§£å‘¢ï¼Ÿ</h3><p>Spring æœ‰å¾ˆå¤šæ¨¡å—ï¼Œç”šè‡³å¹¿ä¹‰çš„ SpringBootã€SpringCloud ä¹Ÿç®—æ˜¯ Spring çš„ä¸€éƒ¨åˆ†ï¼Œæˆ‘ä»¬æ¥åˆ†æ¨¡å—ï¼ŒæŒ‰åŠŸèƒ½æ¥çœ‹ä¸€ä¸‹ä¸€äº›å¸¸ç”¨çš„æ³¨è§£ï¼š</p><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/spring-8d0a1518-a425-4887-9735-45321095d927.png" alt="Springå¸¸ç”¨æ³¨è§£" loading="lazy"></p><p><strong>Web</strong>:</p><ul><li>@Controllerï¼šç»„åˆæ³¨è§£ï¼ˆç»„åˆäº†@Component æ³¨è§£ï¼‰ï¼Œåº”ç”¨åœ¨ MVC å±‚ï¼ˆæ§åˆ¶å±‚ï¼‰ã€‚</li><li>@RestControllerï¼šè¯¥æ³¨è§£ä¸ºä¸€ä¸ªç»„åˆæ³¨è§£ï¼Œç›¸å½“äº@Controller å’Œ@ResponseBody çš„ç»„åˆï¼Œæ³¨è§£åœ¨ç±»ä¸Šï¼Œæ„å‘³ç€ï¼Œè¯¥ Controller çš„æ‰€æœ‰æ–¹æ³•éƒ½é»˜è®¤åŠ ä¸Šäº†@ResponseBodyã€‚</li><li>@RequestMappingï¼šç”¨äºæ˜ å°„ Web è¯·æ±‚ï¼ŒåŒ…æ‹¬è®¿é—®è·¯å¾„å’Œå‚æ•°ã€‚å¦‚æœæ˜¯ Restful é£æ ¼æ¥å£ï¼Œè¿˜å¯ä»¥æ ¹æ®è¯·æ±‚ç±»å‹ä½¿ç”¨ä¸åŒçš„æ³¨è§£ï¼š <ul><li>@GetMapping</li><li>@PostMapping</li><li>@PutMapping</li><li>@DeleteMapping</li></ul></li><li>@ResponseBodyï¼šæ”¯æŒå°†è¿”å›å€¼æ”¾åœ¨ response å†…ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªé¡µé¢ï¼Œé€šå¸¸ç”¨æˆ·è¿”å› json æ•°æ®ã€‚</li><li>@RequestBodyï¼šå…è®¸ request çš„å‚æ•°åœ¨ request ä½“ä¸­ï¼Œè€Œä¸æ˜¯åœ¨ç›´æ¥è¿æ¥åœ¨åœ°å€åé¢ã€‚</li><li>@PathVariableï¼šç”¨äºæ¥æ”¶è·¯å¾„å‚æ•°ï¼Œæ¯”å¦‚ <code>@RequestMapping(â€œ/hello/{name}â€)</code>ç”³æ˜çš„è·¯å¾„ï¼Œå°†æ³¨è§£æ”¾åœ¨å‚æ•°ä¸­å‰ï¼Œå³å¯è·å–è¯¥å€¼ï¼Œé€šå¸¸ä½œä¸º Restful çš„æ¥å£å®ç°æ–¹æ³•ã€‚</li><li>@RestControllerï¼šè¯¥æ³¨è§£ä¸ºä¸€ä¸ªç»„åˆæ³¨è§£ï¼Œç›¸å½“äº@Controller å’Œ@ResponseBody çš„ç»„åˆï¼Œæ³¨è§£åœ¨ç±»ä¸Šï¼Œæ„å‘³ç€ï¼Œè¯¥ Controller çš„æ‰€æœ‰æ–¹æ³•éƒ½é»˜è®¤åŠ ä¸Šäº†@ResponseBodyã€‚</li></ul><p><strong>å®¹å™¨</strong>:</p><ul><li>@Componentï¼šè¡¨ç¤ºä¸€ä¸ªå¸¦æ³¨é‡Šçš„ç±»æ˜¯ä¸€ä¸ªâ€œç»„ä»¶â€ï¼Œæˆä¸º Spring ç®¡ç†çš„ Beanã€‚å½“ä½¿ç”¨åŸºäºæ³¨è§£çš„é…ç½®å’Œç±»è·¯å¾„æ‰«ææ—¶ï¼Œè¿™äº›ç±»è¢«è§†ä¸ºè‡ªåŠ¨æ£€æµ‹çš„å€™é€‰å¯¹è±¡ã€‚åŒæ—¶@Component è¿˜æ˜¯ä¸€ä¸ªå…ƒæ³¨è§£ã€‚</li><li>@Serviceï¼šç»„åˆæ³¨è§£ï¼ˆç»„åˆäº†@Component æ³¨è§£ï¼‰ï¼Œåº”ç”¨åœ¨ service å±‚ï¼ˆä¸šåŠ¡é€»è¾‘å±‚ï¼‰ã€‚</li><li>@Repositoryï¼šç»„åˆæ³¨è§£ï¼ˆç»„åˆäº†@Component æ³¨è§£ï¼‰ï¼Œåº”ç”¨åœ¨ dao å±‚ï¼ˆæ•°æ®è®¿é—®å±‚ï¼‰ã€‚</li><li>@Autowiredï¼šSpring æä¾›çš„å·¥å…·ï¼ˆç”± Spring çš„ä¾èµ–æ³¨å…¥å·¥å…·ï¼ˆBeanPostProcessorã€BeanFactoryPostProcessorï¼‰è‡ªåŠ¨æ³¨å…¥ï¼‰ã€‚</li><li>@Qualifierï¼šè¯¥æ³¨è§£é€šå¸¸è·Ÿ @Autowired ä¸€èµ·ä½¿ç”¨ï¼Œå½“æƒ³å¯¹æ³¨å…¥çš„è¿‡ç¨‹åšæ›´å¤šçš„æ§åˆ¶ï¼Œ@Qualifier å¯å¸®åŠ©é…ç½®ï¼Œæ¯”å¦‚ä¸¤ä¸ªä»¥ä¸Šç›¸åŒç±»å‹çš„ Bean æ—¶ Spring æ— æ³•æŠ‰æ‹©ï¼Œç”¨åˆ°æ­¤æ³¨è§£</li><li>@Configurationï¼šå£°æ˜å½“å‰ç±»æ˜¯ä¸€ä¸ªé…ç½®ç±»ï¼ˆç›¸å½“äºä¸€ä¸ª Spring é…ç½®çš„ xml æ–‡ä»¶ï¼‰</li><li>@Valueï¼šå¯ç”¨åœ¨å­—æ®µï¼Œæ„é€ å™¨å‚æ•°è·Ÿæ–¹æ³•å‚æ•°ï¼ŒæŒ‡å®šä¸€ä¸ªé»˜è®¤å€¼ï¼Œæ”¯æŒ <code>#{} è·Ÿ \\${}</code> ä¸¤ä¸ªæ–¹å¼ã€‚ä¸€èˆ¬å°† SpringbBoot ä¸­çš„ application.properties é…ç½®çš„å±æ€§å€¼èµ‹å€¼ç»™å˜é‡ã€‚</li><li>@Beanï¼šæ³¨è§£åœ¨æ–¹æ³•ä¸Šï¼Œå£°æ˜å½“å‰æ–¹æ³•çš„è¿”å›å€¼ä¸ºä¸€ä¸ª Beanã€‚è¿”å›çš„ Bean å¯¹åº”çš„ç±»ä¸­å¯ä»¥å®šä¹‰ init()æ–¹æ³•å’Œ destroy()æ–¹æ³•ï¼Œç„¶ååœ¨<code>@Bean(initMethod=â€initâ€,destroyMethod=â€destroyâ€)</code>å®šä¹‰ï¼Œåœ¨æ„é€ ä¹‹åæ‰§è¡Œ initï¼Œåœ¨é”€æ¯ä¹‹å‰æ‰§è¡Œ destroyã€‚</li><li>@Scope:å®šä¹‰æˆ‘ä»¬é‡‡ç”¨ä»€ä¹ˆæ¨¡å¼å»åˆ›å»º Beanï¼ˆæ–¹æ³•ä¸Šï¼Œå¾—æœ‰@Beanï¼‰ å…¶è®¾ç½®ç±»å‹åŒ…æ‹¬ï¼šSingleton ã€Prototypeã€Request ã€ Sessionã€GlobalSessionã€‚</li></ul><p><strong>AOP</strong>:</p><ul><li>@Aspect:å£°æ˜ä¸€ä¸ªåˆ‡é¢ï¼ˆç±»ä¸Šï¼‰ ä½¿ç”¨@Afterã€@Beforeã€@Around å®šä¹‰å»ºè¨€ï¼ˆadviceï¼‰ï¼Œå¯ç›´æ¥å°†æ‹¦æˆªè§„åˆ™ï¼ˆåˆ‡ç‚¹ï¼‰ä½œä¸ºå‚æ•°ã€‚ <ul><li><code>@After</code> ï¼šåœ¨æ–¹æ³•æ‰§è¡Œä¹‹åæ‰§è¡Œï¼ˆæ–¹æ³•ä¸Šï¼‰ã€‚</li><li><code>@Before</code>ï¼š åœ¨æ–¹æ³•æ‰§è¡Œä¹‹å‰æ‰§è¡Œï¼ˆæ–¹æ³•ä¸Šï¼‰ã€‚</li><li><code>@Around</code>ï¼š åœ¨æ–¹æ³•æ‰§è¡Œä¹‹å‰ä¸ä¹‹åæ‰§è¡Œï¼ˆæ–¹æ³•ä¸Šï¼‰ã€‚</li><li><code>@PointCut</code>ï¼š å£°æ˜åˆ‡ç‚¹ åœ¨ java é…ç½®ç±»ä¸­ä½¿ç”¨@EnableAspectJAutoProxy æ³¨è§£å¼€å¯ Spring å¯¹ AspectJ ä»£ç†çš„æ”¯æŒï¼ˆç±»ä¸Šï¼‰ã€‚</li></ul></li></ul><p><strong>äº‹åŠ¡ï¼š</strong></p><ul><li>@Transactionalï¼šåœ¨è¦å¼€å¯äº‹åŠ¡çš„æ–¹æ³•ä¸Šä½¿ç”¨@Transactional æ³¨è§£ï¼Œå³å¯å£°æ˜å¼å¼€å¯äº‹åŠ¡ã€‚</li></ul><h3 id="_4-spring-ä¸­åº”ç”¨äº†å“ªäº›è®¾è®¡æ¨¡å¼å‘¢" tabindex="-1"><a class="header-anchor" href="#_4-spring-ä¸­åº”ç”¨äº†å“ªäº›è®¾è®¡æ¨¡å¼å‘¢" aria-hidden="true">#</a> 4.Spring ä¸­åº”ç”¨äº†å“ªäº›è®¾è®¡æ¨¡å¼å‘¢ï¼Ÿ</h3><p>Spring æ¡†æ¶ä¸­å¹¿æ³›ä½¿ç”¨äº†ä¸åŒç±»å‹çš„è®¾è®¡æ¨¡å¼ï¼Œä¸‹é¢æˆ‘ä»¬æ¥çœ‹çœ‹åˆ°åº•æœ‰å“ªäº›è®¾è®¡æ¨¡å¼?</p><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/spring-ee1c5cee-8462-4bae-93ea-ec936cc77640.png" alt="Springä¸­ç”¨åˆ°çš„è®¾è®¡æ¨¡å¼" loading="lazy"></p><ol><li><strong>å·¥å‚æ¨¡å¼</strong> : Spring å®¹å™¨æœ¬è´¨æ˜¯ä¸€ä¸ªå¤§å·¥å‚ï¼Œä½¿ç”¨å·¥å‚æ¨¡å¼é€šè¿‡ BeanFactoryã€ApplicationContext åˆ›å»º bean å¯¹è±¡ã€‚</li><li><strong>ä»£ç†æ¨¡å¼</strong> : Spring AOP åŠŸèƒ½åŠŸèƒ½å°±æ˜¯é€šè¿‡ä»£ç†æ¨¡å¼æ¥å®ç°çš„ï¼Œåˆ†ä¸ºåŠ¨æ€ä»£ç†å’Œé™æ€ä»£ç†ã€‚</li><li><strong>å•ä¾‹æ¨¡å¼</strong> : Spring ä¸­çš„ Bean é»˜è®¤éƒ½æ˜¯å•ä¾‹çš„ï¼Œè¿™æ ·æœ‰åˆ©äºå®¹å™¨å¯¹ Bean çš„ç®¡ç†ã€‚</li><li><strong>æ¨¡æ¿æ¨¡å¼</strong> : Spring ä¸­ JdbcTemplateã€RestTemplate ç­‰ä»¥ Template ç»“å°¾çš„å¯¹æ•°æ®åº“ã€ç½‘ç»œç­‰ç­‰è¿›è¡Œæ“ä½œçš„æ¨¡æ¿ç±»ï¼Œå°±ä½¿ç”¨åˆ°äº†æ¨¡æ¿æ¨¡å¼ã€‚</li><li><strong>è§‚å¯Ÿè€…æ¨¡å¼</strong>: Spring äº‹ä»¶é©±åŠ¨æ¨¡å‹å°±æ˜¯è§‚å¯Ÿè€…æ¨¡å¼å¾ˆç»å…¸çš„ä¸€ä¸ªåº”ç”¨ã€‚</li><li><strong>é€‚é…å™¨æ¨¡å¼</strong> :Spring AOP çš„å¢å¼ºæˆ–é€šçŸ¥ (Advice) ä½¿ç”¨åˆ°äº†é€‚é…å™¨æ¨¡å¼ã€Spring MVC ä¸­ä¹Ÿæ˜¯ç”¨åˆ°äº†é€‚é…å™¨æ¨¡å¼é€‚é… Controllerã€‚</li><li><strong>ç­–ç•¥æ¨¡å¼</strong>ï¼šSpring ä¸­æœ‰ä¸€ä¸ª Resource æ¥å£ï¼Œå®ƒçš„ä¸åŒå®ç°ç±»ï¼Œä¼šæ ¹æ®ä¸åŒçš„ç­–ç•¥å»è®¿é—®èµ„æºã€‚</li></ol><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/xingbiaogongzhonghao.png" alt="" loading="lazy"></p><h2 id="ioc" tabindex="-1"><a class="header-anchor" href="#ioc" aria-hidden="true">#</a> IOC</h2><h3 id="_5-è¯´ä¸€è¯´ä»€ä¹ˆæ˜¯-ioc-ä»€ä¹ˆæ˜¯-di" tabindex="-1"><a class="header-anchor" href="#_5-è¯´ä¸€è¯´ä»€ä¹ˆæ˜¯-ioc-ä»€ä¹ˆæ˜¯-di" aria-hidden="true">#</a> 5.è¯´ä¸€è¯´ä»€ä¹ˆæ˜¯ IOCï¼Ÿä»€ä¹ˆæ˜¯ DI?</h3><p>Java æ˜¯é¢å‘å¯¹è±¡çš„ç¼–ç¨‹è¯­è¨€ï¼Œä¸€ä¸ªä¸ªå®ä¾‹å¯¹è±¡ç›¸äº’åˆä½œç»„æˆäº†ä¸šåŠ¡é€»è¾‘ï¼ŒåŸæ¥ï¼Œæˆ‘ä»¬éƒ½æ˜¯åœ¨ä»£ç é‡Œåˆ›å»ºå¯¹è±¡å’Œå¯¹è±¡çš„ä¾èµ–ã€‚</p><p>æ‰€è°“çš„<strong>IOC</strong>ï¼ˆæ§åˆ¶åè½¬ï¼‰ï¼šå°±æ˜¯ç”±å®¹å™¨æ¥è´Ÿè´£æ§åˆ¶å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸå’Œå¯¹è±¡é—´çš„å…³ç³»ã€‚ä»¥å‰æ˜¯æˆ‘ä»¬æƒ³è¦ä»€ä¹ˆï¼Œå°±è‡ªå·±åˆ›å»ºä»€ä¹ˆï¼Œç°åœ¨æ˜¯æˆ‘ä»¬éœ€è¦ä»€ä¹ˆï¼Œå®¹å™¨å°±ç»™æˆ‘ä»¬é€æ¥ä»€ä¹ˆã€‚</p><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/spring-619da277-c15e-4dd7-9f2b-dbd809a9aaa0.png" alt="å¼•å…¥IOCä¹‹å‰å’Œå¼•å…¥IOCä¹‹å" loading="lazy"></p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œæ§åˆ¶å¯¹è±¡ç”Ÿå‘½å‘¨æœŸçš„ä¸å†æ˜¯å¼•ç”¨å®ƒçš„å¯¹è±¡ï¼Œè€Œæ˜¯å®¹å™¨ã€‚å¯¹å…·ä½“å¯¹è±¡ï¼Œä»¥å‰æ˜¯å®ƒæ§åˆ¶å…¶å®ƒå¯¹è±¡ï¼Œç°åœ¨æ‰€æœ‰å¯¹è±¡éƒ½è¢«å®¹å™¨æ§åˆ¶ï¼Œæ‰€ä»¥è¿™å°±å«<strong>æ§åˆ¶åè½¬</strong>ã€‚</p><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/spring-440f5d0e-f4db-462c-97fb-d54407a354d5.png" alt="æ§åˆ¶åè½¬ç¤ºæ„å›¾" loading="lazy"></p><p><strong>DIï¼ˆä¾èµ–æ³¨å…¥ï¼‰</strong>ï¼šæŒ‡çš„æ˜¯å®¹å™¨åœ¨å®ä¾‹åŒ–å¯¹è±¡çš„æ—¶å€™æŠŠå®ƒä¾èµ–çš„ç±»æ³¨å…¥ç»™å®ƒã€‚æœ‰çš„è¯´æ³• IOC å’Œ DI æ˜¯ä¸€å›äº‹ï¼Œæœ‰çš„è¯´æ³•æ˜¯ IOC æ˜¯æ€æƒ³ï¼ŒDI æ˜¯ IOC çš„å®ç°ã€‚</p><blockquote><p><strong>ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ IOC å‘¢ï¼Ÿ</strong></p></blockquote><p>æœ€ä¸»è¦çš„æ˜¯ä¸¤ä¸ªå­—<strong>è§£è€¦</strong>ï¼Œç¡¬ç¼–ç ä¼šé€ æˆå¯¹è±¡é—´çš„è¿‡åº¦è€¦åˆï¼Œä½¿ç”¨ IOC ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥ä¸ç”¨å…³å¿ƒå¯¹è±¡é—´çš„ä¾èµ–ï¼Œä¸“å¿ƒå¼€å‘åº”ç”¨å°±è¡Œã€‚</p><h3 id="_6-èƒ½ç®€å•è¯´ä¸€ä¸‹-spring-ioc-çš„å®ç°æœºåˆ¶å—" tabindex="-1"><a class="header-anchor" href="#_6-èƒ½ç®€å•è¯´ä¸€ä¸‹-spring-ioc-çš„å®ç°æœºåˆ¶å—" aria-hidden="true">#</a> 6.èƒ½ç®€å•è¯´ä¸€ä¸‹ Spring IOC çš„å®ç°æœºåˆ¶å—ï¼Ÿ</h3><p>PS:è¿™é“é¢˜è€ä¸‰åœ¨é¢è¯•ä¸­è¢«é—®åˆ°è¿‡ï¼Œé—®æ³•æ˜¯â€œ<strong>ä½ æœ‰è‡ªå·±å®ç°è¿‡ç®€å•çš„ Spring å—ï¼Ÿ</strong>â€</p><p>Spring çš„ IOC æœ¬è´¨å°±æ˜¯ä¸€ä¸ªå¤§å·¥å‚ï¼Œæˆ‘ä»¬æƒ³æƒ³ä¸€ä¸ªå·¥å‚æ˜¯æ€ä¹ˆè¿è¡Œçš„å‘¢ï¼Ÿ</p><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/spring-7678c40f-a48d-4bd5-80f8-e902ad688e11.png" alt="å·¥å‚è¿è¡Œ" loading="lazy"></p><ul><li><p><strong>ç”Ÿäº§äº§å“</strong>ï¼šä¸€ä¸ªå·¥å‚æœ€æ ¸å¿ƒçš„åŠŸèƒ½å°±æ˜¯ç”Ÿäº§äº§å“ã€‚åœ¨ Spring é‡Œï¼Œä¸ç”¨ Bean è‡ªå·±æ¥å®ä¾‹åŒ–ï¼Œè€Œæ˜¯äº¤ç»™ Springï¼Œåº”è¯¥æ€ä¹ˆå®ç°å‘¢ï¼Ÿâ€”â€”ç­”æ¡ˆæ¯«æ— ç–‘é—®ï¼Œ<strong>åå°„</strong>ã€‚</p><p>é‚£ä¹ˆè¿™ä¸ªå‚å­çš„ç”Ÿäº§ç®¡ç†æ˜¯æ€ä¹ˆåšçš„ï¼Ÿä½ åº”è¯¥ä¹ŸçŸ¥é“â€”â€”<strong>å·¥å‚æ¨¡å¼</strong>ã€‚</p></li><li><p><strong>åº“å­˜äº§å“</strong>ï¼šå·¥å‚ä¸€èˆ¬éƒ½æ˜¯æœ‰åº“æˆ¿çš„ï¼Œç”¨æ¥åº“å­˜äº§å“ï¼Œæ¯•ç«Ÿç”Ÿäº§çš„äº§å“ä¸èƒ½ç«‹é©¬å°±æ‹‰èµ°ã€‚Spring æˆ‘ä»¬éƒ½çŸ¥é“æ˜¯ä¸€ä¸ªå®¹å™¨ï¼Œè¿™ä¸ªå®¹å™¨é‡Œå­˜çš„å°±æ˜¯å¯¹è±¡ï¼Œä¸èƒ½æ¯æ¬¡æ¥å–å¯¹è±¡ï¼Œéƒ½å¾—ç°åœºæ¥åå°„åˆ›å»ºå¯¹è±¡ï¼Œå¾—æŠŠåˆ›å»ºå‡ºçš„å¯¹è±¡å­˜èµ·æ¥ã€‚</p></li><li><p><strong>è®¢å•å¤„ç†</strong>ï¼šè¿˜æœ‰æœ€é‡è¦çš„ä¸€ç‚¹ï¼Œå·¥å‚æ ¹æ®ä»€ä¹ˆæ¥æä¾›äº§å“å‘¢ï¼Ÿè®¢å•ã€‚è¿™äº›è®¢å•å¯èƒ½äº”èŠ±å…«é—¨ï¼Œæœ‰çº¿ä¸Šç­¾ç­¾çš„ã€æœ‰åˆ°å·¥å‚ç­¾çš„ã€è¿˜æœ‰å·¥å‚é”€å”®ä¸Šé—¨ç­¾çš„â€¦â€¦æœ€åç»è¿‡å¤„ç†ï¼ŒæŒ‡å¯¼å·¥å‚çš„å‡ºè´§ã€‚</p><p>åœ¨ Spring é‡Œï¼Œä¹Ÿæœ‰è¿™æ ·çš„è®¢å•ï¼Œå®ƒå°±æ˜¯æˆ‘ä»¬ bean çš„å®šä¹‰å’Œä¾èµ–å…³ç³»ï¼Œå¯ä»¥æ˜¯ xml å½¢å¼ï¼Œä¹Ÿå¯ä»¥æ˜¯æˆ‘ä»¬æœ€ç†Ÿæ‚‰çš„æ³¨è§£å½¢å¼ã€‚</p></li></ul><p>æˆ‘ä»¬ç®€å•åœ°å®ç°ä¸€ä¸ª mini ç‰ˆçš„ Spring IOCï¼š</p><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/spring-1d55c63d-2d12-43b1-9f43-428f5f4a1413.png" alt="miniç‰ˆæœ¬Spring IOC" loading="lazy"></p><p><strong>Bean å®šä¹‰ï¼š</strong></p><p>Bean é€šè¿‡ä¸€ä¸ªé…ç½®æ–‡ä»¶å®šä¹‰ï¼ŒæŠŠå®ƒè§£ææˆä¸€ä¸ªç±»å‹ã€‚</p><ul><li><p>beans.properties</p><p>å·æ‡’ï¼Œè¿™é‡Œç›´æ¥ç”¨äº†æœ€æ–¹ä¾¿è§£æçš„ propertiesï¼Œè¿™é‡Œç›´æ¥ç”¨ä¸€ä¸ª<code>&lt;key,value&gt;</code>ç±»å‹çš„é…ç½®æ¥ä»£è¡¨ Bean çš„å®šä¹‰ï¼Œå…¶ä¸­ key æ˜¯ beanNameï¼Œvalue æ˜¯ class</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>userDao<span class="token operator">:</span><span class="token class-name"><span class="token namespace">cn<span class="token punctuation">.</span>fighter3<span class="token punctuation">.</span>bean<span class="token punctuation">.</span></span>UserDao</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p>BeanDefinition.java</p><p>bean å®šä¹‰ç±»ï¼Œé…ç½®æ–‡ä»¶ä¸­ bean å®šä¹‰å¯¹åº”çš„å®ä½“</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BeanDefinition</span> <span class="token punctuation">{</span>\n\n    <span class="token keyword">private</span> <span class="token class-name">String</span> beanName<span class="token punctuation">;</span>\n\n    <span class="token keyword">private</span> <span class="token class-name">Class</span> beanClass<span class="token punctuation">;</span>\n     <span class="token comment">//çœç•¥getterã€setter</span>\n <span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>ResourceLoader.java</p><p>èµ„æºåŠ è½½å™¨ï¼Œç”¨æ¥å®Œæˆé…ç½®æ–‡ä»¶ä¸­é…ç½®çš„åŠ è½½</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ResourceLoader</span> <span class="token punctuation">{</span>\n\n    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">BeanDefinition</span><span class="token punctuation">&gt;</span></span> <span class="token function">getResource</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">BeanDefinition</span><span class="token punctuation">&gt;</span></span> beanDefinitionMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token class-name">Properties</span> properties <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Properties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token keyword">try</span> <span class="token punctuation">{</span>\n            <span class="token class-name">InputStream</span> inputStream <span class="token operator">=</span> <span class="token class-name">ResourceLoader</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getResourceAsStream</span><span class="token punctuation">(</span><span class="token string">&quot;/beans.properties&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n            properties<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>inputStream<span class="token punctuation">)</span><span class="token punctuation">;</span>\n            <span class="token class-name">Iterator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> it <span class="token operator">=</span> properties<span class="token punctuation">.</span><span class="token function">stringPropertyNames</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">iterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n            <span class="token keyword">while</span> <span class="token punctuation">(</span>it<span class="token punctuation">.</span><span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n                <span class="token class-name">String</span> key <span class="token operator">=</span> it<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n                <span class="token class-name">String</span> className <span class="token operator">=</span> properties<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>\n                <span class="token class-name">BeanDefinition</span> beanDefinition <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BeanDefinition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n                beanDefinition<span class="token punctuation">.</span><span class="token function">setBeanName</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>\n                <span class="token class-name">Class</span> clazz <span class="token operator">=</span> <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span>className<span class="token punctuation">)</span><span class="token punctuation">;</span>\n                beanDefinition<span class="token punctuation">.</span><span class="token function">setBeanClass</span><span class="token punctuation">(</span>clazz<span class="token punctuation">)</span><span class="token punctuation">;</span>\n                beanDefinitionMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> beanDefinition<span class="token punctuation">)</span><span class="token punctuation">;</span>\n            <span class="token punctuation">}</span>\n            inputStream<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> <span class="token operator">|</span> <span class="token class-name">ClassNotFoundException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n        <span class="token keyword">return</span> beanDefinitionMap<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>BeanRegister.java</p><p>å¯¹è±¡æ³¨å†Œå™¨ï¼Œè¿™é‡Œç”¨äºå•ä¾‹ bean çš„ç¼“å­˜ï¼Œæˆ‘ä»¬å¤§å¹…ç®€åŒ–ï¼Œé»˜è®¤æ‰€æœ‰ bean éƒ½æ˜¯å•ä¾‹çš„ã€‚å¯ä»¥çœ‹åˆ°æ‰€è°“å•ä¾‹æ³¨å†Œï¼Œä¹Ÿå¾ˆç®€å•ï¼Œä¸è¿‡æ˜¯å¾€ HashMap é‡Œå­˜å¯¹è±¡ã€‚</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BeanRegister</span> <span class="token punctuation">{</span>\n\n    <span class="token comment">//å•ä¾‹Beanç¼“å­˜</span>\n    <span class="token keyword">private</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> singletonMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token doc-comment comment">/**\n     * è·å–å•ä¾‹Bean\n     *\n     * <span class="token keyword">@param</span> <span class="token parameter">beanName</span> beanåç§°\n     * <span class="token keyword">@return</span>\n     */</span>\n    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">getSingletonBean</span><span class="token punctuation">(</span><span class="token class-name">String</span> beanName<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token keyword">return</span> singletonMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>beanName<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token doc-comment comment">/**\n     * æ³¨å†Œå•ä¾‹bean\n     *\n     * <span class="token keyword">@param</span> <span class="token parameter">beanName</span>\n     * <span class="token keyword">@param</span> <span class="token parameter">bean</span>\n     */</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">registerSingletonBean</span><span class="token punctuation">(</span><span class="token class-name">String</span> beanName<span class="token punctuation">,</span> <span class="token class-name">Object</span> bean<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token keyword">if</span> <span class="token punctuation">(</span>singletonMap<span class="token punctuation">.</span><span class="token function">containsKey</span><span class="token punctuation">(</span>beanName<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n            <span class="token keyword">return</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n        singletonMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>beanName<span class="token punctuation">,</span> bean<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>BeanFactory.java</strong></p></li></ul><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/spring-c6b3b707-cf53-4c7c-a6f9-8560950806fc.png" alt="BeanFactory" loading="lazy"></p><ul><li><p>å¯¹è±¡å·¥å‚ï¼Œæˆ‘ä»¬æœ€<strong>æ ¸å¿ƒ</strong>çš„ä¸€ä¸ªç±»ï¼Œåœ¨å®ƒåˆå§‹åŒ–çš„æ—¶å€™ï¼Œåˆ›å»ºäº† bean æ³¨å†Œå™¨ï¼Œå®Œæˆäº†èµ„æºçš„åŠ è½½ã€‚</p></li><li><p>è·å– bean çš„æ—¶å€™ï¼Œå…ˆä»å•ä¾‹ç¼“å­˜ä¸­å–ï¼Œå¦‚æœæ²¡æœ‰å–åˆ°ï¼Œå°±åˆ›å»ºå¹¶æ³¨å†Œä¸€ä¸ª bean</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BeanFactory</span> <span class="token punctuation">{</span>\n\n    <span class="token keyword">private</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">BeanDefinition</span><span class="token punctuation">&gt;</span></span> beanDefinitionMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">private</span> <span class="token class-name">BeanRegister</span> beanRegister<span class="token punctuation">;</span>\n\n    <span class="token keyword">public</span> <span class="token class-name">BeanFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token comment">//åˆ›å»ºbeanæ³¨å†Œå™¨</span>\n        beanRegister <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BeanRegister</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token comment">//åŠ è½½èµ„æº</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>beanDefinitionMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ResourceLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getResource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token doc-comment comment">/**\n     * è·å–bean\n     *\n     * <span class="token keyword">@param</span> <span class="token parameter">beanName</span> beanåç§°\n     * <span class="token keyword">@return</span>\n     */</span>\n    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">getBean</span><span class="token punctuation">(</span><span class="token class-name">String</span> beanName<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token comment">//ä»beanç¼“å­˜ä¸­å–</span>\n        <span class="token class-name">Object</span> bean <span class="token operator">=</span> beanRegister<span class="token punctuation">.</span><span class="token function">getSingletonBean</span><span class="token punctuation">(</span>beanName<span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token keyword">if</span> <span class="token punctuation">(</span>bean <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n            <span class="token keyword">return</span> bean<span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n        <span class="token comment">//æ ¹æ®beanå®šä¹‰ï¼Œåˆ›å»ºbean</span>\n        <span class="token keyword">return</span> <span class="token function">createBean</span><span class="token punctuation">(</span>beanDefinitionMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>beanName<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token doc-comment comment">/**\n     * åˆ›å»ºBean\n     *\n     * <span class="token keyword">@param</span> <span class="token parameter">beanDefinition</span> beanå®šä¹‰\n     * <span class="token keyword">@return</span>\n     */</span>\n    <span class="token keyword">private</span> <span class="token class-name">Object</span> <span class="token function">createBean</span><span class="token punctuation">(</span><span class="token class-name">BeanDefinition</span> beanDefinition<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token keyword">try</span> <span class="token punctuation">{</span>\n            <span class="token class-name">Object</span> bean <span class="token operator">=</span> beanDefinition<span class="token punctuation">.</span><span class="token function">getBeanClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n            <span class="token comment">//ç¼“å­˜bean</span>\n            beanRegister<span class="token punctuation">.</span><span class="token function">registerSingletonBean</span><span class="token punctuation">(</span>beanDefinition<span class="token punctuation">.</span><span class="token function">getBeanName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> bean<span class="token punctuation">)</span><span class="token punctuation">;</span>\n            <span class="token keyword">return</span> bean<span class="token punctuation">;</span>\n        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InstantiationException</span> <span class="token operator">|</span> <span class="token class-name">IllegalAccessException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>æµ‹è¯•</p><ul><li><p>UserDao.java</p><p>æˆ‘ä»¬çš„ Bean ç±»ï¼Œå¾ˆç®€å•</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserDao</span> <span class="token punctuation">{</span>\n\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">queryUserInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>\n        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;A good man.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>å•å…ƒæµ‹è¯•</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ApiTest</span> <span class="token punctuation">{</span>\n    <span class="token annotation punctuation">@Test</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test_BeanFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token comment">//1.åˆ›å»ºbeanå·¥å‚(åŒæ—¶å®Œæˆäº†åŠ è½½èµ„æºã€åˆ›å»ºæ³¨å†Œå•ä¾‹beanæ³¨å†Œå™¨çš„æ“ä½œ)</span>\n        <span class="token class-name">BeanFactory</span> beanFactory <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BeanFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n        <span class="token comment">//2.ç¬¬ä¸€æ¬¡è·å–beanï¼ˆé€šè¿‡åå°„åˆ›å»ºbeanï¼Œç¼“å­˜beanï¼‰</span>\n        <span class="token class-name">UserDao</span> userDao1 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">UserDao</span><span class="token punctuation">)</span> beanFactory<span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span><span class="token string">&quot;userDao&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        userDao1<span class="token punctuation">.</span><span class="token function">queryUserInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n        <span class="token comment">//3.ç¬¬äºŒæ¬¡è·å–beanï¼ˆä»ç¼“å­˜ä¸­è·å–beanï¼‰</span>\n        <span class="token class-name">UserDao</span> userDao2 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">UserDao</span><span class="token punctuation">)</span> beanFactory<span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span><span class="token string">&quot;userDao&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        userDao2<span class="token punctuation">.</span><span class="token function">queryUserInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>è¿è¡Œç»“æœ</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">A</span> good <span class="token class-name"><span class="token namespace">man<span class="token punctuation">.</span></span>\nA</span> good man<span class="token punctuation">.</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div></li></ul></li></ul><p>è‡³æ­¤ï¼Œæˆ‘ä»¬ä¸€ä¸ªä¹ä¸+ç ´èˆ¹ç‰ˆçš„ Spring å°±å®Œæˆäº†ï¼Œä»£ç ä¹Ÿæ¯”è¾ƒå®Œæ•´ï¼Œæœ‰æ¡ä»¶çš„å¯ä»¥è·‘ä¸€ä¸‹ã€‚</p><p>PS:å› ä¸ºæ—¶é—´+ç¯‡å¹…çš„é™åˆ¶ï¼Œè¿™ä¸ª demo æ¯”è¾ƒç®€é™‹ï¼Œæ²¡æœ‰é¢å‘æ¥å£ã€æ²¡æœ‰è§£è€¦ã€è¾¹ç•Œæ£€æŸ¥ã€å¼‚å¸¸å¤„ç†â€¦â€¦å¥å£®æ€§ã€æ‰©å±•æ€§éƒ½æœ‰å¾ˆå¤§çš„ä¸è¶³ï¼Œæ„Ÿå…´è¶£å¯ä»¥å­¦ä¹ å‚è€ƒ[15]ã€‚</p><h3 id="_7-è¯´è¯´-beanfactory-å’Œ-applicantcontext" tabindex="-1"><a class="header-anchor" href="#_7-è¯´è¯´-beanfactory-å’Œ-applicantcontext" aria-hidden="true">#</a> 7.è¯´è¯´ BeanFactory å’Œ ApplicantContext?</h3><p>å¯ä»¥è¿™ä¹ˆå½¢å®¹ï¼ŒBeanFactory æ˜¯ Spring çš„â€œå¿ƒè„â€ï¼ŒApplicantContext æ˜¯å®Œæ•´çš„â€œèº«èº¯â€ã€‚</p><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/spring-66328446-f89f-4b7a-8d9f-0e1145dd9b2f.png" alt="BeanFactoryå’ŒApplicantContextçš„æ¯”å–»" loading="lazy"></p><ul><li>BeanFactoryï¼ˆBean å·¥å‚ï¼‰æ˜¯ Spring æ¡†æ¶çš„åŸºç¡€è®¾æ–½ï¼Œé¢å‘ Spring æœ¬èº«ã€‚</li><li>ApplicantContextï¼ˆåº”ç”¨ä¸Šä¸‹æ–‡ï¼‰å»ºç«‹åœ¨ BeanFactoty åŸºç¡€ä¸Šï¼Œé¢å‘ä½¿ç”¨ Spring æ¡†æ¶çš„å¼€å‘è€…ã€‚</li></ul><h6 id="beanfactory-æ¥å£" tabindex="-1"><a class="header-anchor" href="#beanfactory-æ¥å£" aria-hidden="true">#</a> BeanFactory æ¥å£</h6><p>BeanFactory æ˜¯ç±»çš„é€šç”¨å·¥å‚ï¼Œå¯ä»¥åˆ›å»ºå¹¶ç®¡ç†å„ç§ç±»çš„å¯¹è±¡ã€‚</p><p>Spring ä¸º BeanFactory æä¾›äº†å¾ˆå¤šç§å®ç°ï¼Œæœ€å¸¸ç”¨çš„æ˜¯ XmlBeanFactoryï¼Œä½†åœ¨ Spring 3.2 ä¸­å·²è¢«åºŸå¼ƒï¼Œå»ºè®®ä½¿ç”¨ XmlBeanDefinitionReaderã€DefaultListableBeanFactoryã€‚</p><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/spring-6e6d4b69-f36c-41e6-b8ba-9277be147c9b.png" alt="Spring5 BeanFactoryç»§æ‰¿ä½“ç³»" loading="lazy"></p><p>BeanFactory æ¥å£ä½äºç±»ç»“æ„æ ‘çš„é¡¶ç«¯ï¼Œå®ƒæœ€ä¸»è¦çš„æ–¹æ³•å°±æ˜¯ getBean(String var1)ï¼Œè¿™ä¸ªæ–¹æ³•ä»å®¹å™¨ä¸­è¿”å›ç‰¹å®šåç§°çš„ Beanã€‚</p><p>BeanFactory çš„åŠŸèƒ½é€šè¿‡å…¶å®ƒçš„æ¥å£å¾—åˆ°äº†ä¸æ–­çš„æ‰©å±•ï¼Œæ¯”å¦‚ AbstractAutowireCapableBeanFactory å®šä¹‰äº†å°†å®¹å™¨ä¸­çš„ Bean æŒ‰ç…§æŸç§è§„åˆ™ï¼ˆæ¯”å¦‚æŒ‰åå­—åŒ¹é…ã€æŒ‰ç±»å‹åŒ¹é…ç­‰ï¼‰è¿›è¡Œè‡ªåŠ¨è£…é…çš„æ–¹æ³•ã€‚</p><p>è¿™é‡Œçœ‹ä¸€ä¸ª XMLBeanFactoryï¼ˆå·²è¿‡æœŸï¼‰ è·å– bean çš„ä¾‹å­ï¼š</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HelloWorldApp</span><span class="token punctuation">{</span>\n   <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token class-name">BeanFactory</span> factory <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XmlBeanFactory</span> <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ClassPathResource</span><span class="token punctuation">(</span><span class="token string">&quot;beans.xml&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n      <span class="token class-name">HelloWorld</span> obj <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">HelloWorld</span><span class="token punctuation">)</span> factory<span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span><span class="token string">&quot;helloWorld&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n      obj<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n   <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h6 id="applicationcontext-æ¥å£" tabindex="-1"><a class="header-anchor" href="#applicationcontext-æ¥å£" aria-hidden="true">#</a> ApplicationContext æ¥å£</h6><p>ApplicationContext ç”± BeanFactory æ´¾ç”Ÿè€Œæ¥ï¼Œæä¾›äº†æ›´å¤šé¢å‘å®é™…åº”ç”¨çš„åŠŸèƒ½ã€‚å¯ä»¥è¿™ä¹ˆè¯´ï¼Œä½¿ç”¨ BeanFactory å°±æ˜¯æ‰‹åŠ¨æ¡£ï¼Œä½¿ç”¨ ApplicationContext å°±æ˜¯è‡ªåŠ¨æ¡£ã€‚</p><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/spring-e201c9a3-f23c-4768-b844-ac7e0ba4bcec.png" alt="Spring5 ApplicationContextéƒ¨åˆ†ä½“ç³»ç±»å›¾" loading="lazy"></p><p>ApplicationContext ç»§æ‰¿äº† HierachicalBeanFactory å’Œ ListableBeanFactory æ¥å£ï¼Œåœ¨æ­¤åŸºç¡€ä¸Šï¼Œè¿˜é€šè¿‡å…¶ä»–çš„æ¥å£æ‰©å±•äº† BeanFactory çš„åŠŸèƒ½ï¼ŒåŒ…æ‹¬ï¼š</p><ul><li><p>Bean instantiation/wiring</p></li><li><p>Bean çš„å®ä¾‹åŒ–/ä¸²è”</p></li><li><p>è‡ªåŠ¨çš„ BeanPostProcessor æ³¨å†Œ</p></li><li><p>è‡ªåŠ¨çš„ BeanFactoryPostProcessor æ³¨å†Œ</p></li><li><p>æ–¹ä¾¿çš„ MessageSource è®¿é—®ï¼ˆi18nï¼‰</p></li><li><p>ApplicationEvent çš„å‘å¸ƒä¸ BeanFactory æ‡’åŠ è½½çš„æ–¹å¼ä¸åŒï¼Œå®ƒæ˜¯é¢„åŠ è½½ï¼Œæ‰€ä»¥ï¼Œæ¯ä¸€ä¸ª bean éƒ½åœ¨ ApplicationContext å¯åŠ¨ä¹‹åå®ä¾‹åŒ–</p></li></ul><p>è¿™æ˜¯ ApplicationContext çš„ä½¿ç”¨ä¾‹å­ï¼š</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HelloWorldApp</span><span class="token punctuation">{</span>\n   <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token class-name">ApplicationContext</span> context<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">ClassPathXmlApplicationContext</span><span class="token punctuation">(</span><span class="token string">&quot;beans.xml&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n      <span class="token class-name">HelloWorld</span> obj <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">HelloWorld</span><span class="token punctuation">)</span> context<span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span><span class="token string">&quot;helloWorld&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n      obj<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n   <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ApplicationContext åŒ…å« BeanFactory çš„æ‰€æœ‰ç‰¹æ€§ï¼Œé€šå¸¸æ¨èä½¿ç”¨å‰è€…ã€‚</p><h3 id="_8-ä½ çŸ¥é“-spring-å®¹å™¨å¯åŠ¨é˜¶æ®µä¼šå¹²ä»€ä¹ˆå—" tabindex="-1"><a class="header-anchor" href="#_8-ä½ çŸ¥é“-spring-å®¹å™¨å¯åŠ¨é˜¶æ®µä¼šå¹²ä»€ä¹ˆå—" aria-hidden="true">#</a> 8.ä½ çŸ¥é“ Spring å®¹å™¨å¯åŠ¨é˜¶æ®µä¼šå¹²ä»€ä¹ˆå—ï¼Ÿ</h3><p>PSï¼šè¿™é“é¢˜è€ä¸‰é¢è¯•è¢«é—®åˆ°è¿‡</p><p>Spring çš„ IOC å®¹å™¨å·¥ä½œçš„è¿‡ç¨‹ï¼Œå…¶å®å¯ä»¥åˆ’åˆ†ä¸ºä¸¤ä¸ªé˜¶æ®µï¼š<strong>å®¹å™¨å¯åŠ¨é˜¶æ®µ</strong>å’Œ<strong>Bean å®ä¾‹åŒ–é˜¶æ®µ</strong>ã€‚</p><p>å…¶ä¸­å®¹å™¨å¯åŠ¨é˜¶æ®µä¸»è¦åšçš„å·¥ä½œæ˜¯åŠ è½½å’Œè§£æé…ç½®æ–‡ä»¶ï¼Œä¿å­˜åˆ°å¯¹åº”çš„ Bean å®šä¹‰ä¸­ã€‚</p><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/spring-8f8103f7-2a51-4858-856e-96a4ac400d76.png" alt="å®¹å™¨å¯åŠ¨å’ŒBeanå®ä¾‹åŒ–é˜¶æ®µ" loading="lazy"></p><p>å®¹å™¨å¯åŠ¨å¼€å§‹ï¼Œé¦–å…ˆä¼šé€šè¿‡æŸç§é€”å¾„åŠ è½½ Congiguration MetaDataï¼Œåœ¨å¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œå®¹å™¨éœ€è¦ä¾èµ–æŸäº›å·¥å…·ç±»ï¼ˆBeanDefinitionReaderï¼‰å¯¹åŠ è½½çš„ Congiguration MetaData è¿›è¡Œè§£æå’Œåˆ†æï¼Œå¹¶å°†åˆ†æåçš„ä¿¡æ¯ç»„ä¸ºç›¸åº”çš„ BeanDefinitionã€‚</p><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/spring-dfb3d8c4-ba8d-4a2c-aef2-4ad425f7180c.png" alt="xmlé…ç½®ä¿¡æ¯æ˜ å°„æ³¨å†Œè¿‡ç¨‹" loading="lazy"></p><p>æœ€åæŠŠè¿™äº›ä¿å­˜äº† Bean å®šä¹‰å¿…è¦ä¿¡æ¯çš„ BeanDefinitionï¼Œæ³¨å†Œåˆ°ç›¸åº”çš„ BeanDefinitionRegistryï¼Œè¿™æ ·å®¹å™¨å¯åŠ¨å°±å®Œæˆäº†ã€‚</p><h3 id="_9-èƒ½è¯´ä¸€ä¸‹-spring-bean-ç”Ÿå‘½å‘¨æœŸå—" tabindex="-1"><a class="header-anchor" href="#_9-èƒ½è¯´ä¸€ä¸‹-spring-bean-ç”Ÿå‘½å‘¨æœŸå—" aria-hidden="true">#</a> 9.èƒ½è¯´ä¸€ä¸‹ Spring Bean ç”Ÿå‘½å‘¨æœŸå—ï¼Ÿ</h3>',96),k=(0,e.Uk)("å¯ä»¥çœ‹çœ‹ï¼š"),v={href:"https://mp.weixin.qq.com/s/zb6eA3Se0gQoqL8PylCPLw",target:"_blank",rel:"noopener noreferrer"},m=(0,e.Uk)("Spring Bean ç”Ÿå‘½å‘¨æœŸï¼Œå¥½åƒäººçš„ä¸€ç”Ÿã€‚ã€‚"),g=(0,e.uE)('<p>åœ¨ Spring ä¸­ï¼ŒåŸºæœ¬å®¹å™¨ BeanFactory å’Œæ‰©å±•å®¹å™¨ ApplicationContext çš„å®ä¾‹åŒ–æ—¶æœºä¸å¤ªä¸€æ ·ï¼ŒBeanFactory é‡‡ç”¨çš„æ˜¯å»¶è¿Ÿåˆå§‹åŒ–çš„æ–¹å¼ï¼Œä¹Ÿå°±æ˜¯åªæœ‰åœ¨ç¬¬ä¸€æ¬¡ getBean()çš„æ—¶å€™ï¼Œæ‰ä¼šå®ä¾‹åŒ– Beanï¼›ApplicationContext å¯åŠ¨ä¹‹åä¼šå®ä¾‹åŒ–æ‰€æœ‰çš„ Bean å®šä¹‰ã€‚</p><p>Spring IOC ä¸­ Bean çš„ç”Ÿå‘½å‘¨æœŸå¤§è‡´åˆ†ä¸ºå››ä¸ªé˜¶æ®µï¼š<strong>å®ä¾‹åŒ–</strong>ï¼ˆInstantiationï¼‰ã€<strong>å±æ€§èµ‹å€¼</strong>ï¼ˆPopulateï¼‰ã€<strong>åˆå§‹åŒ–</strong>ï¼ˆInitializationï¼‰ã€<strong>é”€æ¯</strong>ï¼ˆDestructionï¼‰ã€‚</p><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/spring-595fce5b-36cb-4dcb-b08c-8205a1e98d8a.png" alt="Beanç”Ÿå‘½å‘¨æœŸå››ä¸ªé˜¶æ®µ" loading="lazy"></p><p>æˆ‘ä»¬å†æ¥çœ‹ä¸€ä¸ªç¨å¾®è¯¦ç»†ä¸€äº›çš„è¿‡ç¨‹ï¼š</p><ul><li><strong>å®ä¾‹åŒ–</strong>ï¼šç¬¬ 1 æ­¥ï¼Œå®ä¾‹åŒ–ä¸€ä¸ª Bean å¯¹è±¡</li><li><strong>å±æ€§èµ‹å€¼</strong>ï¼šç¬¬ 2 æ­¥ï¼Œä¸º Bean è®¾ç½®ç›¸å…³å±æ€§å’Œä¾èµ–</li><li><strong>åˆå§‹åŒ–</strong>ï¼šåˆå§‹åŒ–çš„é˜¶æ®µçš„æ­¥éª¤æ¯”è¾ƒå¤šï¼Œ5ã€6 æ­¥æ˜¯çœŸæ­£çš„åˆå§‹åŒ–ï¼Œç¬¬ 3ã€4 æ­¥ä¸ºåœ¨åˆå§‹åŒ–å‰æ‰§è¡Œï¼Œç¬¬ 7 æ­¥åœ¨åˆå§‹åŒ–åæ‰§è¡Œï¼Œåˆå§‹åŒ–å®Œæˆä¹‹åï¼ŒBean å°±å¯ä»¥è¢«ä½¿ç”¨äº†</li><li><strong>é”€æ¯</strong>ï¼šç¬¬ 8~10 æ­¥ï¼Œç¬¬ 8 æ­¥å…¶å®ä¹Ÿå¯ä»¥ç®—åˆ°é”€æ¯é˜¶æ®µï¼Œä½†ä¸æ˜¯çœŸæ­£æ„ä¹‰ä¸Šçš„é”€æ¯ï¼Œè€Œæ˜¯å…ˆåœ¨ä½¿ç”¨å‰æ³¨å†Œäº†é”€æ¯çš„ç›¸å…³è°ƒç”¨æ¥å£ï¼Œä¸ºäº†åé¢ç¬¬ 9ã€10 æ­¥çœŸæ­£é”€æ¯ Bean æ—¶å†æ‰§è¡Œç›¸åº”çš„æ–¹æ³•</li></ul><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/spring-942a927a-86e4-4a01-8f52-9addd89642ff.png" alt="SpringBeanç”Ÿå‘½å‘¨æœŸ" loading="lazy"></p><p>ç®€å•æ€»ç»“ä¸€ä¸‹ï¼ŒBean ç”Ÿå‘½å‘¨æœŸé‡Œåˆå§‹åŒ–çš„è¿‡ç¨‹ç›¸å¯¹æ­¥éª¤ä¼šå¤šä¸€äº›ï¼Œæ¯”å¦‚å‰ç½®ã€åç½®çš„å¤„ç†ã€‚</p><p>æœ€åé€šè¿‡ä¸€ä¸ªå®ä¾‹æ¥çœ‹ä¸€ä¸‹å…·ä½“çš„ç»†èŠ‚ï¼š <img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/spring-a3b7714e-38f2-433d-97c6-acb1d20f2887.png" alt="Beanä¸€ç”Ÿå®ä¾‹" loading="lazy"></p><ul><li>å®šä¹‰ä¸€ä¸ª<code>PersonBean</code>ç±»ï¼Œå®ç°<code>DisposableBean</code>,<code>InitializingBean</code>, <code>BeanFactoryAware</code>, <code>BeanNameAware</code>è¿™ 4 ä¸ªæ¥å£ï¼ŒåŒæ—¶è¿˜æœ‰è‡ªå®šä¹‰çš„<code>init-method</code>å’Œ<code>destroy-method</code>ã€‚</li></ul><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PersonBean</span> <span class="token keyword">implements</span> <span class="token class-name">InitializingBean</span><span class="token punctuation">,</span> <span class="token class-name">BeanFactoryAware</span><span class="token punctuation">,</span> <span class="token class-name">BeanNameAware</span><span class="token punctuation">,</span> <span class="token class-name">DisposableBean</span> <span class="token punctuation">{</span>\n\n    <span class="token doc-comment comment">/**\n     * èº«ä»½è¯å·\n     */</span>\n    <span class="token keyword">private</span> <span class="token class-name">Integer</span> no<span class="token punctuation">;</span>\n\n    <span class="token doc-comment comment">/**\n     * å§“å\n     */</span>\n    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>\n\n    <span class="token keyword">public</span> <span class="token class-name">PersonBean</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;1.è°ƒç”¨æ„é€ æ–¹æ³•ï¼šæˆ‘å‡ºç”Ÿäº†ï¼&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">public</span> <span class="token class-name">Integer</span> <span class="token function">getNo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token keyword">return</span> no<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setNo</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> no<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>no <span class="token operator">=</span> no<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token keyword">return</span> name<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setName</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>\n        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;2.è®¾ç½®å±æ€§ï¼šæˆ‘çš„åå­—å«&quot;</span><span class="token operator">+</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token annotation punctuation">@Override</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setBeanName</span><span class="token punctuation">(</span><span class="token class-name">String</span> s<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;3.è°ƒç”¨BeanNameAware#setBeanNameæ–¹æ³•:æˆ‘è¦ä¸Šå­¦äº†ï¼Œèµ·äº†ä¸ªå­¦å&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token annotation punctuation">@Override</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setBeanFactory</span><span class="token punctuation">(</span><span class="token class-name">BeanFactory</span> beanFactory<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">BeansException</span> <span class="token punctuation">{</span>\n        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;4.è°ƒç”¨BeanFactoryAware#setBeanFactoryæ–¹æ³•ï¼šé€‰å¥½å­¦æ ¡äº†&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token annotation punctuation">@Override</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">afterPropertiesSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>\n        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;6.InitializingBean#afterPropertiesSetæ–¹æ³•ï¼šå…¥å­¦ç™»è®°&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;7.è‡ªå®šä¹‰initæ–¹æ³•ï¼šåŠªåŠ›ä¸Šå­¦ing&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token annotation punctuation">@Override</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>\n        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;9.DisposableBean#destroyæ–¹æ³•ï¼šå¹³æ·¡çš„ä¸€ç”Ÿè½å¹•äº†&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">destroyMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;10.è‡ªå®šä¹‰destroyæ–¹æ³•:ç¡äº†ï¼Œåˆ«æƒ³å«é†’æˆ‘&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">work</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>\n        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Beanä½¿ç”¨ä¸­ï¼šå·¥ä½œï¼Œåªæœ‰å¯¹ç¤¾ä¼šæ²¡æœ‰ç”¨çš„äººæ‰æ”¾å‡ã€‚ã€‚&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>å®šä¹‰ä¸€ä¸ª<code>MyBeanPostProcessor</code>å®ç°<code>BeanPostProcessor</code>æ¥å£ã€‚</li></ul><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyBeanPostProcessor</span> <span class="token keyword">implements</span> <span class="token class-name">BeanPostProcessor</span> <span class="token punctuation">{</span>\n\n    <span class="token annotation punctuation">@Override</span>\n    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">postProcessBeforeInitialization</span><span class="token punctuation">(</span><span class="token class-name">Object</span> bean<span class="token punctuation">,</span> <span class="token class-name">String</span> beanName<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">BeansException</span> <span class="token punctuation">{</span>\n        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;5.BeanPostProcessor.postProcessBeforeInitializationæ–¹æ³•ï¼šåˆ°å­¦æ ¡æŠ¥åå•¦&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token keyword">return</span> bean<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token annotation punctuation">@Override</span>\n    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">postProcessAfterInitialization</span><span class="token punctuation">(</span><span class="token class-name">Object</span> bean<span class="token punctuation">,</span> <span class="token class-name">String</span> beanName<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">BeansException</span> <span class="token punctuation">{</span>\n        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;8.BeanPostProcessor#postProcessAfterInitializationæ–¹æ³•ï¼šç»ˆäºæ¯•ä¸šï¼Œæ‹¿åˆ°æ¯•ä¸šè¯å•¦ï¼&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token keyword">return</span> bean<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>é…ç½®æ–‡ä»¶ï¼ŒæŒ‡å®š<code>init-method</code>å’Œ<code>destroy-method</code>å±æ€§</li></ul><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token operator">&lt;</span><span class="token operator">?</span>xml version<span class="token operator">=</span><span class="token string">&quot;1.0&quot;</span> encoding<span class="token operator">=</span><span class="token string">&quot;UTF-8&quot;</span><span class="token operator">?</span><span class="token operator">&gt;</span>\n<span class="token operator">&lt;</span>beans xmlns<span class="token operator">=</span><span class="token string">&quot;http://www.springframework.org/schema/beans&quot;</span>\n       xmlns<span class="token operator">:</span>xsi<span class="token operator">=</span><span class="token string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>\n       xsi<span class="token operator">:</span>schemaLocation<span class="token operator">=</span><span class="token string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span><span class="token operator">&gt;</span>\n\n    <span class="token operator">&lt;</span>bean name<span class="token operator">=</span><span class="token string">&quot;myBeanPostProcessor&quot;</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;cn.fighter3.spring.life.MyBeanPostProcessor&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>\n    <span class="token operator">&lt;</span>bean name<span class="token operator">=</span><span class="token string">&quot;personBean&quot;</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;cn.fighter3.spring.life.PersonBean&quot;</span>\n          init<span class="token operator">-</span>method<span class="token operator">=</span><span class="token string">&quot;init&quot;</span> destroy<span class="token operator">-</span>method<span class="token operator">=</span><span class="token string">&quot;destroyMethod&quot;</span><span class="token operator">&gt;</span>\n        <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">&quot;idNo&quot;</span> value<span class="token operator">=</span> <span class="token string">&quot;80669865&quot;</span><span class="token operator">/</span><span class="token operator">&gt;</span>\n        <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">&quot;name&quot;</span> value<span class="token operator">=</span><span class="token string">&quot;å¼ é“é’¢&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>\n    <span class="token operator">&lt;</span><span class="token operator">/</span>bean<span class="token operator">&gt;</span>\n\n<span class="token operator">&lt;</span><span class="token operator">/</span>beans<span class="token operator">&gt;</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>æµ‹è¯•</li></ul><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Main</span> <span class="token punctuation">{</span>\n\n    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token class-name">ApplicationContext</span> context <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ClassPathXmlApplicationContext</span><span class="token punctuation">(</span><span class="token string">&quot;spring-config.xml&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token class-name">PersonBean</span> personBean <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">PersonBean</span><span class="token punctuation">)</span> context<span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span><span class="token string">&quot;personBean&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        personBean<span class="token punctuation">.</span><span class="token function">work</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">ClassPathXmlApplicationContext</span><span class="token punctuation">)</span> context<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>è¿è¡Œç»“æœï¼š</li></ul><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token number">1.</span>è°ƒç”¨æ„é€ æ–¹æ³•ï¼šæˆ‘å‡ºç”Ÿäº†ï¼\n<span class="token number">2.</span>è®¾ç½®å±æ€§ï¼šæˆ‘çš„åå­—å«å¼ é“é’¢\n<span class="token number">3.</span>è°ƒç”¨<span class="token class-name">BeanNameAware</span>#setBeanNameæ–¹æ³•<span class="token operator">:</span>æˆ‘è¦ä¸Šå­¦äº†ï¼Œèµ·äº†ä¸ªå­¦å\n<span class="token number">4.</span>è°ƒç”¨<span class="token class-name">BeanFactoryAware</span>#setBeanFactoryæ–¹æ³•ï¼šé€‰å¥½å­¦æ ¡äº†\n<span class="token number">5.</span>BeanPostProcessor#postProcessBeforeInitializationæ–¹æ³•ï¼šåˆ°å­¦æ ¡æŠ¥åå•¦\n<span class="token number">6.</span>InitializingBean#afterPropertiesSetæ–¹æ³•ï¼šå…¥å­¦ç™»è®°\n<span class="token number">7.</span>è‡ªå®šä¹‰initæ–¹æ³•ï¼šåŠªåŠ›ä¸Šå­¦ing\n<span class="token number">8.</span>BeanPostProcessor#postProcessAfterInitializationæ–¹æ³•ï¼šç»ˆäºæ¯•ä¸šï¼Œæ‹¿åˆ°æ¯•ä¸šè¯å•¦ï¼\n<span class="token class-name">Bean</span>ä½¿ç”¨ä¸­ï¼šå·¥ä½œï¼Œåªæœ‰å¯¹ç¤¾ä¼šæ²¡æœ‰ç”¨çš„äººæ‰æ”¾å‡ã€‚ã€‚\n<span class="token number">9.D</span>isposableBean#destroyæ–¹æ³•ï¼šå¹³æ·¡çš„ä¸€ç”Ÿè½å¹•äº†\n<span class="token number">10.</span>è‡ªå®šä¹‰destroyæ–¹æ³•<span class="token operator">:</span>ç¡äº†ï¼Œåˆ«æƒ³å«é†’æˆ‘\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å…³äºæºç ï¼ŒBean åˆ›å»ºè¿‡ç¨‹å¯ä»¥æŸ¥çœ‹<code>AbstractBeanFactory#doGetBean</code>æ–¹æ³•ï¼Œåœ¨è¿™ä¸ªæ–¹æ³•é‡Œå¯ä»¥çœ‹åˆ° Bean çš„å®ä¾‹åŒ–ï¼Œèµ‹å€¼ã€åˆå§‹åŒ–çš„è¿‡ç¨‹ï¼Œè‡³äºæœ€ç»ˆçš„é”€æ¯ï¼Œå¯ä»¥çœ‹çœ‹<code>ConfigurableApplicationContext#close()</code>ã€‚</p><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/spring-d2da20a3-08d0-4648-b9a3-2fff8512b159.png" alt="Beanç”Ÿå‘½å‘¨æœŸæºç è¿½è¸ª" loading="lazy"></p><h3 id="_10-bean-å®šä¹‰å’Œä¾èµ–å®šä¹‰æœ‰å“ªäº›æ–¹å¼" tabindex="-1"><a class="header-anchor" href="#_10-bean-å®šä¹‰å’Œä¾èµ–å®šä¹‰æœ‰å“ªäº›æ–¹å¼" aria-hidden="true">#</a> 10.Bean å®šä¹‰å’Œä¾èµ–å®šä¹‰æœ‰å“ªäº›æ–¹å¼ï¼Ÿ</h3><p>æœ‰ä¸‰ç§æ–¹å¼ï¼š<strong>ç›´æ¥ç¼–ç æ–¹å¼</strong>ã€<strong>é…ç½®æ–‡ä»¶æ–¹å¼</strong>ã€<strong>æ³¨è§£æ–¹å¼</strong>ã€‚</p><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/spring-89f0f50d-a9e4-4dec-b267-cb1a526cb340.png" alt="Beanä¾èµ–é…ç½®æ–¹å¼" loading="lazy"></p><ul><li>ç›´æ¥ç¼–ç æ–¹å¼ï¼šæˆ‘ä»¬ä¸€èˆ¬æ¥è§¦ä¸åˆ°ç›´æ¥ç¼–ç çš„æ–¹å¼ï¼Œä½†å…¶å®å…¶å®ƒçš„æ–¹å¼æœ€ç»ˆéƒ½è¦é€šè¿‡ç›´æ¥ç¼–ç æ¥å®ç°ã€‚</li><li>é…ç½®æ–‡ä»¶æ–¹å¼ï¼šé€šè¿‡ xmlã€propreties ç±»å‹çš„é…ç½®æ–‡ä»¶ï¼Œé…ç½®ç›¸åº”çš„ä¾èµ–å…³ç³»ï¼ŒSpring è¯»å–é…ç½®æ–‡ä»¶ï¼Œå®Œæˆä¾èµ–å…³ç³»çš„æ³¨å…¥ã€‚</li><li>æ³¨è§£æ–¹å¼ï¼šæ³¨è§£æ–¹å¼åº”è¯¥æ˜¯æˆ‘ä»¬ç”¨çš„æœ€å¤šçš„ä¸€ç§æ–¹å¼äº†ï¼Œåœ¨ç›¸åº”çš„åœ°æ–¹ä½¿ç”¨æ³¨è§£ä¿®é¥°ï¼ŒSpring ä¼šæ‰«ææ³¨è§£ï¼Œå®Œæˆä¾èµ–å…³ç³»çš„æ³¨å…¥ã€‚</li></ul><h3 id="_11-æœ‰å“ªäº›ä¾èµ–æ³¨å…¥çš„æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_11-æœ‰å“ªäº›ä¾èµ–æ³¨å…¥çš„æ–¹æ³•" aria-hidden="true">#</a> 11.æœ‰å“ªäº›ä¾èµ–æ³¨å…¥çš„æ–¹æ³•ï¼Ÿ</h3><p>Spring æ”¯æŒ<strong>æ„é€ æ–¹æ³•æ³¨å…¥</strong>ã€<strong>å±æ€§æ³¨å…¥</strong>ã€<strong>å·¥å‚æ–¹æ³•æ³¨å…¥</strong>,å…¶ä¸­å·¥å‚æ–¹æ³•æ³¨å…¥ï¼Œåˆå¯ä»¥åˆ†ä¸º<strong>é™æ€å·¥å‚æ–¹æ³•æ³¨å…¥</strong>å’Œ<strong>éé™æ€å·¥å‚æ–¹æ³•æ³¨å…¥</strong>ã€‚</p><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/spring-491f8444-54ba-4628-b8eb-8418a2197096.png" alt="Springä¾èµ–æ³¨å…¥æ–¹æ³•" loading="lazy"></p><ul><li><p><strong>æ„é€ æ–¹æ³•æ³¨å…¥</strong></p><p>é€šè¿‡è°ƒç”¨ç±»çš„æ„é€ æ–¹æ³•ï¼Œå°†æ¥å£å®ç°ç±»é€šè¿‡æ„é€ æ–¹æ³•å˜é‡ä¼ å…¥</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code> <span class="token keyword">public</span> <span class="token class-name">CatDaoImpl</span><span class="token punctuation">(</span><span class="token class-name">String</span> message<span class="token punctuation">)</span><span class="token punctuation">{</span>\n   <span class="token keyword">this</span><span class="token punctuation">.</span> message <span class="token operator">=</span> message<span class="token punctuation">;</span>\n <span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token operator">&lt;</span>bean id<span class="token operator">=</span><span class="token string">&quot;CatDaoImpl&quot;</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;com.CatDaoImpl&quot;</span><span class="token operator">&gt;</span>\n  <span class="token operator">&lt;</span>constructor<span class="token operator">-</span>arg value<span class="token operator">=</span><span class="token string">&quot; message &quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>constructor<span class="token operator">-</span>arg<span class="token operator">&gt;</span>\n<span class="token operator">&lt;</span><span class="token operator">/</span>bean<span class="token operator">&gt;</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>å±æ€§æ³¨å…¥</strong></p><p>é€šè¿‡ Setter æ–¹æ³•å®Œæˆè°ƒç”¨ç±»æ‰€éœ€ä¾èµ–çš„æ³¨å…¥</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code> <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Id</span> <span class="token punctuation">{</span>\n    <span class="token keyword">private</span> <span class="token keyword">int</span> id<span class="token punctuation">;</span>\n\n    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> id<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setId</span><span class="token punctuation">(</span><span class="token keyword">int</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">this</span><span class="token punctuation">.</span>id <span class="token operator">=</span> id<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token operator">&lt;</span>bean id<span class="token operator">=</span><span class="token string">&quot;id&quot;</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;com.id &quot;</span><span class="token operator">&gt;</span>\n  <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">&quot;id&quot;</span> value<span class="token operator">=</span><span class="token string">&quot;123&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>property<span class="token operator">&gt;</span>\n<span class="token operator">&lt;</span><span class="token operator">/</span>bean<span class="token operator">&gt;</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>å·¥å‚æ–¹æ³•æ³¨å…¥</strong></p><ul><li><p><strong>é™æ€å·¥å‚æ³¨å…¥</strong></p><p>é™æ€å·¥å‚é¡¾åæ€ä¹‰ï¼Œå°±æ˜¯é€šè¿‡è°ƒç”¨é™æ€å·¥å‚çš„æ–¹æ³•æ¥è·å–è‡ªå·±éœ€è¦çš„å¯¹è±¡ï¼Œä¸ºäº†è®© Spring ç®¡ç†æ‰€æœ‰å¯¹è±¡ï¼Œæˆ‘ä»¬ä¸èƒ½ç›´æ¥é€šè¿‡&quot;å·¥ç¨‹ç±».é™æ€æ–¹æ³•()&quot;æ¥è·å–å¯¹è±¡ï¼Œè€Œæ˜¯ä¾ç„¶é€šè¿‡ Spring æ³¨å…¥çš„å½¢å¼è·å–ï¼š</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DaoFactory</span> <span class="token punctuation">{</span> <span class="token comment">//é™æ€å·¥å‚</span>\n\n   <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">FactoryDao</span> <span class="token function">getStaticFactoryDaoImpl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>\n      <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">StaticFacotryDaoImpl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n   <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SpringAction</span> <span class="token punctuation">{</span>\n\n <span class="token comment">//æ³¨å…¥å¯¹è±¡</span>\n <span class="token keyword">private</span> <span class="token class-name">FactoryDao</span> staticFactoryDao<span class="token punctuation">;</span>\n\n <span class="token comment">//æ³¨å…¥å¯¹è±¡çš„ set æ–¹æ³•</span>\n <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setStaticFactoryDao</span><span class="token punctuation">(</span><span class="token class-name">FactoryDao</span> staticFactoryDao<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n     <span class="token keyword">this</span><span class="token punctuation">.</span>staticFactoryDao <span class="token operator">=</span> staticFactoryDao<span class="token punctuation">;</span>\n <span class="token punctuation">}</span>\n\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">//factory-method=&quot;getStaticFactoryDaoImpl&quot;æŒ‡å®šè°ƒç”¨å“ªä¸ªå·¥å‚æ–¹æ³•</span>\n <span class="token operator">&lt;</span>bean name<span class="token operator">=</span><span class="token string">&quot;springAction&quot;</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot; SpringAction&quot;</span> <span class="token operator">&gt;</span>\n   <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>ä½¿ç”¨é™æ€å·¥å‚çš„æ–¹æ³•æ³¨å…¥å¯¹è±¡<span class="token punctuation">,</span>å¯¹åº”ä¸‹é¢çš„é…ç½®æ–‡ä»¶<span class="token operator">--</span><span class="token operator">&gt;</span>\n   <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">&quot;staticFactoryDao&quot;</span> ref<span class="token operator">=</span><span class="token string">&quot;staticFactoryDao&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>property<span class="token operator">&gt;</span>\n <span class="token operator">&lt;</span><span class="token operator">/</span>bean<span class="token operator">&gt;</span>\n\n <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>æ­¤å¤„è·å–å¯¹è±¡çš„æ–¹å¼æ˜¯ä»å·¥å‚ç±»ä¸­è·å–é™æ€æ–¹æ³•<span class="token operator">--</span><span class="token operator">&gt;</span>\n<span class="token operator">&lt;</span>bean name<span class="token operator">=</span><span class="token string">&quot;staticFactoryDao&quot;</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;DaoFactory&quot;</span>\n  factory<span class="token operator">-</span>method<span class="token operator">=</span><span class="token string">&quot;getStaticFactoryDaoImpl&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>bean<span class="token operator">&gt;</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>éé™æ€å·¥å‚æ³¨å…¥</strong></p><p>éé™æ€å·¥å‚ï¼Œä¹Ÿå«å®ä¾‹å·¥å‚ï¼Œæ„æ€æ˜¯å·¥å‚æ–¹æ³•ä¸æ˜¯é™æ€çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦é¦–å…ˆ new ä¸€ä¸ªå·¥å‚å®ä¾‹ï¼Œå†è°ƒç”¨æ™®é€šçš„å®ä¾‹æ–¹æ³•ã€‚</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">//éé™æ€å·¥å‚</span>\n<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DaoFactory</span> <span class="token punctuation">{</span>\n   <span class="token keyword">public</span> <span class="token class-name">FactoryDao</span> <span class="token function">getFactoryDaoImpl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>\n     <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">FactoryDaoImpl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n   <span class="token punctuation">}</span>\n <span class="token punctuation">}</span>\n\n<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SpringAction</span> <span class="token punctuation">{</span>\n  <span class="token comment">//æ³¨å…¥å¯¹è±¡</span>\n  <span class="token keyword">private</span> <span class="token class-name">FactoryDao</span> factoryDao<span class="token punctuation">;</span>\n\n  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setFactoryDao</span><span class="token punctuation">(</span><span class="token class-name">FactoryDao</span> factoryDao<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span>factoryDao <span class="token operator">=</span> factoryDao<span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code> <span class="token operator">&lt;</span>bean name<span class="token operator">=</span><span class="token string">&quot;springAction&quot;</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;SpringAction&quot;</span><span class="token operator">&gt;</span>\n   <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>ä½¿ç”¨éé™æ€å·¥å‚çš„æ–¹æ³•æ³¨å…¥å¯¹è±¡<span class="token punctuation">,</span>å¯¹åº”ä¸‹é¢çš„é…ç½®æ–‡ä»¶<span class="token operator">--</span><span class="token operator">&gt;</span>\n   <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">&quot;factoryDao&quot;</span> ref<span class="token operator">=</span><span class="token string">&quot;factoryDao&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>property<span class="token operator">&gt;</span>\n <span class="token operator">&lt;</span><span class="token operator">/</span>bean<span class="token operator">&gt;</span>\n\n <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>æ­¤å¤„è·å–å¯¹è±¡çš„æ–¹å¼æ˜¯ä»å·¥å‚ç±»ä¸­è·å–å®ä¾‹æ–¹æ³•<span class="token operator">--</span><span class="token operator">&gt;</span>\n <span class="token operator">&lt;</span>bean name<span class="token operator">=</span><span class="token string">&quot;daoFactory&quot;</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;com.DaoFactory&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>bean<span class="token operator">&gt;</span>\n\n<span class="token operator">&lt;</span>bean name<span class="token operator">=</span><span class="token string">&quot;factoryDao&quot;</span> factory<span class="token operator">-</span>bean<span class="token operator">=</span><span class="token string">&quot;daoFactory&quot;</span> factory<span class="token operator">-</span>method<span class="token operator">=</span><span class="token string">&quot;getFactoryDaoImpl&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>bean<span class="token operator">&gt;</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul></li></ul><h3 id="_12-spring-æœ‰å“ªäº›è‡ªåŠ¨è£…é…çš„æ–¹å¼" tabindex="-1"><a class="header-anchor" href="#_12-spring-æœ‰å“ªäº›è‡ªåŠ¨è£…é…çš„æ–¹å¼" aria-hidden="true">#</a> 12.Spring æœ‰å“ªäº›è‡ªåŠ¨è£…é…çš„æ–¹å¼ï¼Ÿ</h3><blockquote><p><strong>ä»€ä¹ˆæ˜¯è‡ªåŠ¨è£…é…ï¼Ÿ</strong></p></blockquote><p>Spring IOC å®¹å™¨çŸ¥é“æ‰€æœ‰ Bean çš„é…ç½®ä¿¡æ¯ï¼Œæ­¤å¤–ï¼Œé€šè¿‡ Java åå°„æœºåˆ¶è¿˜å¯ä»¥è·çŸ¥å®ç°ç±»çš„ç»“æ„ä¿¡æ¯ï¼Œå¦‚æ„é€ æ–¹æ³•çš„ç»“æ„ã€å±æ€§ç­‰ä¿¡æ¯ã€‚æŒæ¡æ‰€æœ‰ Bean çš„è¿™äº›ä¿¡æ¯åï¼ŒSpring IOC å®¹å™¨å°±å¯ä»¥æŒ‰ç…§æŸç§è§„åˆ™å¯¹å®¹å™¨ä¸­çš„ Bean è¿›è¡Œè‡ªåŠ¨è£…é…ï¼Œè€Œæ— é¡»é€šè¿‡æ˜¾å¼çš„æ–¹å¼è¿›è¡Œä¾èµ–é…ç½®ã€‚</p><p>Spring æä¾›çš„è¿™ç§æ–¹å¼ï¼Œå¯ä»¥æŒ‰ç…§æŸäº›è§„åˆ™è¿›è¡Œ Bean çš„è‡ªåŠ¨è£…é…ï¼Œ<code>&lt;bean&gt;</code>å…ƒç´ æä¾›äº†ä¸€ä¸ªæŒ‡å®šè‡ªåŠ¨è£…é…ç±»å‹çš„å±æ€§ï¼š<code>autowire=&quot;&lt;è‡ªåŠ¨è£…é…ç±»å‹&gt;&quot;</code></p><blockquote><p><strong>Spring æä¾›äº†å“ªå‡ ç§è‡ªåŠ¨è£…é…ç±»å‹ï¼Ÿ</strong></p></blockquote><p>Spring æä¾›äº† 4 ç§è‡ªåŠ¨è£…é…ç±»å‹ï¼š</p><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/spring-034120d9-88c7-490b-af07-7d48f3b6b7bc.png" alt="Springå››ç§è‡ªåŠ¨è£…é…ç±»å‹" loading="lazy"></p><ul><li><strong>byName</strong>ï¼šæ ¹æ®åç§°è¿›è¡Œè‡ªåŠ¨åŒ¹é…ï¼Œå‡è®¾ Boss åˆä¸€ä¸ªåä¸º car çš„å±æ€§ï¼Œå¦‚æœå®¹å™¨ä¸­åˆšå¥½æœ‰ä¸€ä¸ªåä¸º car çš„ beanï¼ŒSpring å°±ä¼šè‡ªåŠ¨å°†å…¶è£…é…ç»™ Boss çš„ car å±æ€§</li><li><strong>byType</strong>ï¼šæ ¹æ®ç±»å‹è¿›è¡Œè‡ªåŠ¨åŒ¹é…ï¼Œå‡è®¾ Boss æœ‰ä¸€ä¸ª Car ç±»å‹çš„å±æ€§ï¼Œå¦‚æœå®¹å™¨ä¸­åˆšå¥½æœ‰ä¸€ä¸ª Car ç±»å‹çš„ Beanï¼ŒSpring å°±ä¼šè‡ªåŠ¨å°†å…¶è£…é…ç»™ Boss è¿™ä¸ªå±æ€§</li><li><strong>constructor</strong>ï¼šä¸ byType ç±»ä¼¼ï¼Œ åªä¸è¿‡å®ƒæ˜¯é’ˆå¯¹æ„é€ å‡½æ•°æ³¨å…¥è€Œè¨€çš„ã€‚å¦‚æœ Boss æœ‰ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œæ„é€ å‡½æ•°åŒ…å«ä¸€ä¸ª Car ç±»å‹çš„å…¥å‚ï¼Œå¦‚æœå®¹å™¨ä¸­æœ‰ä¸€ä¸ª Car ç±»å‹çš„ Beanï¼Œåˆ™ Spring å°†è‡ªåŠ¨æŠŠè¿™ä¸ª Bean ä½œä¸º Boss æ„é€ å‡½æ•°çš„å…¥å‚ï¼›å¦‚æœå®¹å™¨ä¸­æ²¡æœ‰æ‰¾åˆ°å’Œæ„é€ å‡½æ•°å…¥å‚åŒ¹é…ç±»å‹çš„ Beanï¼Œåˆ™ Spring å°†æŠ›å‡ºå¼‚å¸¸ã€‚</li><li><strong>autodetect</strong>ï¼šæ ¹æ® Bean çš„è‡ªçœæœºåˆ¶å†³å®šé‡‡ç”¨ byType è¿˜æ˜¯ constructor è¿›è¡Œè‡ªåŠ¨è£…é…ï¼Œå¦‚æœ Bean æä¾›äº†é»˜è®¤çš„æ„é€ å‡½æ•°ï¼Œåˆ™é‡‡ç”¨ byTypeï¼Œå¦åˆ™é‡‡ç”¨ constructorã€‚</li></ul><h3 id="_13-spring-ä¸­çš„-bean-çš„ä½œç”¨åŸŸæœ‰å“ªäº›" tabindex="-1"><a class="header-anchor" href="#_13-spring-ä¸­çš„-bean-çš„ä½œç”¨åŸŸæœ‰å“ªäº›" aria-hidden="true">#</a> 13.Spring ä¸­çš„ Bean çš„ä½œç”¨åŸŸæœ‰å“ªäº›?</h3><p>Spring çš„ Bean ä¸»è¦æ”¯æŒäº”ç§ä½œç”¨åŸŸï¼š</p><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/spring-08a9cb31-5a4f-4224-94cd-0c0f643a57ea.png" alt="Spring Beanæ”¯æŒä½œç”¨åŸŸ" loading="lazy"></p><ul><li><strong>singleton</strong> : åœ¨ Spring å®¹å™¨ä»…å­˜åœ¨ä¸€ä¸ª Bean å®ä¾‹ï¼ŒBean ä»¥å•å®ä¾‹çš„æ–¹å¼å­˜åœ¨ï¼Œæ˜¯ Bean é»˜è®¤çš„ä½œç”¨åŸŸã€‚</li><li><strong>prototype</strong> : æ¯æ¬¡ä»å®¹å™¨é‡è°ƒç”¨ Bean æ—¶ï¼Œéƒ½ä¼šè¿”å›ä¸€ä¸ªæ–°çš„å®ä¾‹ã€‚</li></ul><p>ä»¥ä¸‹ä¸‰ä¸ªä½œç”¨åŸŸäºåªåœ¨ Web åº”ç”¨ä¸­é€‚ç”¨ï¼š</p><ul><li><strong>request</strong> : æ¯ä¸€æ¬¡ HTTP è¯·æ±‚éƒ½ä¼šäº§ç”Ÿä¸€ä¸ªæ–°çš„ Beanï¼Œè¯¥ Bean ä»…åœ¨å½“å‰ HTTP Request å†…æœ‰æ•ˆã€‚</li><li><strong>session</strong> : åŒä¸€ä¸ª HTTP Session å…±äº«ä¸€ä¸ª Beanï¼Œä¸åŒçš„ HTTP Session ä½¿ç”¨ä¸åŒçš„ Beanã€‚</li><li><strong>globalSession</strong>ï¼šåŒä¸€ä¸ªå…¨å±€ Session å…±äº«ä¸€ä¸ª Beanï¼Œåªç”¨äºåŸºäº Protlet çš„ Web åº”ç”¨ï¼ŒSpring5 ä¸­å·²ç»ä¸å­˜åœ¨äº†ã€‚</li></ul><h3 id="_14-spring-ä¸­çš„å•ä¾‹-bean-ä¼šå­˜åœ¨çº¿ç¨‹å®‰å…¨é—®é¢˜å—" tabindex="-1"><a class="header-anchor" href="#_14-spring-ä¸­çš„å•ä¾‹-bean-ä¼šå­˜åœ¨çº¿ç¨‹å®‰å…¨é—®é¢˜å—" aria-hidden="true">#</a> 14.Spring ä¸­çš„å•ä¾‹ Bean ä¼šå­˜åœ¨çº¿ç¨‹å®‰å…¨é—®é¢˜å—ï¼Ÿ</h3><p>é¦–å…ˆç»“è®ºåœ¨è¿™ï¼šSpring ä¸­çš„å•ä¾‹ Bean<strong>ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„</strong>ã€‚</p><p>å› ä¸ºå•ä¾‹ Beanï¼Œæ˜¯å…¨å±€åªæœ‰ä¸€ä¸ª Beanï¼Œæ‰€æœ‰çº¿ç¨‹å…±äº«ã€‚å¦‚æœè¯´å•ä¾‹ Beanï¼Œæ˜¯ä¸€ä¸ªæ— çŠ¶æ€çš„ï¼Œä¹Ÿå°±æ˜¯çº¿ç¨‹ä¸­çš„æ“ä½œä¸ä¼šå¯¹ Bean ä¸­çš„æˆå‘˜å˜é‡æ‰§è¡Œ<strong>æŸ¥è¯¢</strong>ä»¥å¤–çš„æ“ä½œï¼Œé‚£ä¹ˆè¿™ä¸ªå•ä¾‹ Bean æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚æ¯”å¦‚ Spring mvc çš„ Controllerã€Serviceã€Dao ç­‰ï¼Œè¿™äº› Bean å¤§å¤šæ˜¯æ— çŠ¶æ€çš„ï¼Œåªå…³æ³¨äºæ–¹æ³•æœ¬èº«ã€‚</p><p>å‡å¦‚è¿™ä¸ª Bean æ˜¯æœ‰çŠ¶æ€çš„ï¼Œä¹Ÿå°±æ˜¯ä¼šå¯¹ Bean ä¸­çš„æˆå‘˜å˜é‡è¿›è¡Œå†™æ“ä½œï¼Œé‚£ä¹ˆå¯èƒ½å°±å­˜åœ¨çº¿ç¨‹å®‰å…¨çš„é—®é¢˜ã€‚</p><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/spring-35dacef4-1a9e-45e1-b3f2-5a91227eb244.png" alt="Springå•ä¾‹Beançº¿ç¨‹å®‰å…¨é—®é¢˜" loading="lazy"></p><blockquote><p><strong>å•ä¾‹ Bean çº¿ç¨‹å®‰å…¨é—®é¢˜æ€ä¹ˆè§£å†³å‘¢ï¼Ÿ</strong></p></blockquote><p>å¸¸è§çš„æœ‰è¿™ä¹ˆäº›è§£å†³åŠæ³•ï¼š</p><ol><li><p>å°† Bean å®šä¹‰ä¸ºå¤šä¾‹</p><p>è¿™æ ·æ¯ä¸€ä¸ªçº¿ç¨‹è¯·æ±‚è¿‡æ¥éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ Beanï¼Œä½†æ˜¯è¿™æ ·å®¹å™¨å°±ä¸å¥½ç®¡ç† Beanï¼Œä¸èƒ½è¿™ä¹ˆåŠã€‚</p></li><li><p>åœ¨ Bean å¯¹è±¡ä¸­å°½é‡é¿å…å®šä¹‰å¯å˜çš„æˆå‘˜å˜é‡</p><p>å‰Šè¶³é€‚å±¥äº†å±äºæ˜¯ï¼Œä¹Ÿä¸èƒ½è¿™ä¹ˆå¹²ã€‚</p></li><li><p>å°† Bean ä¸­çš„æˆå‘˜å˜é‡ä¿å­˜åœ¨ ThreadLocal ä¸­ â­</p><p>æˆ‘ä»¬çŸ¥é“ ThredLoca èƒ½ä¿è¯å¤šçº¿ç¨‹ä¸‹å˜é‡çš„éš”ç¦»ï¼Œå¯ä»¥åœ¨ç±»ä¸­å®šä¹‰ä¸€ä¸ª ThreadLocal æˆå‘˜å˜é‡ï¼Œå°†éœ€è¦çš„å¯å˜æˆå‘˜å˜é‡ä¿å­˜åœ¨ ThreadLocal é‡Œï¼Œè¿™æ˜¯æ¨èçš„ä¸€ç§æ–¹å¼ã€‚</p></li></ol><h3 id="_15-è¯´è¯´å¾ªç¯ä¾èµ–" tabindex="-1"><a class="header-anchor" href="#_15-è¯´è¯´å¾ªç¯ä¾èµ–" aria-hidden="true">#</a> 15.è¯´è¯´å¾ªç¯ä¾èµ–?</h3><blockquote><p><strong>ä»€ä¹ˆæ˜¯å¾ªç¯ä¾èµ–ï¼Ÿ</strong></p></blockquote><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/spring-f8fea53f-56fa-4cca-9199-ec7f648da625.png" alt="Springå¾ªç¯ä¾èµ–" loading="lazy"></p><p>Spring å¾ªç¯ä¾èµ–ï¼šç®€å•è¯´å°±æ˜¯è‡ªå·±ä¾èµ–è‡ªå·±ï¼Œæˆ–è€…å’Œåˆ«çš„ Bean ç›¸äº’ä¾èµ–ã€‚</p><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/spring-0035fd25-2972-4642-a8ec-ee44a566a5bd.png" alt="é¸¡å’Œè›‹" loading="lazy"></p><p>åªæœ‰å•ä¾‹çš„ Bean æ‰å­˜åœ¨å¾ªç¯ä¾èµ–çš„æƒ…å†µï¼Œ<strong>åŸå‹</strong>(Prototype)æƒ…å†µä¸‹ï¼ŒSpring ä¼šç›´æ¥æŠ›å‡ºå¼‚å¸¸ã€‚åŸå› å¾ˆç®€å•ï¼ŒAB å¾ªç¯ä¾èµ–ï¼ŒA å®ä¾‹åŒ–çš„æ—¶å€™ï¼Œå‘ç°ä¾èµ– Bï¼Œåˆ›å»º B å®ä¾‹ï¼Œåˆ›å»º B çš„æ—¶å€™å‘ç°éœ€è¦ Aï¼Œåˆ›å»º A1 å®ä¾‹â€¦â€¦æ— é™å¥—å¨ƒï¼Œç›´æ¥æŠŠç³»ç»Ÿå¹²å®ã€‚</p><blockquote><p><strong>Spring å¯ä»¥è§£å†³å“ªäº›æƒ…å†µçš„å¾ªç¯ä¾èµ–ï¼Ÿ</strong></p></blockquote><p>Spring ä¸æ”¯æŒåŸºäºæ„é€ å™¨æ³¨å…¥çš„å¾ªç¯ä¾èµ–ï¼Œä½†æ˜¯å‡å¦‚ AB å¾ªç¯ä¾èµ–ï¼Œå¦‚æœä¸€ä¸ªæ˜¯æ„é€ å™¨æ³¨å…¥ï¼Œä¸€ä¸ªæ˜¯ setter æ³¨å…¥å‘¢ï¼Ÿ</p><p>çœ‹çœ‹å‡ ç§æƒ…å½¢ï¼š</p><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/spring-37bb576d-b4af-42ed-91f4-d846ceb012b6.png" alt="å¾ªç¯ä¾èµ–çš„å‡ ç§æƒ…å½¢" loading="lazy"></p><p>ç¬¬å››ç§å¯ä»¥è€Œç¬¬äº”ç§ä¸å¯ä»¥çš„åŸå› æ˜¯ Spring åœ¨åˆ›å»º Bean æ—¶é»˜è®¤ä¼šæ ¹æ®è‡ªç„¶æ’åºè¿›è¡Œåˆ›å»ºï¼Œæ‰€ä»¥ A ä¼šå…ˆäº B è¿›è¡Œåˆ›å»ºã€‚</p><p>æ‰€ä»¥ç®€å•æ€»ç»“ï¼Œå½“å¾ªç¯ä¾èµ–çš„å®ä¾‹éƒ½é‡‡ç”¨ setter æ–¹æ³•æ³¨å…¥çš„æ—¶å€™ï¼ŒSpring å¯ä»¥æ”¯æŒï¼Œéƒ½é‡‡ç”¨æ„é€ å™¨æ³¨å…¥çš„æ—¶å€™ï¼Œä¸æ”¯æŒï¼Œæ„é€ å™¨æ³¨å…¥å’Œ setter æ³¨å…¥åŒæ—¶å­˜åœ¨çš„æ—¶å€™ï¼Œçœ‹å¤©ã€‚</p><h3 id="_16-é‚£-spring-æ€ä¹ˆè§£å†³å¾ªç¯ä¾èµ–çš„å‘¢" tabindex="-1"><a class="header-anchor" href="#_16-é‚£-spring-æ€ä¹ˆè§£å†³å¾ªç¯ä¾èµ–çš„å‘¢" aria-hidden="true">#</a> 16.é‚£ Spring æ€ä¹ˆè§£å†³å¾ªç¯ä¾èµ–çš„å‘¢ï¼Ÿ</h3><blockquote><p>PSï¼šå…¶å®æ­£ç¡®ç­”æ¡ˆæ˜¯å¼€å‘äººå‘˜åšå¥½è®¾è®¡ï¼Œåˆ«è®© Bean å¾ªç¯ä¾èµ–ï¼Œä½†æ˜¯æ²¡åŠæ³•ï¼Œé¢è¯•å®˜ä¸æƒ³å¬è¿™ä¸ªã€‚</p></blockquote><p>æˆ‘ä»¬éƒ½çŸ¥é“ï¼Œå•ä¾‹ Bean åˆå§‹åŒ–å®Œæˆï¼Œè¦ç»å†ä¸‰æ­¥ï¼š</p><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/spring-867066f1-49d1-4e57-94f9-4c66a3a8797e.png" alt="Beanåˆå§‹åŒ–æ­¥éª¤" loading="lazy"></p><p>æ³¨å…¥å°±å‘ç”Ÿåœ¨ç¬¬äºŒæ­¥ï¼Œ<strong>å±æ€§èµ‹å€¼</strong>ï¼Œç»“åˆè¿™ä¸ªè¿‡ç¨‹ï¼ŒSpring é€šè¿‡<strong>ä¸‰çº§ç¼“å­˜</strong>è§£å†³äº†å¾ªç¯ä¾èµ–ï¼š</p><ol><li>ä¸€çº§ç¼“å­˜ : <code>Map&lt;String,Object&gt;</code> <strong>singletonObjects</strong>ï¼Œå•ä¾‹æ± ï¼Œç”¨äºä¿å­˜å®ä¾‹åŒ–ã€å±æ€§èµ‹å€¼ï¼ˆæ³¨å…¥ï¼‰ã€åˆå§‹åŒ–å®Œæˆçš„ bean å®ä¾‹</li><li>äºŒçº§ç¼“å­˜ : <code>Map&lt;String,Object&gt;</code> <strong>earlySingletonObjects</strong>ï¼Œæ—©æœŸæ›å…‰å¯¹è±¡ï¼Œç”¨äºä¿å­˜å®ä¾‹åŒ–å®Œæˆçš„ bean å®ä¾‹</li><li>ä¸‰çº§ç¼“å­˜ : <code>Map&lt;String,ObjectFactory&lt;?&gt;&gt;</code> <strong>singletonFactories</strong>ï¼Œæ—©æœŸæ›å…‰å¯¹è±¡å·¥å‚ï¼Œç”¨äºä¿å­˜ bean åˆ›å»ºå·¥å‚ï¼Œä»¥ä¾¿äºåé¢æ‰©å±•æœ‰æœºä¼šåˆ›å»ºä»£ç†å¯¹è±¡ã€‚</li></ol><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/spring-01d92863-a2cb-4f61-8d8d-30ecf0279b28.png" alt="ä¸‰çº§ç¼“å­˜" loading="lazy"></p><p>æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ä¸‰çº§ç¼“å­˜è§£å†³å¾ªç¯ä¾èµ–çš„è¿‡ç¨‹ï¼š</p><p>å½“ Aã€B ä¸¤ä¸ªç±»å‘ç”Ÿå¾ªç¯ä¾èµ–æ—¶ï¼š <img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/spring-cfc09f84-f8e1-4702-80b6-d115843e81fe.png" alt="å¾ªç¯ä¾èµ–" loading="lazy"></p><p>A å®ä¾‹çš„åˆå§‹åŒ–è¿‡ç¨‹ï¼š</p><ol><li>åˆ›å»º A å®ä¾‹ï¼Œå®ä¾‹åŒ–çš„æ—¶å€™æŠŠ A å¯¹è±¡â¼¯â¼šæ”¾â¼Šä¸‰çº§ç¼“å­˜ï¼Œè¡¨ç¤º A å¼€å§‹å®ä¾‹åŒ–äº†ï¼Œè™½ç„¶æˆ‘è¿™ä¸ªå¯¹è±¡è¿˜ä¸å®Œæ•´ï¼Œä½†æ˜¯å…ˆæ›å…‰å‡ºæ¥è®©å¤§å®¶çŸ¥é“</li></ol><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/spring-1a8bdc29-ff43-4ff4-9b61-3eedd9da59b3.png" alt="1" loading="lazy"></p><ol start="2"><li><p>A æ³¨â¼Šå±æ€§æ—¶ï¼Œå‘ç°ä¾èµ– Bï¼Œæ­¤æ—¶ B è¿˜æ²¡æœ‰è¢«åˆ›å»ºå‡ºæ¥ï¼Œæ‰€ä»¥å»å®ä¾‹åŒ– B</p></li><li><p>åŒæ ·ï¼ŒB æ³¨â¼Šå±æ€§æ—¶å‘ç°ä¾èµ– Aï¼Œå®ƒå°±ä¼šä»ç¼“å­˜é‡Œæ‰¾ A å¯¹è±¡ã€‚ä¾æ¬¡ä»â¼€çº§åˆ°ä¸‰çº§ç¼“å­˜æŸ¥è¯¢ Aï¼Œä»ä¸‰çº§ç¼“å­˜é€šè¿‡å¯¹è±¡â¼¯â¼šæ‹¿åˆ° Aï¼Œå‘ç° A è™½ç„¶ä¸å¤ªå®Œå–„ï¼Œä½†æ˜¯å­˜åœ¨ï¼ŒæŠŠ A æ”¾â¼Šâ¼†çº§ç¼“å­˜ï¼ŒåŒæ—¶åˆ é™¤ä¸‰çº§ç¼“å­˜ä¸­çš„ Aï¼Œæ­¤æ—¶ï¼ŒB å·²ç»å®ä¾‹åŒ–å¹¶ä¸”åˆå§‹åŒ–å®Œæˆï¼ŒæŠŠ B æ”¾å…¥â¼€çº§ç¼“å­˜ã€‚</p></li></ol><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/spring-bf2507bf-96aa-4b88-a58b-7ec41d11bc70.png" alt="2" loading="lazy"></p><ol start="4"><li><p>æ¥ç€ A ç»§ç»­å±æ€§èµ‹å€¼ï¼Œé¡ºåˆ©ä»â¼€çº§ç¼“å­˜æ‹¿åˆ°å®ä¾‹åŒ–ä¸”åˆå§‹åŒ–å®Œæˆçš„ B å¯¹è±¡ï¼ŒA å¯¹è±¡åˆ›å»ºä¹Ÿå®Œæˆï¼Œåˆ é™¤â¼†çº§ç¼“å­˜ä¸­çš„ Aï¼ŒåŒæ—¶æŠŠ A æ”¾â¼Šâ¼€çº§ç¼“å­˜</p></li><li><p>æœ€åï¼Œâ¼€çº§ç¼“å­˜ä¸­ä¿å­˜ç€å®ä¾‹åŒ–ã€åˆå§‹åŒ–éƒ½å®Œæˆçš„ Aã€B å¯¹è±¡</p></li></ol><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/spring-022f7cb9-2c83-4fe9-b252-b02bd0fb2435.png" alt="5" loading="lazy"></p><p>æ‰€ä»¥ï¼Œæˆ‘ä»¬å°±çŸ¥é“ä¸ºä»€ä¹ˆ Spring èƒ½è§£å†³ setter æ³¨å…¥çš„å¾ªç¯ä¾èµ–äº†ï¼Œå› ä¸ºå®ä¾‹åŒ–å’Œå±æ€§èµ‹å€¼æ˜¯åˆ†å¼€çš„ï¼Œæ‰€ä»¥é‡Œé¢æœ‰æ“ä½œçš„ç©ºé—´ã€‚å¦‚æœéƒ½æ˜¯æ„é€ å™¨æ³¨å…¥çš„åŒ–ï¼Œé‚£ä¹ˆéƒ½å¾—åœ¨å®ä¾‹åŒ–è¿™ä¸€æ­¥å®Œæˆæ³¨å…¥ï¼Œæ‰€ä»¥è‡ªç„¶æ˜¯æ— æ³•æ”¯æŒäº†ã€‚</p><h3 id="_17-ä¸ºä»€ä¹ˆè¦ä¸‰çº§ç¼“å­˜-äºŒçº§ä¸è¡Œå—" tabindex="-1"><a class="header-anchor" href="#_17-ä¸ºä»€ä¹ˆè¦ä¸‰çº§ç¼“å­˜-äºŒçº§ä¸è¡Œå—" aria-hidden="true">#</a> 17.ä¸ºä»€ä¹ˆè¦ä¸‰çº§ç¼“å­˜ï¼Ÿâ¼†çº§ä¸â¾å—ï¼Ÿ</h3><p>ä¸è¡Œï¼Œä¸»è¦æ˜¯ä¸ºäº†<strong>â½£æˆä»£ç†å¯¹è±¡</strong>ã€‚å¦‚æœæ˜¯æ²¡æœ‰ä»£ç†çš„æƒ…å†µä¸‹ï¼Œä½¿ç”¨äºŒçº§ç¼“å­˜è§£å†³å¾ªç¯ä¾èµ–ä¹Ÿæ˜¯ OK çš„ã€‚ä½†æ˜¯å¦‚æœå­˜åœ¨ä»£ç†ï¼Œä¸‰çº§æ²¡æœ‰é—®é¢˜ï¼ŒäºŒçº§å°±ä¸è¡Œäº†ã€‚</p><p>å› ä¸ºä¸‰çº§ç¼“å­˜ä¸­æ”¾çš„æ˜¯â½£æˆå…·ä½“å¯¹è±¡çš„åŒ¿åå†…éƒ¨ç±»ï¼Œè·å– Object çš„æ—¶å€™ï¼Œå®ƒå¯ä»¥â½£æˆä»£ç†å¯¹è±¡ï¼Œä¹Ÿå¯ä»¥è¿”å›æ™®é€šå¯¹è±¡ã€‚ä½¿â½¤ä¸‰çº§ç¼“å­˜ä¸»è¦æ˜¯ä¸ºäº†ä¿è¯ä¸ç®¡ä»€ä¹ˆæ—¶å€™ä½¿â½¤çš„éƒ½æ˜¯â¼€ä¸ªå¯¹è±¡ã€‚</p><p>å‡è®¾åªæœ‰â¼†çº§ç¼“å­˜çš„æƒ…å†µï¼Œå¾€â¼†çº§ç¼“å­˜ä¸­æ”¾çš„æ˜¾ç¤ºâ¼€ä¸ªæ™®é€šçš„ Bean å¯¹è±¡ï¼ŒBean åˆå§‹åŒ–è¿‡ç¨‹ä¸­ï¼Œé€šè¿‡ BeanPostProcessor å»â½£æˆä»£ç†å¯¹è±¡ä¹‹åï¼Œè¦†ç›–æ‰â¼†çº§ç¼“å­˜ä¸­çš„æ™®é€š Bean å¯¹è±¡ï¼Œé‚£ä¹ˆå¯èƒ½å°±å¯¼è‡´å–åˆ°çš„ Bean å¯¹è±¡ä¸ä¸€è‡´äº†ã€‚</p><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/spring-6ece8a46-25b1-459b-8cfa-19fc696dd7d6.png" alt="äºŒçº§ç¼“å­˜ä¸è¡Œçš„åŸå› " loading="lazy"></p><h3 id="_18-autowired-çš„å®ç°åŸç†" tabindex="-1"><a class="header-anchor" href="#_18-autowired-çš„å®ç°åŸç†" aria-hidden="true">#</a> 18.@Autowired çš„å®ç°åŸç†ï¼Ÿ</h3><p>å®ç°@Autowired çš„å…³é”®æ˜¯ï¼š<strong>AutowiredAnnotationBeanPostProcessor</strong></p><p>åœ¨ Bean çš„åˆå§‹åŒ–é˜¶æ®µï¼Œä¼šé€šè¿‡ Bean åç½®å¤„ç†å™¨æ¥è¿›è¡Œä¸€äº›å‰ç½®å’Œåç½®çš„å¤„ç†ã€‚</p><p>å®ç°@Autowired çš„åŠŸèƒ½ï¼Œä¹Ÿæ˜¯é€šè¿‡åç½®å¤„ç†å™¨æ¥å®Œæˆçš„ã€‚è¿™ä¸ªåç½®å¤„ç†å™¨å°±æ˜¯ AutowiredAnnotationBeanPostProcessorã€‚</p><ul><li><p>Spring åœ¨åˆ›å»º bean çš„è¿‡ç¨‹ä¸­ï¼Œæœ€ç»ˆä¼šè°ƒç”¨åˆ° doCreateBean()æ–¹æ³•ï¼Œåœ¨ doCreateBean()æ–¹æ³•ä¸­ä¼šè°ƒç”¨ populateBean()æ–¹æ³•ï¼Œæ¥ä¸º bean è¿›è¡Œå±æ€§å¡«å……ï¼Œå®Œæˆè‡ªåŠ¨è£…é…ç­‰å·¥ä½œã€‚</p></li><li><p>åœ¨ populateBean()æ–¹æ³•ä¸­ä¸€å…±è°ƒç”¨äº†ä¸¤æ¬¡åç½®å¤„ç†å™¨ï¼Œç¬¬ä¸€æ¬¡æ˜¯ä¸ºäº†åˆ¤æ–­æ˜¯å¦éœ€è¦å±æ€§å¡«å……ï¼Œå¦‚æœä¸éœ€è¦è¿›è¡Œå±æ€§å¡«å……ï¼Œé‚£ä¹ˆå°±ä¼šç›´æ¥è¿›è¡Œ returnï¼Œå¦‚æœéœ€è¦è¿›è¡Œå±æ€§å¡«å……ï¼Œé‚£ä¹ˆæ–¹æ³•å°±ä¼šç»§ç»­å‘ä¸‹æ‰§è¡Œï¼Œåé¢ä¼šè¿›è¡Œç¬¬äºŒæ¬¡åç½®å¤„ç†å™¨çš„è°ƒç”¨ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œå°±ä¼šè°ƒç”¨åˆ° AutowiredAnnotationBeanPostProcessor çš„ postProcessPropertyValues()æ–¹æ³•ï¼Œåœ¨è¯¥æ–¹æ³•ä¸­å°±ä¼šè¿›è¡Œ@Autowired æ³¨è§£çš„è§£æï¼Œç„¶åå®ç°è‡ªåŠ¨è£…é…ã€‚</p></li></ul><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token doc-comment comment">/**\n* å±æ€§èµ‹å€¼\n**/</span>\n<span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">populateBean</span><span class="token punctuation">(</span><span class="token class-name">String</span> beanName<span class="token punctuation">,</span> <span class="token class-name">RootBeanDefinition</span> mbd<span class="token punctuation">,</span> <span class="token annotation punctuation">@Nullable</span> <span class="token class-name">BeanWrapper</span> bw<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n          <span class="token comment">//â€¦â€¦â€¦â€¦</span>\n          <span class="token keyword">if</span> <span class="token punctuation">(</span>hasInstAwareBpps<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n              <span class="token keyword">if</span> <span class="token punctuation">(</span>pvs <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n                  pvs <span class="token operator">=</span> mbd<span class="token punctuation">.</span><span class="token function">getPropertyValues</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n              <span class="token punctuation">}</span>\n\n              <span class="token class-name">PropertyValues</span> pvsToUse<span class="token punctuation">;</span>\n              <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">Iterator</span> var9 <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getBeanPostProcessorCache</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>instantiationAware<span class="token punctuation">.</span><span class="token function">iterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> var9<span class="token punctuation">.</span><span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> pvs <span class="token operator">=</span> pvsToUse<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n                  <span class="token class-name">InstantiationAwareBeanPostProcessor</span> bp <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">InstantiationAwareBeanPostProcessor</span><span class="token punctuation">)</span>var9<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n                  pvsToUse <span class="token operator">=</span> bp<span class="token punctuation">.</span><span class="token function">postProcessProperties</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">PropertyValues</span><span class="token punctuation">)</span>pvs<span class="token punctuation">,</span> bw<span class="token punctuation">.</span><span class="token function">getWrappedInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> beanName<span class="token punctuation">)</span><span class="token punctuation">;</span>\n                  <span class="token keyword">if</span> <span class="token punctuation">(</span>pvsToUse <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n                      <span class="token keyword">if</span> <span class="token punctuation">(</span>filteredPds <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n                          filteredPds <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">filterPropertyDescriptorsForDependencyCheck</span><span class="token punctuation">(</span>bw<span class="token punctuation">,</span> mbd<span class="token punctuation">.</span>allowCaching<span class="token punctuation">)</span><span class="token punctuation">;</span>\n                      <span class="token punctuation">}</span>\n                      <span class="token comment">//æ‰§è¡Œåå¤„ç†å™¨ï¼Œå¡«å……å±æ€§ï¼Œå®Œæˆè‡ªåŠ¨è£…é…</span>\n                      <span class="token comment">//è°ƒç”¨InstantiationAwareBeanPostProcessorçš„postProcessPropertyValues()æ–¹æ³•</span>\n                      pvsToUse <span class="token operator">=</span> bp<span class="token punctuation">.</span><span class="token function">postProcessPropertyValues</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">PropertyValues</span><span class="token punctuation">)</span>pvs<span class="token punctuation">,</span> filteredPds<span class="token punctuation">,</span> bw<span class="token punctuation">.</span><span class="token function">getWrappedInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> beanName<span class="token punctuation">)</span><span class="token punctuation">;</span>\n                      <span class="token keyword">if</span> <span class="token punctuation">(</span>pvsToUse <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n                          <span class="token keyword">return</span><span class="token punctuation">;</span>\n                      <span class="token punctuation">}</span>\n                  <span class="token punctuation">}</span>\n              <span class="token punctuation">}</span>\n          <span class="token punctuation">}</span>\n         <span class="token comment">//â€¦â€¦â€¦â€¦</span>\n  <span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>postProcessorPropertyValues()æ–¹æ³•çš„æºç å¦‚ä¸‹ï¼Œåœ¨è¯¥æ–¹æ³•ä¸­ï¼Œä¼šå…ˆè°ƒç”¨ findAutowiringMetadata()æ–¹æ³•è§£æå‡º bean ä¸­å¸¦æœ‰@Autowired æ³¨è§£ã€@Inject å’Œ@Value æ³¨è§£çš„å±æ€§å’Œæ–¹æ³•ã€‚ç„¶åè°ƒç”¨ metadata.inject()æ–¹æ³•ï¼Œè¿›è¡Œå±æ€§å¡«å……ã€‚</li></ul><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>  <span class="token keyword">public</span> <span class="token class-name">PropertyValues</span> <span class="token function">postProcessProperties</span><span class="token punctuation">(</span><span class="token class-name">PropertyValues</span> pvs<span class="token punctuation">,</span> <span class="token class-name">Object</span> bean<span class="token punctuation">,</span> <span class="token class-name">String</span> beanName<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token comment">//@Autowiredæ³¨è§£ã€@Injectå’Œ@Valueæ³¨è§£çš„å±æ€§å’Œæ–¹æ³•</span>\n      <span class="token class-name">InjectionMetadata</span> metadata <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">findAutowiringMetadata</span><span class="token punctuation">(</span>beanName<span class="token punctuation">,</span> bean<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> pvs<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n      <span class="token keyword">try</span> <span class="token punctuation">{</span>\n          <span class="token comment">//å±æ€§å¡«å……</span>\n          metadata<span class="token punctuation">.</span><span class="token function">inject</span><span class="token punctuation">(</span>bean<span class="token punctuation">,</span> beanName<span class="token punctuation">,</span> pvs<span class="token punctuation">)</span><span class="token punctuation">;</span>\n          <span class="token keyword">return</span> pvs<span class="token punctuation">;</span>\n      <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">BeanCreationException</span> var6<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n          <span class="token keyword">throw</span> var6<span class="token punctuation">;</span>\n      <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Throwable</span> var7<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n          <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">BeanCreationException</span><span class="token punctuation">(</span>beanName<span class="token punctuation">,</span> <span class="token string">&quot;Injection of autowired dependencies failed&quot;</span><span class="token punctuation">,</span> var7<span class="token punctuation">)</span><span class="token punctuation">;</span>\n      <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/xingbiaogongzhonghao.png" alt="" loading="lazy"></p><h2 id="aop" tabindex="-1"><a class="header-anchor" href="#aop" aria-hidden="true">#</a> AOP</h2><h3 id="_19-è¯´è¯´ä»€ä¹ˆæ˜¯-aop" tabindex="-1"><a class="header-anchor" href="#_19-è¯´è¯´ä»€ä¹ˆæ˜¯-aop" aria-hidden="true">#</a> 19.è¯´è¯´ä»€ä¹ˆæ˜¯ AOPï¼Ÿ</h3><p>AOPï¼šé¢å‘åˆ‡é¢ç¼–ç¨‹ã€‚ç®€å•è¯´ï¼Œå°±æ˜¯æŠŠä¸€äº›ä¸šåŠ¡é€»è¾‘ä¸­çš„ç›¸åŒçš„ä»£ç æŠ½å–åˆ°ä¸€ä¸ªç‹¬ç«‹çš„æ¨¡å—ä¸­ï¼Œè®©ä¸šåŠ¡é€»è¾‘æ›´åŠ æ¸…çˆ½ã€‚</p><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/spring-09dbcda4-7c1b-42d6-8520-1a5fc84abbde.png" alt="æ¨ªå‘æŠ½å–" loading="lazy"></p><p>å…·ä½“æ¥è¯´ï¼Œå‡å¦‚æˆ‘ç°åœ¨è¦ crud å†™ä¸€å †ä¸šåŠ¡ï¼Œå¯æ˜¯å¦‚ä½•ä¸šåŠ¡ä»£ç å‰åå‰åè¿›è¡Œæ‰“å°æ—¥å¿—å’Œå‚æ•°çš„æ ¡éªŒå‘¢ï¼Ÿ</p><p>æˆ‘ä»¬å¯ä»¥æŠŠ<code>æ—¥å¿—è®°å½•</code>å’Œ<code>æ•°æ®æ ¡éªŒ</code>å¯é‡ç”¨çš„åŠŸèƒ½æ¨¡å—åˆ†ç¦»å‡ºæ¥ï¼Œç„¶ååœ¨ç¨‹åºçš„æ‰§è¡Œçš„åˆé€‚çš„åœ°æ–¹åŠ¨æ€åœ°æ¤å…¥è¿™äº›ä»£ç å¹¶æ‰§è¡Œã€‚è¿™æ ·å°±ç®€åŒ–äº†ä»£ç çš„ä¹¦å†™ã€‚</p><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/spring-4754b4c0-0356-4077-a2f9-55e246cf8ba0.png" alt="AOPåº”ç”¨ç¤ºä¾‹" loading="lazy"></p><p>ä¸šåŠ¡é€»è¾‘ä»£ç ä¸­æ²¡æœ‰å‚å’Œé€šç”¨é€»è¾‘çš„ä»£ç ï¼Œä¸šåŠ¡æ¨¡å—æ›´ç®€æ´ï¼ŒåªåŒ…å«æ ¸å¿ƒä¸šåŠ¡ä»£ç ã€‚å®ç°äº†ä¸šåŠ¡é€»è¾‘å’Œé€šç”¨é€»è¾‘çš„ä»£ç åˆ†ç¦»ï¼Œä¾¿äºç»´æŠ¤å’Œå‡çº§ï¼Œé™ä½äº†ä¸šåŠ¡é€»è¾‘å’Œé€šç”¨é€»è¾‘çš„è€¦åˆæ€§ã€‚</p><p>AOP å¯ä»¥å°†éå¸ƒåº”ç”¨å„å¤„çš„åŠŸèƒ½åˆ†ç¦»å‡ºæ¥å½¢æˆå¯é‡ç”¨çš„ç»„ä»¶ã€‚åœ¨ç¼–è¯‘æœŸé—´ã€è£…è½½æœŸé—´æˆ–è¿è¡ŒæœŸé—´å®ç°åœ¨ä¸ä¿®æ”¹æºä»£ç çš„æƒ…å†µä¸‹ç»™ç¨‹åºåŠ¨æ€æ·»åŠ åŠŸèƒ½ã€‚ä»è€Œå®ç°å¯¹ä¸šåŠ¡é€»è¾‘çš„éš”ç¦»ï¼Œæé«˜ä»£ç çš„æ¨¡å—åŒ–èƒ½åŠ›ã€‚</p><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/spring-2b9859e5-019c-4e87-a449-990d3deae135.png" alt="Javaè¯­è¨€æ‰§è¡Œè¿‡ç¨‹" loading="lazy"></p><p>AOP çš„æ ¸å¿ƒå…¶å®å°±æ˜¯<strong>åŠ¨æ€ä»£ç†</strong>ï¼Œå¦‚æœæ˜¯å®ç°äº†æ¥å£çš„è¯å°±ä¼šä½¿ç”¨ JDK åŠ¨æ€ä»£ç†ï¼Œå¦åˆ™ä½¿ç”¨ CGLIB ä»£ç†ï¼Œä¸»è¦åº”ç”¨äºå¤„ç†ä¸€äº›å…·æœ‰æ¨ªåˆ‡æ€§è´¨çš„ç³»ç»Ÿçº§æœåŠ¡ï¼Œå¦‚æ—¥å¿—æ”¶é›†ã€äº‹åŠ¡ç®¡ç†ã€å®‰å…¨æ£€æŸ¥ã€ç¼“å­˜ã€å¯¹è±¡æ± ç®¡ç†ç­‰ã€‚</p><blockquote><p><strong>AOP æœ‰å“ªäº›æ ¸å¿ƒæ¦‚å¿µï¼Ÿ</strong></p></blockquote><ul><li><p><strong>åˆ‡é¢</strong>ï¼ˆAspectï¼‰ï¼šç±»æ˜¯å¯¹ç‰©ä½“ç‰¹å¾çš„æŠ½è±¡ï¼Œåˆ‡é¢å°±æ˜¯å¯¹æ¨ªåˆ‡å…³æ³¨ç‚¹çš„æŠ½è±¡</p></li><li><p><strong>è¿æ¥ç‚¹</strong>ï¼ˆJoinpointï¼‰ï¼šè¢«æ‹¦æˆªåˆ°çš„ç‚¹ï¼Œå› ä¸º Spring åªæ”¯æŒæ–¹æ³•ç±»å‹çš„è¿æ¥ç‚¹ï¼Œæ‰€ä»¥åœ¨ Spring ä¸­è¿æ¥ç‚¹æŒ‡çš„å°±æ˜¯è¢«æ‹¦æˆªåˆ°çš„æ–¹æ³•ï¼Œå®é™…ä¸Šè¿æ¥ç‚¹è¿˜å¯ä»¥æ˜¯å­—æ®µæˆ–è€…æ„é€ å™¨</p></li><li><p><strong>åˆ‡ç‚¹</strong>ï¼ˆPointcutï¼‰ï¼šå¯¹è¿æ¥ç‚¹è¿›è¡Œæ‹¦æˆªçš„å®šä½</p></li><li><p><strong>é€šçŸ¥</strong>ï¼ˆAdviceï¼‰ï¼šæ‰€è°“é€šçŸ¥æŒ‡çš„å°±æ˜¯æŒ‡æ‹¦æˆªåˆ°è¿æ¥ç‚¹ä¹‹åè¦æ‰§è¡Œçš„ä»£ç ï¼Œä¹Ÿå¯ä»¥ç§°ä½œ<strong>å¢å¼º</strong></p></li><li><p><strong>ç›®æ ‡å¯¹è±¡</strong> ï¼ˆTargetï¼‰ï¼šä»£ç†çš„ç›®æ ‡å¯¹è±¡</p></li><li><p><strong>ç»‡å…¥</strong>ï¼ˆWeabingï¼‰ï¼šç»‡å…¥æ˜¯å°†å¢å¼ºæ·»åŠ åˆ°ç›®æ ‡ç±»çš„å…·ä½“è¿æ¥ç‚¹ä¸Šçš„è¿‡ç¨‹ã€‚</p><ul><li><p>ç¼–è¯‘æœŸç»‡å…¥ï¼šåˆ‡é¢åœ¨ç›®æ ‡ç±»ç¼–è¯‘æ—¶è¢«ç»‡å…¥</p></li><li><p>ç±»åŠ è½½æœŸç»‡å…¥ï¼šåˆ‡é¢åœ¨ç›®æ ‡ç±»åŠ è½½åˆ° JVM æ—¶è¢«ç»‡å…¥ã€‚éœ€è¦ç‰¹æ®Šçš„ç±»åŠ è½½å™¨ï¼Œå®ƒå¯ä»¥åœ¨ç›®æ ‡ç±»è¢«å¼•å…¥åº”ç”¨ä¹‹å‰å¢å¼ºè¯¥ç›®æ ‡ç±»çš„å­—èŠ‚ç ã€‚</p></li><li><p>è¿è¡ŒæœŸç»‡å…¥ï¼šåˆ‡é¢åœ¨åº”ç”¨è¿è¡Œçš„æŸä¸ªæ—¶åˆ»è¢«ç»‡å…¥ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œåœ¨ç»‡å…¥åˆ‡é¢æ—¶ï¼ŒAOP å®¹å™¨ä¼šä¸ºç›®æ ‡å¯¹è±¡åŠ¨æ€åœ°åˆ›å»ºä¸€ä¸ªä»£ç†å¯¹è±¡ã€‚SpringAOP å°±æ˜¯ä»¥è¿™ç§æ–¹å¼ç»‡å…¥åˆ‡é¢ã€‚</p><p>Spring é‡‡ç”¨è¿è¡ŒæœŸç»‡å…¥ï¼Œè€Œ AspectJ é‡‡ç”¨ç¼–è¯‘æœŸç»‡å…¥å’Œç±»åŠ è½½å™¨ç»‡å…¥ã€‚</p></li></ul></li><li><p><strong>å¼•ä»‹</strong>ï¼ˆintroductionï¼‰ï¼šå¼•ä»‹æ˜¯ä¸€ç§ç‰¹æ®Šçš„å¢å¼ºï¼Œå¯ä»¥åŠ¨æ€åœ°ä¸ºç±»æ·»åŠ ä¸€äº›å±æ€§å’Œæ–¹æ³•</p></li></ul><blockquote><p><strong>AOP æœ‰å“ªäº›ç¯ç»•æ–¹å¼ï¼Ÿ</strong></p></blockquote><p>AOP ä¸€èˆ¬æœ‰ <strong>5 ç§</strong>ç¯ç»•æ–¹å¼ï¼š</p><ul><li>å‰ç½®é€šçŸ¥ (@Before)</li><li>è¿”å›é€šçŸ¥ (@AfterReturning)</li><li>å¼‚å¸¸é€šçŸ¥ (@AfterThrowing)</li><li>åç½®é€šçŸ¥ (@After)</li><li>ç¯ç»•é€šçŸ¥ (@Around)</li></ul><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/spring-320fa34f-6620-419c-b17a-4f516a83caeb.png" alt="ç¯ç»•æ–¹å¼" loading="lazy"></p><p>å¤šä¸ªåˆ‡é¢çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥é€šè¿‡ @Order æŒ‡å®šå…ˆåé¡ºåºï¼Œæ•°å­—è¶Šå°ï¼Œä¼˜å…ˆçº§è¶Šé«˜ã€‚</p><h3 id="_20-è¯´è¯´ä½ å¹³æ—¶æœ‰ç”¨åˆ°-aop-å—" tabindex="-1"><a class="header-anchor" href="#_20-è¯´è¯´ä½ å¹³æ—¶æœ‰ç”¨åˆ°-aop-å—" aria-hidden="true">#</a> 20.è¯´è¯´ä½ å¹³æ—¶æœ‰ç”¨åˆ° AOP å—ï¼Ÿ</h3><p>PSï¼šè¿™é“é¢˜è€ä¸‰çš„åŒäº‹é¢è¯•å€™é€‰äººçš„æ—¶å€™é—®åˆ°äº†ï¼Œå€™é€‰äººè¯´äº†ä¸€å † AOP åŸç†ï¼ŒåŒäº‹å°±åŠ¿æ¥ä¸€å¥ï¼Œä½ èƒ½ç°åœºå†™ä¸€ä¸‹ AOP çš„åº”ç”¨å—ï¼Ÿç»“æœâ€”â€”åœºé¢ä¸€åº¦å¾ˆå°´å°¬ã€‚è™½ç„¶æˆ‘å¯¹é¢è¯•å†™è¿™ç§ç™¾åº¦å°±èƒ½å‡ºæ¥çš„ä¸œè¥¿æŒä¿ç•™æ„è§ï¼Œä½†æ˜¯è¿˜æ˜¯åŠ ä¸Šäº†è¿™ä¸€é—®ï¼Œæ¯•ç«Ÿæ‹›äººæœ€åéƒ½æ˜¯è¦æ’¸ä»£ç çš„ã€‚</p><p>è¿™é‡Œç»™å‡ºä¸€ä¸ªå°ä¾‹å­ï¼ŒSpringBoot é¡¹ç›®ä¸­ï¼Œåˆ©ç”¨ AOP æ‰“å°æ¥å£çš„å…¥å‚å’Œå‡ºå‚æ—¥å¿—ï¼Œä»¥åŠæ‰§è¡Œæ—¶é—´ï¼Œè¿˜æ˜¯æ¯”è¾ƒå¿«æ·çš„ã€‚</p><ul><li><p>å¼•å…¥ä¾èµ–ï¼šå¼•å…¥ AOP ä¾èµ–</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>        <span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>\n            <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>\n            <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>spring<span class="token operator">-</span>boot<span class="token operator">-</span>starter<span class="token operator">-</span>aop<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>\n        <span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>è‡ªå®šä¹‰æ³¨è§£ï¼šè‡ªå®šä¹‰ä¸€ä¸ªæ³¨è§£ä½œä¸ºåˆ‡ç‚¹</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span><span class="token class-name">RetentionPolicy</span><span class="token punctuation">.</span>RUNTIME<span class="token punctuation">)</span>\n<span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token class-name">ElementType</span><span class="token punctuation">.</span>METHOD<span class="token punctuation">}</span><span class="token punctuation">)</span>\n<span class="token annotation punctuation">@Documented</span>\n<span class="token keyword">public</span> <span class="token annotation punctuation">@interface</span> <span class="token class-name">WebLog</span> <span class="token punctuation">{</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>é…ç½® AOP åˆ‡é¢ï¼š</p><ul><li><p>@Aspectï¼šæ ‡è¯†åˆ‡é¢</p></li><li><p>@Pointcutï¼šè®¾ç½®åˆ‡ç‚¹ï¼Œè¿™é‡Œä»¥è‡ªå®šä¹‰æ³¨è§£ä¸ºåˆ‡ç‚¹ï¼Œå®šä¹‰åˆ‡ç‚¹æœ‰å¾ˆå¤šå…¶å®ƒç§æ–¹å¼ï¼Œè‡ªå®šä¹‰æ³¨è§£æ˜¯æ¯”è¾ƒå¸¸ç”¨çš„ä¸€ç§ã€‚</p></li><li><p>@Beforeï¼šåœ¨åˆ‡ç‚¹ä¹‹å‰ç»‡å…¥ï¼Œæ‰“å°äº†ä¸€äº›å…¥å‚ä¿¡æ¯</p></li><li><p>@Aroundï¼šç¯ç»•åˆ‡ç‚¹ï¼Œæ‰“å°è¿”å›å‚æ•°å’Œæ¥å£æ‰§è¡Œæ—¶é—´</p></li></ul><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Aspect</span>\n<span class="token annotation punctuation">@Component</span>\n<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WebLogAspect</span> <span class="token punctuation">{</span>\n\n    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token keyword">static</span> <span class="token class-name">Logger</span> logger         <span class="token operator">=</span> <span class="token class-name">LoggerFactory</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token class-name">WebLogAspect</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token doc-comment comment">/**\n     * ä»¥è‡ªå®šä¹‰ @WebLog æ³¨è§£ä¸ºåˆ‡ç‚¹\n     **/</span>\n    <span class="token annotation punctuation">@Pointcut</span><span class="token punctuation">(</span><span class="token string">&quot;@annotation(cn.fighter3.spring.aop_demo.WebLog)&quot;</span><span class="token punctuation">)</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">webLog</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>\n\n    <span class="token doc-comment comment">/**\n     * åœ¨åˆ‡ç‚¹ä¹‹å‰ç»‡å…¥\n     */</span>\n    <span class="token annotation punctuation">@Before</span><span class="token punctuation">(</span><span class="token string">&quot;webLog()&quot;</span><span class="token punctuation">)</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doBefore</span><span class="token punctuation">(</span><span class="token class-name">JoinPoint</span> joinPoint<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Throwable</span> <span class="token punctuation">{</span>\n        <span class="token comment">// å¼€å§‹æ‰“å°è¯·æ±‚æ—¥å¿—</span>\n        <span class="token class-name">ServletRequestAttributes</span> attributes <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">ServletRequestAttributes</span><span class="token punctuation">)</span> <span class="token class-name">RequestContextHolder</span><span class="token punctuation">.</span><span class="token function">getRequestAttributes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token class-name">HttpServletRequest</span> request <span class="token operator">=</span> attributes<span class="token punctuation">.</span><span class="token function">getRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token comment">// æ‰“å°è¯·æ±‚ç›¸å…³å‚æ•°</span>\n        logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;========================================== Start ==========================================&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token comment">// æ‰“å°è¯·æ±‚ url</span>\n        logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;URL            : {}&quot;</span><span class="token punctuation">,</span> request<span class="token punctuation">.</span><span class="token function">getRequestURL</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token comment">// æ‰“å° Http method</span>\n        logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;HTTP Method    : {}&quot;</span><span class="token punctuation">,</span> request<span class="token punctuation">.</span><span class="token function">getMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token comment">// æ‰“å°è°ƒç”¨ controller çš„å…¨è·¯å¾„ä»¥åŠæ‰§è¡Œæ–¹æ³•</span>\n        logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;Class Method   : {}.{}&quot;</span><span class="token punctuation">,</span> joinPoint<span class="token punctuation">.</span><span class="token function">getSignature</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getDeclaringTypeName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> joinPoint<span class="token punctuation">.</span><span class="token function">getSignature</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token comment">// æ‰“å°è¯·æ±‚çš„ IP</span>\n        logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;IP             : {}&quot;</span><span class="token punctuation">,</span> request<span class="token punctuation">.</span><span class="token function">getRemoteAddr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token comment">// æ‰“å°è¯·æ±‚å…¥å‚</span>\n        logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;Request Args   : {}&quot;</span><span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token class-name">ObjectMapper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">writeValueAsString</span><span class="token punctuation">(</span>joinPoint<span class="token punctuation">.</span><span class="token function">getArgs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token doc-comment comment">/**\n     * åœ¨åˆ‡ç‚¹ä¹‹åç»‡å…¥\n     * <span class="token keyword">@throws</span> <span class="token reference"><span class="token class-name">Throwable</span></span>\n     */</span>\n    <span class="token annotation punctuation">@After</span><span class="token punctuation">(</span><span class="token string">&quot;webLog()&quot;</span><span class="token punctuation">)</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doAfter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Throwable</span> <span class="token punctuation">{</span>\n        <span class="token comment">// ç»“æŸåæ‰“ä¸ªåˆ†éš”çº¿ï¼Œæ–¹ä¾¿æŸ¥çœ‹</span>\n        logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;=========================================== End ===========================================&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token doc-comment comment">/**\n     * ç¯ç»•\n     */</span>\n    <span class="token annotation punctuation">@Around</span><span class="token punctuation">(</span><span class="token string">&quot;webLog()&quot;</span><span class="token punctuation">)</span>\n    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">doAround</span><span class="token punctuation">(</span><span class="token class-name">ProceedingJoinPoint</span> proceedingJoinPoint<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Throwable</span> <span class="token punctuation">{</span>\n        <span class="token comment">//å¼€å§‹æ—¶é—´</span>\n        <span class="token keyword">long</span> startTime <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token class-name">Object</span> result <span class="token operator">=</span> proceedingJoinPoint<span class="token punctuation">.</span><span class="token function">proceed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token comment">// æ‰“å°å‡ºå‚</span>\n        logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;Response Args  : {}&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">ObjectMapper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">writeValueAsString</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token comment">// æ‰§è¡Œè€—æ—¶</span>\n        logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;Time-Consuming : {} ms&quot;</span><span class="token punctuation">,</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> startTime<span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token keyword">return</span> result<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>ä½¿ç”¨ï¼šåªéœ€è¦åœ¨æ¥å£ä¸ŠåŠ ä¸Šè‡ªå®šä¹‰æ³¨è§£</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/hello&quot;</span><span class="token punctuation">)</span>\n    <span class="token annotation punctuation">@WebLog</span><span class="token punctuation">(</span>desc <span class="token operator">=</span> <span class="token string">&quot;è¿™æ˜¯ä¸€ä¸ªæ¬¢è¿æ¥å£&quot;</span><span class="token punctuation">)</span>\n    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">hello</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span><span class="token punctuation">{</span>\n        <span class="token keyword">return</span> <span class="token string">&quot;Hello &quot;</span><span class="token operator">+</span>name<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><ul><li>æ‰§è¡Œç»“æœï¼šå¯ä»¥çœ‹åˆ°æ—¥å¿—æ‰“å°äº†å…¥å‚ã€å‡ºå‚å’Œæ‰§è¡Œæ—¶é—´ <img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/spring-9c14f774-44b9-41b3-a8c0-f2a54385f6ff.png" alt="æ‰§è¡Œç»“æœ" loading="lazy"></li></ul><h3 id="_21-è¯´è¯´-jdk-åŠ¨æ€ä»£ç†å’Œ-cglib-ä»£ç†" tabindex="-1"><a class="header-anchor" href="#_21-è¯´è¯´-jdk-åŠ¨æ€ä»£ç†å’Œ-cglib-ä»£ç†" aria-hidden="true">#</a> 21.è¯´è¯´ JDK åŠ¨æ€ä»£ç†å’Œ CGLIB ä»£ç† ï¼Ÿ</h3>',117),b=(0,e.Uk)("Spring çš„ AOP æ˜¯é€šè¿‡"),y={href:"https://mp.weixin.qq.com/s/aZtfwik0weJN5JzYc-JxYg",target:"_blank",rel:"noopener noreferrer"},f=(0,e.Uk)("åŠ¨æ€ä»£ç†"),h=(0,e.Uk)("æ¥å®ç°çš„ï¼ŒåŠ¨æ€ä»£ç†ä¸»è¦æœ‰ä¸¤ç§æ–¹å¼ JDK åŠ¨æ€ä»£ç†å’Œ Cglib åŠ¨æ€ä»£ç†ï¼Œè¿™ä¸¤ç§åŠ¨æ€ä»£ç†çš„ä½¿ç”¨å’ŒåŸç†æœ‰äº›ä¸åŒã€‚"),w=(0,e.uE)('<p><strong>JDK åŠ¨æ€ä»£ç†</strong></p><ol><li><strong>Interface</strong>ï¼šå¯¹äº JDK åŠ¨æ€ä»£ç†ï¼Œç›®æ ‡ç±»éœ€è¦å®ç°ä¸€ä¸ª Interfaceã€‚</li><li><strong>InvocationHandler</strong>ï¼šInvocationHandler æ˜¯ä¸€ä¸ªæ¥å£ï¼Œå¯ä»¥é€šè¿‡å®ç°è¿™ä¸ªæ¥å£ï¼Œå®šä¹‰æ¨ªåˆ‡é€»è¾‘ï¼Œå†é€šè¿‡åå°„æœºåˆ¶ï¼ˆinvokeï¼‰è°ƒç”¨ç›®æ ‡ç±»çš„ä»£ç ï¼Œåœ¨æ¬¡è¿‡ç¨‹ï¼Œå¯èƒ½åŒ…è£…é€»è¾‘ï¼Œå¯¹ç›®æ ‡æ–¹æ³•è¿›è¡Œå‰ç½®åç½®å¤„ç†ã€‚</li><li><strong>Proxy</strong>ï¼šProxy åˆ©ç”¨ InvocationHandler åŠ¨æ€åˆ›å»ºä¸€ä¸ªç¬¦åˆç›®æ ‡ç±»å®ç°çš„æ¥å£çš„å®ä¾‹ï¼Œç”Ÿæˆç›®æ ‡ç±»çš„ä»£ç†å¯¹è±¡ã€‚</li></ol><p><strong>CgLib åŠ¨æ€ä»£ç†</strong></p><ol><li>ä½¿ç”¨ JDK åˆ›å»ºä»£ç†æœ‰ä¸€å¤§é™åˆ¶ï¼Œå®ƒåªèƒ½ä¸ºæ¥å£åˆ›å»ºä»£ç†å®ä¾‹ï¼Œè€Œ CgLib åŠ¨æ€ä»£ç†å°±æ²¡æœ‰è¿™ä¸ªé™åˆ¶ã€‚</li><li>CgLib åŠ¨æ€ä»£ç†æ˜¯ä½¿ç”¨å­—èŠ‚ç å¤„ç†æ¡†æ¶ <strong>ASM</strong>ï¼Œå…¶åŸç†æ˜¯é€šè¿‡å­—èŠ‚ç æŠ€æœ¯ä¸ºä¸€ä¸ªç±»åˆ›å»ºå­ç±»ï¼Œå¹¶åœ¨å­ç±»ä¸­é‡‡ç”¨æ–¹æ³•æ‹¦æˆªçš„æŠ€æœ¯æ‹¦æˆªæ‰€æœ‰çˆ¶ç±»æ–¹æ³•çš„è°ƒç”¨ï¼Œé¡ºåŠ¿ç»‡å…¥æ¨ªåˆ‡é€»è¾‘ã€‚</li><li><strong>CgLib</strong> åˆ›å»ºçš„åŠ¨æ€ä»£ç†å¯¹è±¡æ€§èƒ½æ¯” JDK åˆ›å»ºçš„åŠ¨æ€ä»£ç†å¯¹è±¡çš„æ€§èƒ½é«˜ä¸å°‘ï¼Œä½†æ˜¯ CGLib åœ¨åˆ›å»ºä»£ç†å¯¹è±¡æ—¶æ‰€èŠ±è´¹çš„æ—¶é—´å´æ¯” JDK å¤šå¾—å¤šï¼Œæ‰€ä»¥å¯¹äºå•ä¾‹çš„å¯¹è±¡ï¼Œå› ä¸ºæ— éœ€é¢‘ç¹åˆ›å»ºå¯¹è±¡ï¼Œç”¨ CGLib åˆé€‚ï¼Œåä¹‹ï¼Œä½¿ç”¨ JDK æ–¹å¼è¦æ›´ä¸ºåˆé€‚ä¸€äº›ã€‚åŒæ—¶ï¼Œç”±äº CGLib ç”±äºæ˜¯é‡‡ç”¨åŠ¨æ€åˆ›å»ºå­ç±»çš„æ–¹æ³•ï¼Œå¯¹äº final æ–¹æ³•ï¼Œæ— æ³•è¿›è¡Œä»£ç†ã€‚</li></ol><p>æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªå¸¸è§çš„å°åœºæ™¯ï¼Œå®¢æœä¸­è½¬ï¼Œè§£å†³ç”¨æˆ·é—®é¢˜ï¼š</p><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/spring-c5c4b247-62dd-43a2-a043-da51c58f77c8.png" alt="ç”¨æˆ·å‘å®¢æœæé—®é¢˜" loading="lazy"></p><p><strong>JDK åŠ¨æ€ä»£ç†å®ç°ï¼š</strong></p><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/spring-65b14a3f-2653-463e-af77-a8875d3d635c.png" alt="JDKåŠ¨æ€ä»£ç†ç±»å›¾" loading="lazy"></p><ul><li><p>æ¥å£</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">ISolver</span> <span class="token punctuation">{</span>\n    <span class="token keyword">void</span> <span class="token function">solve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>ç›®æ ‡ç±»:éœ€è¦å®ç°å¯¹åº”æ¥å£</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Solver</span> <span class="token keyword">implements</span> <span class="token class-name">ISolver</span> <span class="token punctuation">{</span>\n    <span class="token annotation punctuation">@Override</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">solve</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;ç–¯ç‹‚æ‰å¤´å‘è§£å†³é—®é¢˜â€¦â€¦&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>æ€ä»£ç†å·¥å‚:ProxyFactoryï¼Œç›´æ¥ç”¨åå°„æ–¹å¼ç”Ÿæˆä¸€ä¸ªç›®æ ‡å¯¹è±¡çš„ä»£ç†å¯¹è±¡ï¼Œè¿™é‡Œç”¨äº†ä¸€ä¸ªåŒ¿åå†…éƒ¨ç±»æ–¹å¼é‡å†™ InvocationHandler æ–¹æ³•ï¼Œå®ç°æ¥å£é‡å†™ä¹Ÿå·®ä¸å¤š</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ProxyFactory</span> <span class="token punctuation">{</span>\n\n    <span class="token comment">// ç»´æŠ¤ä¸€ä¸ªç›®æ ‡å¯¹è±¡</span>\n    <span class="token keyword">private</span> <span class="token class-name">Object</span> target<span class="token punctuation">;</span>\n\n    <span class="token keyword">public</span> <span class="token class-name">ProxyFactory</span><span class="token punctuation">(</span><span class="token class-name">Object</span> target<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>target <span class="token operator">=</span> target<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token comment">// ä¸ºç›®æ ‡å¯¹è±¡ç”Ÿæˆä»£ç†å¯¹è±¡</span>\n    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">getProxyInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token keyword">return</span> <span class="token class-name">Proxy</span><span class="token punctuation">.</span><span class="token function">newProxyInstance</span><span class="token punctuation">(</span>target<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> target<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getInterfaces</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n                <span class="token keyword">new</span> <span class="token class-name">InvocationHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n                    <span class="token annotation punctuation">@Override</span>\n                    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">invoke</span><span class="token punctuation">(</span><span class="token class-name">Object</span> proxy<span class="token punctuation">,</span> <span class="token class-name">Method</span> method<span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Throwable</span> <span class="token punctuation">{</span>\n                        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;è¯·é—®æœ‰ä»€ä¹ˆå¯ä»¥å¸®åˆ°æ‚¨ï¼Ÿ&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n                        <span class="token comment">// è°ƒç”¨ç›®æ ‡å¯¹è±¡æ–¹æ³•</span>\n                        <span class="token class-name">Object</span> returnValue <span class="token operator">=</span> method<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n                        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;é—®é¢˜å·²ç»è§£å†³å•¦ï¼&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n                        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>\n                    <span class="token punctuation">}</span>\n                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>å®¢æˆ·ç«¯ï¼šClientï¼Œç”Ÿæˆä¸€ä¸ªä»£ç†å¯¹è±¡å®ä¾‹ï¼Œé€šè¿‡ä»£ç†å¯¹è±¡è°ƒç”¨ç›®æ ‡å¯¹è±¡æ–¹æ³•</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Client</span> <span class="token punctuation">{</span>\n    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token comment">//ç›®æ ‡å¯¹è±¡:ç¨‹åºå‘˜</span>\n        <span class="token class-name">ISolver</span> developer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Solver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token comment">//ä»£ç†ï¼šå®¢æœå°å§å§</span>\n        <span class="token class-name">ISolver</span> csProxy <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">ISolver</span><span class="token punctuation">)</span> <span class="token keyword">new</span> <span class="token class-name">ProxyFactory</span><span class="token punctuation">(</span>developer<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getProxyInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token comment">//ç›®æ ‡æ–¹æ³•ï¼šè§£å†³é—®é¢˜</span>\n        csProxy<span class="token punctuation">.</span><span class="token function">solve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><p><strong>Cglib åŠ¨æ€ä»£ç†å®ç°ï¼š</strong></p><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/spring-74da87af-20d1-4a5b-a212-3837a15f0bab.png" alt="CglibåŠ¨æ€ä»£ç†ç±»å›¾" loading="lazy"></p><ul><li><p>ç›®æ ‡ç±»ï¼šSolverï¼Œè¿™é‡Œç›®æ ‡ç±»ä¸ç”¨å†å®ç°æ¥å£ã€‚</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Solver</span> <span class="token punctuation">{</span>\n\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">solve</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;ç–¯ç‹‚æ‰å¤´å‘è§£å†³é—®é¢˜â€¦â€¦&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>åŠ¨æ€ä»£ç†å·¥å‚ï¼š</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ProxyFactory</span> <span class="token keyword">implements</span> <span class="token class-name">MethodInterceptor</span> <span class="token punctuation">{</span>\n\n   <span class="token comment">//ç»´æŠ¤ä¸€ä¸ªç›®æ ‡å¯¹è±¡</span>\n    <span class="token keyword">private</span> <span class="token class-name">Object</span> target<span class="token punctuation">;</span>\n\n    <span class="token keyword">public</span> <span class="token class-name">ProxyFactory</span><span class="token punctuation">(</span><span class="token class-name">Object</span> target<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>target <span class="token operator">=</span> target<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token comment">//ä¸ºç›®æ ‡å¯¹è±¡ç”Ÿæˆä»£ç†å¯¹è±¡</span>\n    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">getProxyInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token comment">//å·¥å…·ç±»</span>\n        <span class="token class-name">Enhancer</span> en <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Enhancer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token comment">//è®¾ç½®çˆ¶ç±»</span>\n        en<span class="token punctuation">.</span><span class="token function">setSuperclass</span><span class="token punctuation">(</span>target<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token comment">//è®¾ç½®å›è°ƒå‡½æ•°</span>\n        en<span class="token punctuation">.</span><span class="token function">setCallback</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token comment">//åˆ›å»ºå­ç±»å¯¹è±¡ä»£ç†</span>\n        <span class="token keyword">return</span> en<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token annotation punctuation">@Override</span>\n    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">intercept</span><span class="token punctuation">(</span><span class="token class-name">Object</span> obj<span class="token punctuation">,</span> <span class="token class-name">Method</span> method<span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">,</span> <span class="token class-name">MethodProxy</span> proxy<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Throwable</span> <span class="token punctuation">{</span>\n        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;è¯·é—®æœ‰ä»€ä¹ˆå¯ä»¥å¸®åˆ°æ‚¨ï¼Ÿ&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token comment">// æ‰§è¡Œç›®æ ‡å¯¹è±¡çš„æ–¹æ³•</span>\n        <span class="token class-name">Object</span> returnValue <span class="token operator">=</span> method<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;é—®é¢˜å·²ç»è§£å†³å•¦ï¼&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>å®¢æˆ·ç«¯ï¼šClient</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Client</span> <span class="token punctuation">{</span>\n    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token comment">//ç›®æ ‡å¯¹è±¡:ç¨‹åºå‘˜</span>\n        <span class="token class-name">Solver</span> developer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Solver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token comment">//ä»£ç†ï¼šå®¢æœå°å§å§</span>\n        <span class="token class-name">Solver</span> csProxy <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Solver</span><span class="token punctuation">)</span> <span class="token keyword">new</span> <span class="token class-name">ProxyFactory</span><span class="token punctuation">(</span>developer<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getProxyInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token comment">//ç›®æ ‡æ–¹æ³•ï¼šè§£å†³é—®é¢˜</span>\n        csProxy<span class="token punctuation">.</span><span class="token function">solve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h3 id="_22-è¯´è¯´-spring-aop-å’Œ-aspectj-aop-åŒºåˆ«" tabindex="-1"><a class="header-anchor" href="#_22-è¯´è¯´-spring-aop-å’Œ-aspectj-aop-åŒºåˆ«" aria-hidden="true">#</a> 22.è¯´è¯´ Spring AOP å’Œ AspectJ AOP åŒºåˆ«?</h3><p><strong>Spring AOP</strong></p><p>Spring AOP å±äº<code>è¿è¡Œæ—¶å¢å¼º</code>ï¼Œä¸»è¦å…·æœ‰å¦‚ä¸‹ç‰¹ç‚¹ï¼š</p><ol><li><p>åŸºäºåŠ¨æ€ä»£ç†æ¥å®ç°ï¼Œé»˜è®¤å¦‚æœä½¿ç”¨æ¥å£çš„ï¼Œç”¨ JDK æä¾›çš„åŠ¨æ€ä»£ç†å®ç°ï¼Œå¦‚æœæ˜¯æ–¹æ³•åˆ™ä½¿ç”¨ CGLIB å®ç°</p></li><li><p>Spring AOP éœ€è¦ä¾èµ– IOC å®¹å™¨æ¥ç®¡ç†ï¼Œå¹¶ä¸”åªèƒ½ä½œç”¨äº Spring å®¹å™¨ï¼Œä½¿ç”¨çº¯ Java ä»£ç å®ç°</p></li><li><p>åœ¨æ€§èƒ½ä¸Šï¼Œç”±äº Spring AOP æ˜¯åŸºäº<strong>åŠ¨æ€ä»£ç†</strong>æ¥å®ç°çš„ï¼Œåœ¨å®¹å™¨å¯åŠ¨æ—¶éœ€è¦ç”Ÿæˆä»£ç†å®ä¾‹ï¼Œåœ¨æ–¹æ³•è°ƒç”¨ä¸Šä¹Ÿä¼šå¢åŠ æ ˆçš„æ·±åº¦ï¼Œä½¿å¾— Spring AOP çš„æ€§èƒ½ä¸å¦‚ AspectJ çš„é‚£ä¹ˆå¥½ã€‚</p></li><li><p>Spring AOP è‡´åŠ›äºè§£å†³ä¼ä¸šçº§å¼€å‘ä¸­æœ€æ™®éçš„ AOP(æ–¹æ³•ç»‡å…¥)ã€‚</p></li></ol><p><strong>AspectJ</strong></p><p>AspectJ æ˜¯ä¸€ä¸ªæ˜“ç”¨çš„åŠŸèƒ½å¼ºå¤§çš„ AOP æ¡†æ¶ï¼Œå±äº<code>ç¼–è¯‘æ—¶å¢å¼º</code>ï¼Œ å¯ä»¥å•ç‹¬ä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥æ•´åˆåˆ°å…¶å®ƒæ¡†æ¶ä¸­ï¼Œæ˜¯ AOP ç¼–ç¨‹çš„å®Œå…¨è§£å†³æ–¹æ¡ˆã€‚AspectJ éœ€è¦ç”¨åˆ°å•ç‹¬çš„ç¼–è¯‘å™¨ ajcã€‚</p><p>AspectJ å±äº<strong>é™æ€ç»‡å…¥</strong>ï¼Œé€šè¿‡ä¿®æ”¹ä»£ç æ¥å®ç°ï¼Œåœ¨å®é™…è¿è¡Œä¹‹å‰å°±å®Œæˆäº†ç»‡å…¥ï¼Œæ‰€ä»¥è¯´å®ƒç”Ÿæˆçš„ç±»æ˜¯æ²¡æœ‰é¢å¤–è¿è¡Œæ—¶å¼€é”€çš„ï¼Œä¸€èˆ¬æœ‰å¦‚ä¸‹å‡ ä¸ªç»‡å…¥çš„æ—¶æœºï¼š</p><ol><li><p>ç¼–è¯‘æœŸç»‡å…¥ï¼ˆCompile-time weavingï¼‰ï¼šå¦‚ç±» A ä½¿ç”¨ AspectJ æ·»åŠ äº†ä¸€ä¸ªå±æ€§ï¼Œç±» B å¼•ç”¨äº†å®ƒï¼Œè¿™ä¸ªåœºæ™¯å°±éœ€è¦ç¼–è¯‘æœŸçš„æ—¶å€™å°±è¿›è¡Œç»‡å…¥ï¼Œå¦åˆ™æ²¡æ³•ç¼–è¯‘ç±» Bã€‚</p></li><li><p>ç¼–è¯‘åç»‡å…¥ï¼ˆPost-compile weavingï¼‰ï¼šä¹Ÿå°±æ˜¯å·²ç»ç”Ÿæˆäº† .class æ–‡ä»¶ï¼Œæˆ–å·²ç»æ‰“æˆ jar åŒ…äº†ï¼Œè¿™ç§æƒ…å†µæˆ‘ä»¬éœ€è¦å¢å¼ºå¤„ç†çš„è¯ï¼Œå°±è¦ç”¨åˆ°ç¼–è¯‘åç»‡å…¥ã€‚</p></li><li><p>ç±»åŠ è½½åç»‡å…¥ï¼ˆLoad-time weavingï¼‰ï¼šæŒ‡çš„æ˜¯åœ¨åŠ è½½ç±»çš„æ—¶å€™è¿›è¡Œç»‡å…¥ï¼Œè¦å®ç°è¿™ä¸ªæ—¶æœŸçš„ç»‡å…¥ï¼Œæœ‰å‡ ç§å¸¸è§çš„æ–¹æ³•</p></li></ol><p>æ•´ä½“å¯¹æ¯”å¦‚ä¸‹ï¼š</p><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/spring-d1dbe9d9-c55f-4293-8622-d9759064d613.png" alt="Spring AOPå’ŒAspectJå¯¹æ¯”" loading="lazy"></p><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/xingbiaogongzhonghao.png" alt="" loading="lazy"></p><h2 id="äº‹åŠ¡" tabindex="-1"><a class="header-anchor" href="#äº‹åŠ¡" aria-hidden="true">#</a> äº‹åŠ¡</h2><p>Spring äº‹åŠ¡çš„æœ¬è´¨å…¶å®å°±æ˜¯æ•°æ®åº“å¯¹äº‹åŠ¡çš„æ”¯æŒï¼Œæ²¡æœ‰æ•°æ®åº“çš„äº‹åŠ¡æ”¯æŒï¼ŒSpring æ˜¯æ— æ³•æä¾›äº‹åŠ¡åŠŸèƒ½çš„ã€‚Spring åªæä¾›ç»Ÿä¸€äº‹åŠ¡ç®¡ç†æ¥å£ï¼Œå…·ä½“å®ç°éƒ½æ˜¯ç”±å„æ•°æ®åº“è‡ªå·±å®ç°ï¼Œæ•°æ®åº“äº‹åŠ¡çš„æäº¤å’Œå›æ»šæ˜¯é€šè¿‡æ•°æ®åº“è‡ªå·±çš„äº‹åŠ¡æœºåˆ¶å®ç°ã€‚</p><h3 id="_23-spring-äº‹åŠ¡çš„ç§ç±»" tabindex="-1"><a class="header-anchor" href="#_23-spring-äº‹åŠ¡çš„ç§ç±»" aria-hidden="true">#</a> 23.Spring äº‹åŠ¡çš„ç§ç±»ï¼Ÿ</h3><p>Spring æ”¯æŒ<code>ç¼–ç¨‹å¼äº‹åŠ¡</code>ç®¡ç†å’Œ<code>å£°æ˜å¼</code>äº‹åŠ¡ç®¡ç†ä¸¤ç§æ–¹å¼ï¼š</p><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/spring-d3ee77fa-926d-4c39-91f8-a8b1544a9134.png" alt="Springäº‹åŠ¡åˆ†ç±»" loading="lazy"></p><ol><li>ç¼–ç¨‹å¼äº‹åŠ¡</li></ol><p>ç¼–ç¨‹å¼äº‹åŠ¡ç®¡ç†ä½¿ç”¨ TransactionTemplateï¼Œéœ€è¦æ˜¾å¼æ‰§è¡Œäº‹åŠ¡ã€‚</p><ol start="2"><li><p>å£°æ˜å¼äº‹åŠ¡</p></li><li><p>å£°æ˜å¼äº‹åŠ¡ç®¡ç†å»ºç«‹åœ¨ AOP ä¹‹ä¸Šçš„ã€‚å…¶æœ¬è´¨æ˜¯é€šè¿‡ AOP åŠŸèƒ½ï¼Œå¯¹æ–¹æ³•å‰åè¿›è¡Œæ‹¦æˆªï¼Œå°†äº‹åŠ¡å¤„ç†çš„åŠŸèƒ½ç¼–ç»‡åˆ°æ‹¦æˆªçš„æ–¹æ³•ä¸­ï¼Œä¹Ÿå°±æ˜¯åœ¨ç›®æ ‡æ–¹æ³•å¼€å§‹ä¹‹å‰å¯åŠ¨ä¸€ä¸ªäº‹åŠ¡ï¼Œåœ¨æ‰§è¡Œå®Œç›®æ ‡æ–¹æ³•ä¹‹åæ ¹æ®æ‰§è¡Œæƒ…å†µæäº¤æˆ–è€…å›æ»šäº‹åŠ¡</p></li><li><p>ä¼˜ç‚¹æ˜¯ä¸éœ€è¦åœ¨ä¸šåŠ¡é€»è¾‘ä»£ç ä¸­æºæ‚äº‹åŠ¡ç®¡ç†çš„ä»£ç ï¼Œåªéœ€åœ¨é…ç½®æ–‡ä»¶ä¸­åšç›¸å…³çš„äº‹åŠ¡è§„åˆ™å£°æ˜æˆ–é€šè¿‡ @Transactional æ³¨è§£çš„æ–¹å¼ï¼Œä¾¿å¯ä»¥å°†äº‹åŠ¡è§„åˆ™åº”ç”¨åˆ°ä¸šåŠ¡é€»è¾‘ä¸­ï¼Œå‡å°‘ä¸šåŠ¡ä»£ç çš„æ±¡æŸ“ã€‚å”¯ä¸€ä¸è¶³åœ°æ–¹æ˜¯ï¼Œæœ€ç»†ç²’åº¦åªèƒ½ä½œç”¨åˆ°æ–¹æ³•çº§åˆ«ï¼Œæ— æ³•åšåˆ°åƒç¼–ç¨‹å¼äº‹åŠ¡é‚£æ ·å¯ä»¥ä½œç”¨åˆ°ä»£ç å—çº§åˆ«ã€‚</p></li></ol><h3 id="_24-spring-çš„äº‹åŠ¡éš”ç¦»çº§åˆ«" tabindex="-1"><a class="header-anchor" href="#_24-spring-çš„äº‹åŠ¡éš”ç¦»çº§åˆ«" aria-hidden="true">#</a> 24.Spring çš„äº‹åŠ¡éš”ç¦»çº§åˆ«ï¼Ÿ</h3><p>Spring çš„æ¥å£ TransactionDefinition ä¸­å®šä¹‰äº†è¡¨ç¤ºéš”ç¦»çº§åˆ«çš„å¸¸é‡ï¼Œå½“ç„¶å…¶å®ä¸»è¦è¿˜æ˜¯å¯¹åº”æ•°æ®åº“çš„äº‹åŠ¡éš”ç¦»çº§åˆ«ï¼š</p><ol><li>ISOLATION_DEFAULTï¼šä½¿ç”¨åç«¯æ•°æ®åº“é»˜è®¤çš„éš”ç¦»ç•Œåˆ«ï¼ŒMySQL é»˜è®¤å¯é‡å¤è¯»ï¼ŒOracle é»˜è®¤è¯»å·²æäº¤ã€‚</li><li>ISOLATION_READ_UNCOMMITTEDï¼šè¯»æœªæäº¤</li><li>ISOLATION_READ_COMMITTEDï¼šè¯»å·²æäº¤</li><li>ISOLATION_REPEATABLE_READï¼šå¯é‡å¤è¯»</li><li>ISOLATION_SERIALIZABLEï¼šä¸²è¡ŒåŒ–</li></ol><h3 id="_25-spring-çš„äº‹åŠ¡ä¼ æ’­æœºåˆ¶" tabindex="-1"><a class="header-anchor" href="#_25-spring-çš„äº‹åŠ¡ä¼ æ’­æœºåˆ¶" aria-hidden="true">#</a> 25.Spring çš„äº‹åŠ¡ä¼ æ’­æœºåˆ¶ï¼Ÿ</h3><p>Spring äº‹åŠ¡çš„ä¼ æ’­æœºåˆ¶è¯´çš„æ˜¯ï¼Œå½“å¤šä¸ªäº‹åŠ¡åŒæ—¶å­˜åœ¨çš„æ—¶å€™â€”â€”ä¸€èˆ¬æŒ‡çš„æ˜¯å¤šä¸ªäº‹åŠ¡æ–¹æ³•ç›¸äº’è°ƒç”¨æ—¶ï¼ŒSpring å¦‚ä½•å¤„ç†è¿™äº›äº‹åŠ¡çš„è¡Œä¸ºã€‚</p><p>äº‹åŠ¡ä¼ æ’­æœºåˆ¶æ˜¯ä½¿ç”¨ç®€å•çš„ ThreadLocal å®ç°çš„ï¼Œæ‰€ä»¥ï¼Œå¦‚æœè°ƒç”¨çš„æ–¹æ³•æ˜¯åœ¨æ–°çº¿ç¨‹è°ƒç”¨çš„ï¼Œäº‹åŠ¡ä¼ æ’­å®é™…ä¸Šæ˜¯ä¼šå¤±æ•ˆçš„ã€‚</p><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/spring-a6e2a8dc-9771-4d8b-9d91-76ddee98af1a.png" alt="7ç§äº‹åŠ¡ä¼ æ’­æœºåˆ¶" loading="lazy"></p><p>Spring é»˜è®¤çš„äº‹åŠ¡ä¼ æ’­è¡Œä¸ºæ˜¯ PROPAFATION_REQUIREDï¼Œå®ƒé€‚åˆç»å¤§å¤šæ•°æƒ…å†µï¼Œå¦‚æœå¤šä¸ª ServiceX#methodX()éƒ½å·¥ä½œåœ¨äº‹åŠ¡ç¯å¢ƒä¸‹ï¼ˆå‡è¢« Spring äº‹åŠ¡å¢å¼ºï¼‰ï¼Œä¸”ç¨‹åºä¸­å­˜åœ¨è°ƒç”¨é“¾ <code>Service1#method1()-&gt;Service2#method2()-&gt;Service3#method3()</code>ï¼Œé‚£ä¹ˆè¿™ 3 ä¸ªæœåŠ¡ç±»çš„ä¸‰ä¸ªæ–¹æ³•é€šè¿‡ Spring çš„äº‹åŠ¡ä¼ æ’­æœºåˆ¶éƒ½å·¥ä½œåœ¨åŒä¸€ä¸ªäº‹åŠ¡ä¸­ã€‚</p><h3 id="_26-å£°æ˜å¼äº‹åŠ¡å®ç°åŸç†äº†è§£å—" tabindex="-1"><a class="header-anchor" href="#_26-å£°æ˜å¼äº‹åŠ¡å®ç°åŸç†äº†è§£å—" aria-hidden="true">#</a> 26.å£°æ˜å¼äº‹åŠ¡å®ç°åŸç†äº†è§£å—ï¼Ÿ</h3><p>å°±æ˜¯é€šè¿‡ AOP/åŠ¨æ€ä»£ç†ã€‚</p><ul><li><p><strong>åœ¨ Bean åˆå§‹åŒ–é˜¶æ®µåˆ›å»ºä»£ç†å¯¹è±¡</strong>ï¼šSpring å®¹å™¨åœ¨åˆå§‹åŒ–æ¯ä¸ªå•ä¾‹ bean çš„æ—¶å€™ï¼Œä¼šéå†å®¹å™¨ä¸­çš„æ‰€æœ‰ BeanPostProcessor å®ç°ç±»ï¼Œå¹¶æ‰§è¡Œå…¶ postProcessAfterInitialization æ–¹æ³•ï¼Œåœ¨æ‰§è¡Œ AbstractAutoProxyCreator ç±»çš„ postProcessAfterInitialization æ–¹æ³•æ—¶ä¼šéå†å®¹å™¨ä¸­æ‰€æœ‰çš„åˆ‡é¢ï¼ŒæŸ¥æ‰¾ä¸å½“å‰å®ä¾‹åŒ– bean åŒ¹é…çš„åˆ‡é¢ï¼Œè¿™é‡Œä¼šè·å–äº‹åŠ¡å±æ€§åˆ‡é¢ï¼ŒæŸ¥æ‰¾@Transactional æ³¨è§£åŠå…¶å±æ€§å€¼ï¼Œç„¶åæ ¹æ®å¾—åˆ°çš„åˆ‡é¢åˆ›å»ºä¸€ä¸ªä»£ç†å¯¹è±¡ï¼Œé»˜è®¤æ˜¯ä½¿ç”¨ JDK åŠ¨æ€ä»£ç†åˆ›å»ºä»£ç†ï¼Œå¦‚æœç›®æ ‡ç±»æ˜¯æ¥å£ï¼Œåˆ™ä½¿ç”¨ JDK åŠ¨æ€ä»£ç†ï¼Œå¦åˆ™ä½¿ç”¨ Cglibã€‚</p></li><li><p><strong>åœ¨æ‰§è¡Œç›®æ ‡æ–¹æ³•æ—¶è¿›è¡Œäº‹åŠ¡å¢å¼ºæ“ä½œ</strong>ï¼šå½“é€šè¿‡ä»£ç†å¯¹è±¡è°ƒç”¨ Bean æ–¹æ³•çš„æ—¶å€™ï¼Œä¼šè§¦å‘å¯¹åº”çš„ AOP å¢å¼ºæ‹¦æˆªå™¨ï¼Œå£°æ˜å¼äº‹åŠ¡æ˜¯ä¸€ç§ç¯ç»•å¢å¼ºï¼Œå¯¹åº”æ¥å£ä¸º<code>MethodInterceptor</code>ï¼Œäº‹åŠ¡å¢å¼ºå¯¹è¯¥æ¥å£çš„å®ç°ä¸º<code>TransactionInterceptor</code>ï¼Œç±»å›¾å¦‚ä¸‹ï¼š</p></li></ul><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/spring-97493c7f-c596-4e98-a6a8-dab254d6d1ab.png" alt="å›¾ç‰‡æ¥æºç½‘æ˜“æŠ€æœ¯ä¸“æ " loading="lazy"></p><p>äº‹åŠ¡æ‹¦æˆªå™¨<code>TransactionInterceptor</code>åœ¨<code>invoke</code>æ–¹æ³•ä¸­ï¼Œé€šè¿‡è°ƒç”¨çˆ¶ç±»<code>TransactionAspectSupport</code>çš„<code>invokeWithinTransaction</code>æ–¹æ³•è¿›è¡Œäº‹åŠ¡å¤„ç†ï¼ŒåŒ…æ‹¬å¼€å¯äº‹åŠ¡ã€äº‹åŠ¡æäº¤ã€å¼‚å¸¸å›æ»šã€‚</p><h3 id="_27-å£°æ˜å¼äº‹åŠ¡åœ¨å“ªäº›æƒ…å†µä¸‹ä¼šå¤±æ•ˆ" tabindex="-1"><a class="header-anchor" href="#_27-å£°æ˜å¼äº‹åŠ¡åœ¨å“ªäº›æƒ…å†µä¸‹ä¼šå¤±æ•ˆ" aria-hidden="true">#</a> 27.å£°æ˜å¼äº‹åŠ¡åœ¨å“ªäº›æƒ…å†µä¸‹ä¼šå¤±æ•ˆï¼Ÿ</h3><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/spring-381e4ec9-a235-4cfa-9b4d-518095a7502a.png" alt="å£°æ˜å¼äº‹åŠ¡çš„å‡ ç§å¤±æ•ˆçš„æƒ…å†µ" loading="lazy"></p><p><strong>1ã€@Transactional åº”ç”¨åœ¨é public ä¿®é¥°çš„æ–¹æ³•ä¸Š</strong></p><p>å¦‚æœ Transactional æ³¨è§£åº”ç”¨åœ¨é public ä¿®é¥°çš„æ–¹æ³•ä¸Šï¼ŒTransactional å°†ä¼šå¤±æ•ˆã€‚</p><p>æ˜¯å› ä¸ºåœ¨ Spring AOP ä»£ç†æ—¶ï¼ŒTransactionInterceptor ï¼ˆäº‹åŠ¡æ‹¦æˆªå™¨ï¼‰åœ¨ç›®æ ‡æ–¹æ³•æ‰§è¡Œå‰åè¿›è¡Œæ‹¦æˆªï¼ŒDynamicAdvisedInterceptorï¼ˆCglibAopProxy çš„å†…éƒ¨ç±»ï¼‰çš„ intercept æ–¹æ³• æˆ– JdkDynamicAopProxy çš„ invoke æ–¹æ³•ä¼šé—´æ¥è°ƒç”¨ AbstractFallbackTransactionAttributeSource çš„ <strong>computeTransactionAttribute</strong>æ–¹æ³•ï¼Œè·å– Transactional æ³¨è§£çš„äº‹åŠ¡é…ç½®ä¿¡æ¯ã€‚</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">protected</span> <span class="token class-name">TransactionAttribute</span> <span class="token function">computeTransactionAttribute</span><span class="token punctuation">(</span><span class="token class-name">Method</span> method<span class="token punctuation">,</span>\n    <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> targetClass<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token comment">// Don&#39;t allow no-public methods as required.</span>\n        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">allowPublicMethodsOnly</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token class-name">Modifier</span><span class="token punctuation">.</span><span class="token function">isPublic</span><span class="token punctuation">(</span>method<span class="token punctuation">.</span><span class="token function">getModifiers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ­¤æ–¹æ³•ä¼šæ£€æŸ¥ç›®æ ‡æ–¹æ³•çš„ä¿®é¥°ç¬¦æ˜¯å¦ä¸º publicï¼Œä¸æ˜¯ public åˆ™ä¸ä¼šè·å–@Transactional çš„å±æ€§é…ç½®ä¿¡æ¯ã€‚</p><p><strong>2ã€@Transactional æ³¨è§£å±æ€§ propagation è®¾ç½®é”™è¯¯</strong></p><ul><li>TransactionDefinition.PROPAGATION_SUPPORTSï¼šå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œåˆ™åŠ å…¥è¯¥äº‹åŠ¡ï¼›å¦‚æœå½“å‰æ²¡æœ‰äº‹åŠ¡ï¼Œåˆ™ä»¥éäº‹åŠ¡çš„æ–¹å¼ç»§ç»­è¿è¡Œã€‚</li><li>TransactionDefinition.PROPAGATION_NOT_SUPPORTEDï¼šä»¥éäº‹åŠ¡æ–¹å¼è¿è¡Œï¼Œå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œåˆ™æŠŠå½“å‰äº‹åŠ¡æŒ‚èµ·ã€‚</li><li>TransactionDefinition.PROPAGATION_NEVERï¼šä»¥éäº‹åŠ¡æ–¹å¼è¿è¡Œï¼Œå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸ã€‚</li></ul><p><strong>3ã€@Transactional æ³¨è§£å±æ€§ rollbackFor è®¾ç½®é”™è¯¯</strong></p><p>rollbackFor å¯ä»¥æŒ‡å®šèƒ½å¤Ÿè§¦å‘äº‹åŠ¡å›æ»šçš„å¼‚å¸¸ç±»å‹ã€‚Spring é»˜è®¤æŠ›å‡ºäº†æœªæ£€æŸ¥ unchecked å¼‚å¸¸ï¼ˆç»§æ‰¿è‡ª RuntimeException çš„å¼‚å¸¸ï¼‰æˆ–è€… Error æ‰å›æ»šäº‹åŠ¡ï¼Œå…¶ä»–å¼‚å¸¸ä¸ä¼šè§¦å‘å›æ»šäº‹åŠ¡ã€‚</p><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/spring-04053b02-3264-4d7f-b868-560a0333f08d.png" alt="Springé»˜è®¤æ”¯æŒçš„å¼‚å¸¸å›æ»š" loading="lazy"></p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// å¸Œæœ›è‡ªå®šä¹‰çš„å¼‚å¸¸å¯ä»¥è¿›è¡Œå›æ»š</span>\n<span class="token annotation punctuation">@Transactional</span><span class="token punctuation">(</span>propagation<span class="token operator">=</span> <span class="token class-name">Propagation</span><span class="token punctuation">.</span>REQUIRED<span class="token punctuation">,</span>rollbackFor<span class="token operator">=</span> <span class="token class-name">MyException</span><span class="token punctuation">.</span><span class="token keyword">class</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>è‹¥åœ¨ç›®æ ‡æ–¹æ³•ä¸­æŠ›å‡ºçš„å¼‚å¸¸æ˜¯ rollbackFor æŒ‡å®šçš„å¼‚å¸¸çš„å­ç±»ï¼Œäº‹åŠ¡åŒæ ·ä¼šå›æ»šã€‚</p><p><strong>4ã€åŒä¸€ä¸ªç±»ä¸­æ–¹æ³•è°ƒç”¨ï¼Œå¯¼è‡´@Transactional å¤±æ•ˆ</strong></p><p>å¼€å‘ä¸­é¿å…ä¸äº†ä¼šå¯¹åŒä¸€ä¸ªç±»é‡Œé¢çš„æ–¹æ³•è°ƒç”¨ï¼Œæ¯”å¦‚æœ‰ä¸€ä¸ªç±» Testï¼Œå®ƒçš„ä¸€ä¸ªæ–¹æ³• Aï¼ŒA å†è°ƒç”¨æœ¬ç±»çš„æ–¹æ³• Bï¼ˆä¸è®ºæ–¹æ³• B æ˜¯ç”¨ public è¿˜æ˜¯ private ä¿®é¥°ï¼‰ï¼Œä½†æ–¹æ³• A æ²¡æœ‰å£°æ˜æ³¨è§£äº‹åŠ¡ï¼Œè€Œ B æ–¹æ³•æœ‰ã€‚åˆ™å¤–éƒ¨è°ƒç”¨æ–¹æ³• A ä¹‹åï¼Œæ–¹æ³• B çš„äº‹åŠ¡æ˜¯ä¸ä¼šèµ·ä½œç”¨çš„ã€‚è¿™ä¹Ÿæ˜¯ç»å¸¸çŠ¯é”™è¯¯çš„ä¸€ä¸ªåœ°æ–¹ã€‚</p><p>é‚£ä¸ºå•¥ä¼šå‡ºç°è¿™ç§æƒ…å†µï¼Ÿå…¶å®è¿™è¿˜æ˜¯ç”±äºä½¿ç”¨ Spring AOP ä»£ç†é€ æˆçš„ï¼Œå› ä¸ºåªæœ‰å½“äº‹åŠ¡æ–¹æ³•è¢«å½“å‰ç±»ä»¥å¤–çš„ä»£ç è°ƒç”¨æ—¶ï¼Œæ‰ä¼šç”± Spring ç”Ÿæˆçš„ä»£ç†å¯¹è±¡æ¥ç®¡ç†ã€‚</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code> <span class="token comment">//@Transactional</span>\n     <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/test&quot;</span><span class="token punctuation">)</span>\n     <span class="token keyword">private</span> <span class="token class-name">Integer</span> <span class="token class-name">A</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>\n         <span class="token class-name">CityInfoDict</span> cityInfoDict <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CityInfoDict</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n         cityInfoDict<span class="token punctuation">.</span><span class="token function">setCityName</span><span class="token punctuation">(</span><span class="token string">&quot;2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n         <span class="token doc-comment comment">/**\n          * B æ’å…¥å­—æ®µä¸º 3çš„æ•°æ®\n          */</span>\n         <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">insertB</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token doc-comment comment">/**\n         * A æ’å…¥å­—æ®µä¸º 2çš„æ•°æ®\n         */</span>\n        <span class="token keyword">int</span> insert <span class="token operator">=</span> cityInfoDictMapper<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>cityInfoDict<span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token keyword">return</span> insert<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token annotation punctuation">@Transactional</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token keyword">public</span> <span class="token class-name">Integer</span> <span class="token function">insertB</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>\n        <span class="token class-name">CityInfoDict</span> cityInfoDict <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CityInfoDict</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        cityInfoDict<span class="token punctuation">.</span><span class="token function">setCityName</span><span class="token punctuation">(</span><span class="token string">&quot;3&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        cityInfoDict<span class="token punctuation">.</span><span class="token function">setParentCityId</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n        <span class="token keyword">return</span> cityInfoDictMapper<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>cityInfoDict<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™ç§æƒ…å†µæ˜¯æœ€å¸¸è§çš„ä¸€ç§@Transactional æ³¨è§£å¤±æ•ˆåœºæ™¯</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Transactional</span>\n<span class="token keyword">private</span> <span class="token class-name">Integer</span> <span class="token class-name">A</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>\n    <span class="token keyword">int</span> insert <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>\n    <span class="token keyword">try</span> <span class="token punctuation">{</span>\n        <span class="token class-name">CityInfoDict</span> cityInfoDict <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CityInfoDict</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        cityInfoDict<span class="token punctuation">.</span><span class="token function">setCityName</span><span class="token punctuation">(</span><span class="token string">&quot;2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        cityInfoDict<span class="token punctuation">.</span><span class="token function">setParentCityId</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token doc-comment comment">/**\n         * A æ’å…¥å­—æ®µä¸º 2çš„æ•°æ®\n         */</span>\n        insert <span class="token operator">=</span> cityInfoDictMapper<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>cityInfoDict<span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token doc-comment comment">/**\n         * B æ’å…¥å­—æ®µä¸º 3çš„æ•°æ®\n        */</span>\n        b<span class="token punctuation">.</span><span class="token function">insertB</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚æœ B æ–¹æ³•å†…éƒ¨æŠ›äº†å¼‚å¸¸ï¼Œè€Œ A æ–¹æ³•æ­¤æ—¶ try catch äº† B æ–¹æ³•çš„å¼‚å¸¸ï¼Œé‚£è¿™ä¸ªäº‹åŠ¡å°±ä¸èƒ½æ­£å¸¸å›æ»šäº†ï¼Œä¼šæŠ›å‡ºå¼‚å¸¸ï¼š</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>transaction<span class="token punctuation">.</span></span>UnexpectedRollbackException</span><span class="token operator">:</span> <span class="token class-name">Transaction</span> rolled back because it has been marked as rollback<span class="token operator">-</span>only\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/xingbiaogongzhonghao.png" alt="" loading="lazy"></p><h2 id="mvc" tabindex="-1"><a class="header-anchor" href="#mvc" aria-hidden="true">#</a> MVC</h2><h3 id="_28-spring-mvc-çš„æ ¸å¿ƒç»„ä»¶" tabindex="-1"><a class="header-anchor" href="#_28-spring-mvc-çš„æ ¸å¿ƒç»„ä»¶" aria-hidden="true">#</a> 28.Spring MVC çš„æ ¸å¿ƒç»„ä»¶ï¼Ÿ</h3><ol><li><strong>DispatcherServlet</strong>ï¼šå‰ç½®æ§åˆ¶å™¨ï¼Œæ˜¯æ•´ä¸ªæµç¨‹æ§åˆ¶çš„<strong>æ ¸å¿ƒ</strong>ï¼Œæ§åˆ¶å…¶ä»–ç»„ä»¶çš„æ‰§è¡Œï¼Œè¿›è¡Œç»Ÿä¸€è°ƒåº¦ï¼Œé™ä½ç»„ä»¶ä¹‹é—´çš„è€¦åˆæ€§ï¼Œç›¸å½“äºæ€»æŒ‡æŒ¥ã€‚</li><li><strong>Handler</strong>ï¼šå¤„ç†å™¨ï¼Œå®Œæˆå…·ä½“çš„ä¸šåŠ¡é€»è¾‘ï¼Œç›¸å½“äº Servlet æˆ– Actionã€‚</li><li><strong>HandlerMapping</strong>ï¼šDispatcherServlet æ¥æ”¶åˆ°è¯·æ±‚ä¹‹åï¼Œé€šè¿‡ HandlerMapping å°†ä¸åŒçš„è¯·æ±‚æ˜ å°„åˆ°ä¸åŒçš„ Handlerã€‚</li><li><strong>HandlerInterceptor</strong>ï¼šå¤„ç†å™¨æ‹¦æˆªå™¨ï¼Œæ˜¯ä¸€ä¸ªæ¥å£ï¼Œå¦‚æœéœ€è¦å®Œæˆä¸€äº›æ‹¦æˆªå¤„ç†ï¼Œå¯ä»¥å®ç°è¯¥æ¥å£ã€‚</li><li><strong>HandlerExecutionChain</strong>ï¼šå¤„ç†å™¨æ‰§è¡Œé“¾ï¼ŒåŒ…æ‹¬ä¸¤éƒ¨åˆ†å†…å®¹ï¼šHandler å’Œ HandlerInterceptorï¼ˆç³»ç»Ÿä¼šæœ‰ä¸€ä¸ªé»˜è®¤çš„ HandlerInterceptorï¼Œå¦‚æœéœ€è¦é¢å¤–è®¾ç½®æ‹¦æˆªï¼Œå¯ä»¥æ·»åŠ æ‹¦æˆªå™¨ï¼‰ã€‚</li><li><strong>HandlerAdapter</strong>ï¼šå¤„ç†å™¨é€‚é…å™¨ï¼ŒHandler æ‰§è¡Œä¸šåŠ¡æ–¹æ³•ä¹‹å‰ï¼Œéœ€è¦è¿›è¡Œä¸€ç³»åˆ—çš„æ“ä½œï¼ŒåŒ…æ‹¬è¡¨å•æ•°æ®çš„éªŒè¯ã€æ•°æ®ç±»å‹çš„è½¬æ¢ã€å°†è¡¨å•æ•°æ®å°è£…åˆ° JavaBean ç­‰ï¼Œè¿™äº›æ“ä½œéƒ½æ˜¯ç”± HandlerApater æ¥å®Œæˆï¼Œå¼€å‘è€…åªéœ€å°†æ³¨æ„åŠ›é›†ä¸­ä¸šåŠ¡é€»è¾‘çš„å¤„ç†ä¸Šï¼ŒDispatcherServlet é€šè¿‡ HandlerAdapter æ‰§è¡Œä¸åŒçš„ Handlerã€‚</li><li><strong>ModelAndView</strong>ï¼šè£…è½½äº†æ¨¡å‹æ•°æ®å’Œè§†å›¾ä¿¡æ¯ï¼Œä½œä¸º Handler çš„å¤„ç†ç»“æœï¼Œè¿”å›ç»™ DispatcherServletã€‚</li><li><strong>ViewResolver</strong>ï¼šè§†å›¾è§£æå™¨ï¼ŒDispatcheServlet é€šè¿‡å®ƒå°†é€»è¾‘è§†å›¾è§£æä¸ºç‰©ç†è§†å›¾ï¼Œæœ€ç»ˆå°†æ¸²æŸ“ç»“æœå“åº”ç»™å®¢æˆ·ç«¯ã€‚</li></ol><h3 id="_29-spring-mvc-çš„å·¥ä½œæµç¨‹" tabindex="-1"><a class="header-anchor" href="#_29-spring-mvc-çš„å·¥ä½œæµç¨‹" aria-hidden="true">#</a> 29.Spring MVC çš„å·¥ä½œæµç¨‹ï¼Ÿ</h3><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/spring-e29a122b-db07-48b8-8289-7251032e87a1.png" alt="Spring MVCçš„å·¥ä½œæµç¨‹" loading="lazy"></p><ol><li>å®¢æˆ·ç«¯å‘æœåŠ¡ç«¯å‘é€ä¸€æ¬¡è¯·æ±‚ï¼Œè¿™ä¸ªè¯·æ±‚ä¼šå…ˆåˆ°å‰ç«¯æ§åˆ¶å™¨ DispatcherServlet(ä¹Ÿå«ä¸­å¤®æ§åˆ¶å™¨)ã€‚</li><li>DispatcherServlet æ¥æ”¶åˆ°è¯·æ±‚åä¼šè°ƒç”¨ HandlerMapping å¤„ç†å™¨æ˜ å°„å™¨ã€‚ç”±æ­¤å¾—çŸ¥ï¼Œè¯¥è¯·æ±‚è¯¥ç”±å“ªä¸ª Controller æ¥å¤„ç†ï¼ˆå¹¶æœªè°ƒç”¨ Controllerï¼Œåªæ˜¯å¾—çŸ¥ï¼‰</li><li>DispatcherServlet è°ƒç”¨ HandlerAdapter å¤„ç†å™¨é€‚é…å™¨ï¼Œå‘Šè¯‰å¤„ç†å™¨é€‚é…å™¨åº”è¯¥è¦å»æ‰§è¡Œå“ªä¸ª Controller</li><li>HandlerAdapter å¤„ç†å™¨é€‚é…å™¨å»æ‰§è¡Œ Controller å¹¶å¾—åˆ° ModelAndView(æ•°æ®å’Œè§†å›¾)ï¼Œå¹¶å±‚å±‚è¿”å›ç»™ DispatcherServlet</li><li>DispatcherServlet å°† ModelAndView äº¤ç»™ ViewReslover è§†å›¾è§£æå™¨è§£æï¼Œç„¶åè¿”å›çœŸæ­£çš„è§†å›¾ã€‚</li><li>DispatcherServlet å°†æ¨¡å‹æ•°æ®å¡«å……åˆ°è§†å›¾ä¸­</li><li>DispatcherServlet å°†ç»“æœå“åº”ç»™å®¢æˆ·ç«¯</li></ol><p><strong>Spring MVC</strong> è™½ç„¶æ•´ä½“æµç¨‹å¤æ‚ï¼Œä½†æ˜¯å®é™…å¼€å‘ä¸­å¾ˆç®€å•ï¼Œå¤§éƒ¨åˆ†çš„ç»„ä»¶ä¸éœ€è¦å¼€å‘äººå‘˜åˆ›å»ºå’Œç®¡ç†ï¼Œåªéœ€è¦é€šè¿‡é…ç½®æ–‡ä»¶çš„æ–¹å¼å®Œæˆé…ç½®å³å¯ï¼ŒçœŸæ­£éœ€è¦å¼€å‘äººå‘˜è¿›è¡Œå¤„ç†çš„åªæœ‰ <strong>Handlerï¼ˆControllerï¼‰</strong> ã€<strong>View</strong> ã€<strong>Model</strong>ã€‚</p><p>å½“ç„¶æˆ‘ä»¬ç°åœ¨å¤§éƒ¨åˆ†çš„å¼€å‘éƒ½æ˜¯å‰åç«¯åˆ†ç¦»ï¼ŒRestful é£æ ¼æ¥å£ï¼Œåç«¯åªéœ€è¦è¿”å› Json æ•°æ®å°±è¡Œäº†ã€‚</p><h3 id="_30-springmvc-restful-é£æ ¼çš„æ¥å£çš„æµç¨‹æ˜¯ä»€ä¹ˆæ ·çš„å‘¢" tabindex="-1"><a class="header-anchor" href="#_30-springmvc-restful-é£æ ¼çš„æ¥å£çš„æµç¨‹æ˜¯ä»€ä¹ˆæ ·çš„å‘¢" aria-hidden="true">#</a> 30.SpringMVC Restful é£æ ¼çš„æ¥å£çš„æµç¨‹æ˜¯ä»€ä¹ˆæ ·çš„å‘¢ï¼Ÿ</h3><p>PS:è¿™æ˜¯ä¸€é“å…¨æ–°çš„å…«è‚¡ï¼Œæ¯•ç«Ÿ ModelAndView è¿™ç§æ–¹å¼åº”è¯¥æ²¡äººç”¨äº†å§ï¼Ÿç°åœ¨éƒ½æ˜¯å‰åç«¯åˆ†ç¦»æ¥å£ï¼Œå…«è‚¡ä¹Ÿè¯¥æ›´æ–°æ¢ä»£äº†ã€‚</p><p>æˆ‘ä»¬éƒ½çŸ¥é“ Restful æ¥å£ï¼Œå“åº”æ ¼å¼æ˜¯ jsonï¼Œè¿™å°±ç”¨åˆ°äº†ä¸€ä¸ªå¸¸ç”¨æ³¨è§£ï¼š<strong>@ResponseBody</strong></p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/user&quot;</span><span class="token punctuation">)</span>\n    <span class="token annotation punctuation">@ResponseBody</span>\n    <span class="token keyword">public</span> <span class="token class-name">User</span> <span class="token function">user</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>\n        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">&quot;å¼ ä¸‰&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åŠ å…¥äº†è¿™ä¸ªæ³¨è§£åï¼Œæ•´ä½“çš„æµç¨‹ä¸Šå’Œä½¿ç”¨ ModelAndView å¤§ä½“ä¸Šç›¸åŒï¼Œä½†æ˜¯ç»†èŠ‚ä¸Šæœ‰ä¸€äº›ä¸åŒï¼š</p><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/spring-2da963a0-5da9-4b3a-aafd-fd8dbc7e1807.png" alt="Spring MVC Restfulè¯·æ±‚å“åº”ç¤ºæ„å›¾" loading="lazy"></p><ol><li><p>å®¢æˆ·ç«¯å‘æœåŠ¡ç«¯å‘é€ä¸€æ¬¡è¯·æ±‚ï¼Œè¿™ä¸ªè¯·æ±‚ä¼šå…ˆåˆ°å‰ç«¯æ§åˆ¶å™¨ DispatcherServlet</p></li><li><p>DispatcherServlet æ¥æ”¶åˆ°è¯·æ±‚åä¼šè°ƒç”¨ HandlerMapping å¤„ç†å™¨æ˜ å°„å™¨ã€‚ç”±æ­¤å¾—çŸ¥ï¼Œè¯¥è¯·æ±‚è¯¥ç”±å“ªä¸ª Controller æ¥å¤„ç†</p></li><li><p>DispatcherServlet è°ƒç”¨ HandlerAdapter å¤„ç†å™¨é€‚é…å™¨ï¼Œå‘Šè¯‰å¤„ç†å™¨é€‚é…å™¨åº”è¯¥è¦å»æ‰§è¡Œå“ªä¸ª Controller</p></li><li><p>Controller è¢«å°è£…æˆäº† ServletInvocableHandlerMethodï¼ŒHandlerAdapter å¤„ç†å™¨é€‚é…å™¨å»æ‰§è¡Œ invokeAndHandle æ–¹æ³•ï¼Œå®Œæˆå¯¹ Controller çš„è¯·æ±‚å¤„ç†</p></li><li><p>HandlerAdapter æ‰§è¡Œå®Œå¯¹ Controller çš„è¯·æ±‚ï¼Œä¼šè°ƒç”¨ HandlerMethodReturnValueHandler å»å¤„ç†è¿”å›å€¼ï¼Œä¸»è¦çš„è¿‡ç¨‹ï¼š</p><p>5.1. è°ƒç”¨ RequestResponseBodyMethodProcessorï¼Œåˆ›å»º ServletServerHttpResponseï¼ˆSpring å¯¹åŸç”Ÿ ServerHttpResponse çš„å°è£…ï¼‰å®ä¾‹</p><p>5.2.ä½¿ç”¨ HttpMessageConverter çš„ write æ–¹æ³•ï¼Œå°†è¿”å›å€¼å†™å…¥ ServletServerHttpResponse çš„ OutputStream è¾“å‡ºæµä¸­</p><p>5.3.åœ¨å†™å…¥çš„è¿‡ç¨‹ä¸­ï¼Œä¼šä½¿ç”¨ JsonGeneratorï¼ˆé»˜è®¤ä½¿ç”¨ Jackson æ¡†æ¶ï¼‰å¯¹è¿”å›å€¼è¿›è¡Œ Json åºåˆ—åŒ–</p></li><li><p>æ‰§è¡Œå®Œè¯·æ±‚åï¼Œè¿”å›çš„ ModealAndView ä¸º nullï¼ŒServletServerHttpResponse é‡Œä¹Ÿå·²ç»å†™å…¥äº†å“åº”ï¼Œæ‰€ä»¥ä¸ç”¨å…³å¿ƒ View çš„å¤„ç†</p></li></ol><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/xingbiaogongzhonghao.png" alt="" loading="lazy"></p><h2 id="spring-boot" tabindex="-1"><a class="header-anchor" href="#spring-boot" aria-hidden="true">#</a> Spring Boot</h2><h3 id="_31-ä»‹ç»ä¸€ä¸‹-springboot-æœ‰å“ªäº›ä¼˜ç‚¹" tabindex="-1"><a class="header-anchor" href="#_31-ä»‹ç»ä¸€ä¸‹-springboot-æœ‰å“ªäº›ä¼˜ç‚¹" aria-hidden="true">#</a> 31.ä»‹ç»ä¸€ä¸‹ SpringBootï¼Œæœ‰å“ªäº›ä¼˜ç‚¹ï¼Ÿ</h3><p>Spring Boot åŸºäº Spring å¼€å‘ï¼ŒSpirng Boot æœ¬èº«å¹¶ä¸æä¾› Spring æ¡†æ¶çš„æ ¸å¿ƒç‰¹æ€§ä»¥åŠæ‰©å±•åŠŸèƒ½ï¼Œåªæ˜¯ç”¨äºå¿«é€Ÿã€æ•æ·åœ°å¼€å‘æ–°ä¸€ä»£åŸºäº Spring æ¡†æ¶çš„åº”ç”¨ç¨‹åºã€‚å®ƒå¹¶ä¸æ˜¯ç”¨æ¥æ›¿ä»£ Spring çš„è§£å†³æ–¹æ¡ˆï¼Œè€Œæ˜¯å’Œ Spring æ¡†æ¶ç´§å¯†ç»“åˆç”¨äºæå‡ Spring å¼€å‘è€…ä½“éªŒçš„å·¥å…·ã€‚</p><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/spring-d9164ee6-5c86-4313-8fd9-efb9acfa5f0b.png" alt="SpringBootå›¾æ ‡" loading="lazy"></p><p>Spring Boot ä»¥<code>çº¦å®šå¤§äºé…ç½®</code>æ ¸å¿ƒæ€æƒ³å¼€å±•å·¥ä½œï¼Œç›¸æ¯” Spring å…·æœ‰å¦‚ä¸‹ä¼˜åŠ¿ï¼š</p><ol><li>Spring Boot å¯ä»¥å¿«é€Ÿåˆ›å»ºç‹¬ç«‹çš„ Spring åº”ç”¨ç¨‹åºã€‚</li><li>Spring Boot å†…åµŒäº†å¦‚ Tomcatï¼ŒJetty å’Œ Undertow è¿™æ ·çš„å®¹å™¨ï¼Œä¹Ÿå°±æ˜¯è¯´å¯ä»¥ç›´æ¥è·‘èµ·æ¥ï¼Œç”¨ä¸ç€å†åšéƒ¨ç½²å·¥ä½œäº†ã€‚</li><li>Spring Boot æ— éœ€å†åƒ Spring ä¸€æ ·ä½¿ç”¨ä¸€å †ç¹ççš„ xml æ–‡ä»¶é…ç½®ã€‚</li><li>Spring Boot å¯ä»¥è‡ªåŠ¨é…ç½®(æ ¸å¿ƒ)Springã€‚SpringBoot å°†åŸæœ‰çš„ XML é…ç½®æ”¹ä¸º Java é…ç½®ï¼Œå°† bean æ³¨å…¥æ”¹ä¸ºä½¿ç”¨æ³¨è§£æ³¨å…¥çš„æ–¹å¼(@Autowire)ï¼Œå¹¶å°†å¤šä¸ª xmlã€properties é…ç½®æµ“ç¼©åœ¨ä¸€ä¸ª appliaction.yml é…ç½®æ–‡ä»¶ä¸­ã€‚</li><li>Spring Boot æä¾›äº†ä¸€äº›ç°æœ‰çš„åŠŸèƒ½ï¼Œå¦‚é‡åº¦å·¥å…·ï¼Œè¡¨å•æ•°æ®éªŒè¯ä»¥åŠä¸€äº›å¤–éƒ¨é…ç½®è¿™æ ·çš„ä¸€äº›ç¬¬ä¸‰æ–¹åŠŸèƒ½ã€‚</li><li>Spring Boot å¯ä»¥å¿«é€Ÿæ•´åˆå¸¸ç”¨ä¾èµ–ï¼ˆå¼€å‘åº“ï¼Œä¾‹å¦‚ spring-webmvcã€jackson-jsonã€validation-api å’Œ tomcat ç­‰ï¼‰ï¼Œæä¾›çš„ POM å¯ä»¥ç®€åŒ– Maven çš„é…ç½®ã€‚å½“æˆ‘ä»¬å¼•å…¥æ ¸å¿ƒä¾èµ–æ—¶ï¼ŒSpringBoot ä¼šè‡ªå¼•å…¥å…¶ä»–ä¾èµ–ã€‚</li></ol><h3 id="_32-springboot-è‡ªåŠ¨é…ç½®åŸç†äº†è§£å—" tabindex="-1"><a class="header-anchor" href="#_32-springboot-è‡ªåŠ¨é…ç½®åŸç†äº†è§£å—" aria-hidden="true">#</a> 32.SpringBoot è‡ªåŠ¨é…ç½®åŸç†äº†è§£å—ï¼Ÿ</h3><p>SpringBoot å¼€å¯è‡ªåŠ¨é…ç½®çš„æ³¨è§£æ˜¯<code>@EnableAutoConfiguration</code> ï¼Œå¯åŠ¨ç±»ä¸Šçš„æ³¨è§£<code>@SpringBootApplication</code>æ˜¯ä¸€ä¸ªå¤åˆæ³¨è§£ï¼ŒåŒ…å«äº†@EnableAutoConfigurationï¼š</p><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/spring-df77ee15-2ff0-4ec7-8e65-e4ebb8ba88f1.png" alt="SpringBootè‡ªåŠ¨é…ç½®åŸç†" loading="lazy"></p><ul><li><p><code>EnableAutoConfiguration</code> åªæ˜¯ä¸€ä¸ªç®€å•çš„æ³¨è§£ï¼Œè‡ªåŠ¨è£…é…æ ¸å¿ƒåŠŸèƒ½çš„å®ç°å®é™…æ˜¯é€šè¿‡ <code>AutoConfigurationImportSelector</code>ç±»</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@AutoConfigurationPackage</span> <span class="token comment">//å°†mainåŒçº§çš„åŒ…ä¸‹çš„æ‰€æœ‰ç»„ä»¶æ³¨å†Œåˆ°å®¹å™¨ä¸­</span>\n<span class="token annotation punctuation">@Import</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token class-name">AutoConfigurationImportSelector</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">//åŠ è½½è‡ªåŠ¨è£…é…ç±» xxxAutoconfiguration</span>\n<span class="token keyword">public</span> <span class="token annotation punctuation">@interface</span> <span class="token class-name">EnableAutoConfiguration</span> <span class="token punctuation">{</span>\n    <span class="token class-name">String</span> ENABLED_OVERRIDE_PROPERTY <span class="token operator">=</span> <span class="token string">&quot;spring.boot.enableautoconfiguration&quot;</span><span class="token punctuation">;</span>\n\n    <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">exclude</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n    <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">excludeName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><code>AutoConfigurationImportSelector</code>å®ç°äº†<code>ImportSelector</code>æ¥å£ï¼Œè¿™ä¸ªæ¥å£çš„ä½œç”¨å°±æ˜¯æ”¶é›†éœ€è¦å¯¼å…¥çš„é…ç½®ç±»ï¼Œé…åˆ<code>@Import(ï¼‰</code>å°±å¯ä»¥å°†ç›¸åº”çš„ç±»å¯¼å…¥åˆ° Spring å®¹å™¨ä¸­</p></li><li><p>è·å–æ³¨å…¥ç±»çš„æ–¹æ³•æ˜¯ selectImports()ï¼Œå®ƒå®é™…è°ƒç”¨çš„æ˜¯<code>getAutoConfigurationEntry</code>ï¼Œè¿™ä¸ªæ–¹æ³•æ˜¯è·å–è‡ªåŠ¨è£…é…ç±»çš„å…³é”®ï¼Œä¸»è¦æµç¨‹å¯ä»¥åˆ†ä¸ºè¿™ä¹ˆå‡ æ­¥ï¼š</p><ol><li>è·å–æ³¨è§£çš„å±æ€§ï¼Œç”¨äºåé¢çš„æ’é™¤</li><li><strong>è·å–æ‰€æœ‰éœ€è¦è‡ªåŠ¨è£…é…çš„é…ç½®ç±»çš„è·¯å¾„</strong>ï¼šè¿™ä¸€æ­¥æ˜¯æœ€å…³é”®çš„ï¼Œä» META-INF/spring.factories è·å–è‡ªåŠ¨é…ç½®ç±»çš„è·¯å¾„</li><li>å»æ‰é‡å¤çš„é…ç½®ç±»å’Œéœ€è¦æ’é™¤çš„é‡å¤ç±»ï¼ŒæŠŠéœ€è¦è‡ªåŠ¨åŠ è½½çš„é…ç½®ç±»çš„è·¯å¾„å­˜å‚¨èµ·æ¥</li></ol></li></ul><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>    <span class="token keyword">protected</span> <span class="token class-name">AutoConfigurationImportSelector<span class="token punctuation">.</span>AutoConfigurationEntry</span> <span class="token function">getAutoConfigurationEntry</span><span class="token punctuation">(</span><span class="token class-name">AnnotationMetadata</span> annotationMetadata<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">isEnabled</span><span class="token punctuation">(</span>annotationMetadata<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n            <span class="token keyword">return</span> EMPTY_ENTRY<span class="token punctuation">;</span>\n        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>\n            <span class="token comment">//1.è·å–åˆ°æ³¨è§£çš„å±æ€§</span>\n            <span class="token class-name">AnnotationAttributes</span> attributes <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getAttributes</span><span class="token punctuation">(</span>annotationMetadata<span class="token punctuation">)</span><span class="token punctuation">;</span>\n            <span class="token comment">//2.è·å–éœ€è¦è‡ªåŠ¨è£…é…çš„æ‰€æœ‰é…ç½®ç±»ï¼Œè¯»å–META-INF/spring.factoriesï¼Œè·å–è‡ªåŠ¨é…ç½®ç±»è·¯å¾„</span>\n            <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> configurations <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getCandidateConfigurations</span><span class="token punctuation">(</span>annotationMetadata<span class="token punctuation">,</span> attributes<span class="token punctuation">)</span><span class="token punctuation">;</span>\n            <span class="token comment">//3.1.ç§»é™¤é‡å¤çš„é…ç½®</span>\n            configurations <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">removeDuplicates</span><span class="token punctuation">(</span>configurations<span class="token punctuation">)</span><span class="token punctuation">;</span>\n            <span class="token comment">//3.2.å¤„ç†éœ€è¦æ’é™¤çš„é…ç½®</span>\n            <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> exclusions <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getExclusions</span><span class="token punctuation">(</span>annotationMetadata<span class="token punctuation">,</span> attributes<span class="token punctuation">)</span><span class="token punctuation">;</span>\n            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">checkExcludedClasses</span><span class="token punctuation">(</span>configurations<span class="token punctuation">,</span> exclusions<span class="token punctuation">)</span><span class="token punctuation">;</span>\n            configurations<span class="token punctuation">.</span><span class="token function">removeAll</span><span class="token punctuation">(</span>exclusions<span class="token punctuation">)</span><span class="token punctuation">;</span>\n            configurations <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getConfigurationClassFilter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>configurations<span class="token punctuation">)</span><span class="token punctuation">;</span>\n            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">fireAutoConfigurationImportEvents</span><span class="token punctuation">(</span>configurations<span class="token punctuation">,</span> exclusions<span class="token punctuation">)</span><span class="token punctuation">;</span>\n            <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">AutoConfigurationImportSelector<span class="token punctuation">.</span>AutoConfigurationEntry</span><span class="token punctuation">(</span>configurations<span class="token punctuation">,</span> exclusions<span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_33-å¦‚ä½•è‡ªå®šä¹‰ä¸€ä¸ª-springboot-srarter" tabindex="-1"><a class="header-anchor" href="#_33-å¦‚ä½•è‡ªå®šä¹‰ä¸€ä¸ª-springboot-srarter" aria-hidden="true">#</a> 33.å¦‚ä½•è‡ªå®šä¹‰ä¸€ä¸ª SpringBoot Srarter?</h3><p>çŸ¥é“äº†è‡ªåŠ¨é…ç½®åŸç†ï¼Œåˆ›å»ºä¸€ä¸ªè‡ªå®šä¹‰ SpringBoot Starter ä¹Ÿå¾ˆç®€å•ã€‚</p><ol><li>åˆ›å»ºä¸€ä¸ªé¡¹ç›®ï¼Œå‘½åä¸º demo-spring-boot-starterï¼Œå¼•å…¥ SpringBoot ç›¸å…³ä¾èµ–</li></ol><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>        <span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>\n            <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>\n            <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>spring<span class="token operator">-</span>boot<span class="token operator">-</span>starter<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>\n        <span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>\n        <span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>\n            <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>\n            <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>spring<span class="token operator">-</span>boot<span class="token operator">-</span>configuration<span class="token operator">-</span>processor<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>\n            <span class="token generics"><span class="token punctuation">&lt;</span>optional<span class="token punctuation">&gt;</span></span><span class="token boolean">true</span><span class="token operator">&lt;</span><span class="token operator">/</span>optional<span class="token operator">&gt;</span>\n        <span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li><p>ç¼–å†™é…ç½®æ–‡ä»¶</p><p>è¿™é‡Œå®šä¹‰äº†å±æ€§é…ç½®çš„å‰ç¼€</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@ConfigurationProperties</span><span class="token punctuation">(</span>prefix <span class="token operator">=</span> <span class="token string">&quot;hello&quot;</span><span class="token punctuation">)</span>\n<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HelloProperties</span> <span class="token punctuation">{</span>\n\n    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>\n\n    <span class="token comment">//çœç•¥getterã€setter</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>è‡ªåŠ¨è£…é…</p><p>åˆ›å»ºè‡ªåŠ¨é…ç½®ç±» HelloPropertiesConfigure</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>\n<span class="token annotation punctuation">@EnableConfigurationProperties</span><span class="token punctuation">(</span><span class="token class-name">HelloProperties</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>\n<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HelloPropertiesConfigure</span> <span class="token punctuation">{</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>é…ç½®è‡ªåŠ¨ç±»</p><p>åœ¨<code>/resources/META-INF/spring.factories</code>æ–‡ä»¶ä¸­æ·»åŠ è‡ªåŠ¨é…ç½®ç±»è·¯å¾„</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>autoconfigure<span class="token punctuation">.</span></span>EnableAutoConfiguration</span><span class="token operator">=</span>\\\n  <span class="token class-name"><span class="token namespace">cn<span class="token punctuation">.</span>fighter3<span class="token punctuation">.</span>demo<span class="token punctuation">.</span>starter<span class="token punctuation">.</span>configure<span class="token punctuation">.</span></span>HelloPropertiesConfigure</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>æµ‹è¯•</p><ul><li><p>åˆ›å»ºä¸€ä¸ªå·¥ç¨‹ï¼Œå¼•å…¥è‡ªå®šä¹‰ starter ä¾èµ–</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>        <span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>\n            <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>cn<span class="token punctuation">.</span>fighter3<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>\n            <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>demo<span class="token operator">-</span>spring<span class="token operator">-</span>boot<span class="token operator">-</span>starter<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>\n            <span class="token generics"><span class="token punctuation">&lt;</span>version<span class="token punctuation">&gt;</span></span><span class="token number">0.0</span><span class="token number">.1</span><span class="token operator">-</span>SNAPSHOT<span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>\n        <span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>åœ¨é…ç½®æ–‡ä»¶é‡Œæ·»åŠ é…ç½®</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>hello.name=å¼ ä¸‰\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p>æµ‹è¯•ç±»</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@RunWith</span><span class="token punctuation">(</span><span class="token class-name">SpringRunner</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>\n<span class="token annotation punctuation">@SpringBootTest</span>\n<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HelloTest</span> <span class="token punctuation">{</span>\n    <span class="token annotation punctuation">@Autowired</span>\n    <span class="token class-name">HelloProperties</span> helloProperties<span class="token punctuation">;</span>\n\n    <span class="token annotation punctuation">@Test</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">hello</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>\n        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;ä½ å¥½ï¼Œ&quot;</span><span class="token operator">+</span>helloProperties<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul></li></ol><ul><li>è¿è¡Œç»“æœ</li></ul><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/spring-3ff3cc21-6a56-434b-a89e-d2b55d558bd6.png" alt="è¿è¡Œç»“æœ" loading="lazy"></p><p>è‡³æ­¤ï¼Œéšæ‰‹å†™çš„ä¸€ä¸ªè‡ªå®šä¹‰ SpringBoot-Starter å°±å®Œæˆäº†ï¼Œè™½ç„¶æ¯”è¾ƒç®€å•ï¼Œä½†æ˜¯å®Œæˆäº†ä¸»è¦çš„è‡ªåŠ¨è£…é…çš„èƒ½åŠ›ã€‚</p><h3 id="_34-springboot-å¯åŠ¨åŸç†" tabindex="-1"><a class="header-anchor" href="#_34-springboot-å¯åŠ¨åŸç†" aria-hidden="true">#</a> 34.Springboot å¯åŠ¨åŸç†ï¼Ÿ</h3><p>SpringApplication è¿™ä¸ªç±»ä¸»è¦åšäº†ä»¥ä¸‹å››ä»¶äº‹æƒ…ï¼š</p><ol><li>æ¨æ–­åº”ç”¨çš„ç±»å‹æ˜¯æ™®é€šçš„é¡¹ç›®è¿˜æ˜¯ Web é¡¹ç›®</li><li>æŸ¥æ‰¾å¹¶åŠ è½½æ‰€æœ‰å¯ç”¨åˆå§‹åŒ–å™¨ ï¼Œ è®¾ç½®åˆ° initializers å±æ€§ä¸­</li><li>æ‰¾å‡ºæ‰€æœ‰çš„åº”ç”¨ç¨‹åºç›‘å¬å™¨ï¼Œè®¾ç½®åˆ° listeners å±æ€§ä¸­</li><li>æ¨æ–­å¹¶è®¾ç½® main æ–¹æ³•çš„å®šä¹‰ç±»ï¼Œæ‰¾åˆ°è¿è¡Œçš„ä¸»ç±»</li></ol><p>SpringBoot å¯åŠ¨å¤§è‡´æµç¨‹å¦‚ä¸‹ ï¼š</p><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/spring-68744556-a1ba-4e1f-a092-1582875f0da6.png" alt="SpringBoot å¯åŠ¨å¤§è‡´æµç¨‹-å›¾ç‰‡æ¥æºç½‘ç»œ" loading="lazy"></p><h2 id="spring-cloud" tabindex="-1"><a class="header-anchor" href="#spring-cloud" aria-hidden="true">#</a> Spring Cloud</h2><h3 id="_35-å¯¹-springcloud-äº†è§£å¤šå°‘" tabindex="-1"><a class="header-anchor" href="#_35-å¯¹-springcloud-äº†è§£å¤šå°‘" aria-hidden="true">#</a> 35.å¯¹ SpringCloud äº†è§£å¤šå°‘ï¼Ÿ</h3><p>SpringCloud æ˜¯ Spring å®˜æ–¹æ¨å‡ºçš„å¾®æœåŠ¡æ²»ç†æ¡†æ¶ã€‚</p><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/spring-92ab53d5-f303-4fc5-bd26-e62cefe374b3.png" alt="Spring Cloud Netfilxæ ¸å¿ƒç»„ä»¶-æ¥æºå‚è€ƒ[2]" loading="lazy"></p><blockquote><p><strong>ä»€ä¹ˆæ˜¯å¾®æœåŠ¡ï¼Ÿ</strong></p></blockquote><ol><li>2014 å¹´ <strong>Martin Fowler</strong> æå‡ºçš„ä¸€ç§æ–°çš„æ¶æ„å½¢å¼ã€‚å¾®æœåŠ¡æ¶æ„æ˜¯ä¸€ç§<strong>æ¶æ„æ¨¡å¼</strong>ï¼Œæå€¡å°†å•ä¸€åº”ç”¨ç¨‹åºåˆ’åˆ†æˆä¸€ç»„å°çš„æœåŠ¡ï¼ŒæœåŠ¡ä¹‹é—´ç›¸äº’åè°ƒï¼Œäº’ç›¸é…åˆï¼Œä¸ºç”¨æˆ·æä¾›æœ€ç»ˆä»·å€¼ã€‚æ¯ä¸ªæœåŠ¡è¿è¡Œåœ¨å…¶ç‹¬ç«‹çš„è¿›ç¨‹ä¸­ï¼ŒæœåŠ¡ä¸æœåŠ¡ä¹‹é—´é‡‡ç”¨è½»é‡çº§çš„é€šä¿¡æœºåˆ¶(å¦‚ HTTP æˆ– Dubbo)äº’ç›¸åä½œï¼Œæ¯ä¸ªæœåŠ¡éƒ½å›´ç»•ç€å…·ä½“çš„ä¸šåŠ¡è¿›è¡Œæ„å»ºï¼Œå¹¶ä¸”èƒ½å¤Ÿè¢«ç‹¬ç«‹çš„éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œå¦å¤–ï¼Œåº”å°½é‡é¿å…ç»Ÿä¸€çš„ï¼Œé›†ä¸­å¼çš„æœåŠ¡ç®¡ç†æœºåˆ¶ï¼Œå¯¹å…·ä½“çš„ä¸€ä¸ªæœåŠ¡è€Œè¨€ï¼Œåº”æ ¹æ®ä¸šåŠ¡ä¸Šä¸‹æ–‡ï¼Œé€‰æ‹©åˆé€‚çš„è¯­è¨€ã€å·¥å…·(å¦‚ Maven)å¯¹å…¶è¿›è¡Œæ„å»ºã€‚</li><li>å¾®æœåŠ¡åŒ–çš„æ ¸å¿ƒå°±æ˜¯å°†ä¼ ç»Ÿçš„ä¸€ç«™å¼åº”ç”¨ï¼Œæ ¹æ®ä¸šåŠ¡æ‹†åˆ†æˆä¸€ä¸ªä¸€ä¸ªçš„æœåŠ¡ï¼Œå½»åº•åœ°å»è€¦åˆï¼Œæ¯ä¸€ä¸ªå¾®æœåŠ¡æä¾›å•ä¸ªä¸šåŠ¡åŠŸèƒ½çš„æœåŠ¡ï¼Œä¸€ä¸ªæœåŠ¡åšä¸€ä»¶äº‹æƒ…ï¼Œä»æŠ€æœ¯è§’åº¦çœ‹å°±æ˜¯ä¸€ç§å°è€Œç‹¬ç«‹çš„å¤„ç†è¿‡ç¨‹ï¼Œç±»ä¼¼è¿›ç¨‹çš„æ¦‚å¿µï¼Œèƒ½å¤Ÿè‡ªè¡Œå•ç‹¬å¯åŠ¨æˆ–é”€æ¯ï¼Œæ‹¥æœ‰è‡ªå·±ç‹¬ç«‹çš„æ•°æ®åº“ã€‚</li></ol><blockquote><p><strong>å¾®æœåŠ¡æ¶æ„ä¸»è¦è¦è§£å†³å“ªäº›é—®é¢˜ï¼Ÿ</strong></p></blockquote><ol><li>æœåŠ¡å¾ˆå¤šï¼Œå®¢æˆ·ç«¯æ€ä¹ˆè®¿é—®ï¼Œå¦‚ä½•æä¾›å¯¹å¤–ç½‘å…³?</li><li>è¿™ä¹ˆå¤šæœåŠ¡ï¼ŒæœåŠ¡ä¹‹é—´å¦‚ä½•é€šä¿¡? HTTP è¿˜æ˜¯ RPC?</li><li>è¿™ä¹ˆå¤šæœåŠ¡ï¼Œå¦‚ä½•æ²»ç†? æœåŠ¡çš„æ³¨å†Œå’Œå‘ç°ã€‚</li><li>æœåŠ¡æŒ‚äº†æ€ä¹ˆåŠï¼Ÿç†”æ–­æœºåˆ¶ã€‚</li></ol><blockquote><p><strong>æœ‰å“ªäº›ä¸»æµå¾®æœåŠ¡æ¡†æ¶ï¼Ÿ</strong></p></blockquote><ol><li>Spring Cloud Netflix</li><li>Spring Cloud Alibaba</li><li>SpringBoot + Dubbo + ZooKeeper</li></ol><blockquote><p><strong>SpringCloud æœ‰å“ªäº›æ ¸å¿ƒç»„ä»¶ï¼Ÿ</strong></p></blockquote><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/sidebar/sanfene/spring-2b988a72-0739-4fed-b271-eaf12589444f.png" alt="SpringCloud" loading="lazy"></p><p>PS:å¾®æœåŠ¡åé¢æœ‰æœºä¼šå†æ‰©å±•ï¼Œå…¶å®é¢è¯•ä¸€èˆ¬éƒ½æ˜¯ç»“åˆé¡¹ç›®å»é—®ã€‚</p><p><img src="http://cdn.tobebetterjavaer.com/tobebetterjavaer/images/xingbiaogongzhonghao.png" alt="" loading="lazy"></p>',121),S=(0,e.Uk)("å›¾æ–‡è¯¦è§£ 35 é“ Spring é¢è¯•é«˜é¢‘é¢˜ï¼Œè¿™æ¬¡åŠæ‰“é¢è¯•å®˜ï¼Œæˆ‘è§‰å¾—ç¨³äº†ï¼ˆæ‰‹åŠ¨ dogï¼‰ã€‚æ•´ç†ï¼šæ²‰é»˜ç‹äºŒï¼Œæˆ³"),B={href:"https://mp.weixin.qq.com/s/EQge6DmgIqYITM3mAxkatg",target:"_blank",rel:"noopener noreferrer"},j=(0,e.Uk)("è½¬è½½é“¾æ¥"),A=(0,e.Uk)("ï¼Œä½œè€…ï¼šä¸‰åˆ†æ¶ï¼Œæˆ³"),q={href:"https://mp.weixin.qq.com/s/Y17S85ntHm_MLTZMJdtjQQ",target:"_blank",rel:"noopener noreferrer"},P=(0,e.Uk)("åŸæ–‡é“¾æ¥"),x=(0,e.Uk)("ã€‚"),C={},I=(0,a(13860).Z)(C,[["render",function(n,s){const a=(0,e.up)("ExternalLinkIcon");return(0,e.wg)(),(0,e.iD)("div",null,[t,(0,e._)("blockquote",null,[(0,e._)("p",null,[p,(0,e._)("a",o,[c,(0,e.Wm)(a)]),i,(0,e._)("a",l,[r,(0,e.Wm)(a)]),u])]),d,(0,e._)("p",null,[k,(0,e._)("a",v,[m,(0,e.Wm)(a)])]),g,(0,e._)("p",null,[b,(0,e._)("a",y,[f,(0,e.Wm)(a)]),h]),w,(0,e._)("blockquote",null,[(0,e._)("p",null,[S,(0,e._)("a",B,[j,(0,e.Wm)(a)]),A,(0,e._)("a",q,[P,(0,e.Wm)(a)]),x])])])}]])},13860:(n,s)=>{s.Z=(n,s)=>{const a=n.__vccOpts||n;for(const[n,e]of s)a[n]=e;return a}}}]);